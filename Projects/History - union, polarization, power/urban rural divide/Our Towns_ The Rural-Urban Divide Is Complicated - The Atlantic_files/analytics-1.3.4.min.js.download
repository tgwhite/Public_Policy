!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){var t=e.getFullYear().toString(),n=(e.getMonth()+1).toString(),i=e.getDate().toString();return t+(n[1]?n:"0"+n[0])+(i[1]?i:"0"+i[0])},o=t.firstLoadTime=new Date;t.todayStr=i(o),t.last30DaysDateStr=i(new Date((new Date).setDate(o.getDate()-30))),t.firstMonthDateStr=i(new Date(o.getFullYear(),o.getMonth(),1)),t.roundToTwo=function(e){return+(Math.round(e+"e+2")+"e-2")},t.sendCustomEvent=function(e,t,n){window.fbq&&window.fbq("trackSingleCustom",e,t,n)},t.sendEvent=function(e,t,n){window.fbq&&window.fbq("trackSingle",e,t,n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.SessionTracker=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cookieHandler=t}return i(e,[{key:"initSessionData",value:function(e){this.cookieHandler.createCookie("kw.session_ts",e,1/48),this.setPageViewsPerSessionCount(1)}},{key:"setPageViewsPerSessionCount",value:function(e){this.cookieHandler.createCookie("kw.pv_session",e,1)}},{key:"getCurrentPageViewPerSession",value:function(){var e=this.cookieHandler.getCookie("kw.pv_session"),t=0;return e&&(t=parseInt(e)),t}},{key:"getAndUpdateSessionData",value:function(e){var t=e.getTime(),n=1,i=0,o=this.getExisitingSessionStart();o?(n=this.getCurrentPageViewPerSession()+1,i=Math.floor((t-o)/1e3),this.setPageViewsPerSessionCount(n)):this.initSessionData(t);return{pageViews:n,sessionLengthSeconds:i}}},{key:"getExisitingSessionStart",value:function(){var e=this.cookieHandler.getCookie("kw.session_ts"),t=null;return e&&(t=parseInt(e)),t}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.CookieHandler=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.document=t,this.domain=n}return i(e,[{key:"getCookie",value:function(e){var t=("; "+this.document.cookie).split("; "+e+"=");if(2===t.length)return t.pop().split(";").shift()}},{key:"createCookie",value:function(e,t,n){var i,o;if(n){var r=new Date;r.setTime(r.getTime()+864e5*n),i="; expires="+r.toGMTString()}else i="";o=e+"="+t+i+"; path=/;",this.domain&&(o=o+" Domain="+this.domain),this.document.cookie=o}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),o=null,r=function(e){var t,n,r,a,s,c,u=(t=window.pageYOffset||document.documentElement.scrollTop,n=document.body,r=document.documentElement,a=window.innerHeight,s=Math.max(n.scrollHeight,n.offsetHeight,r.clientHeight,r.scrollHeight,r.offsetHeight),(0,i.roundToTwo)(Math.min(100,t/(s-a)*100))),l=null,f=u!==o,d=(0,i.roundToTwo)((new Date-i.firstLoadTime)/6e4);f&&!(d>30)&&(l={tsop:d,lop:u,noaip:(c=document.getElementsByTagName("iframe"),Array.prototype.slice.call(c).filter(function(e){return e.dataset.googleContainerId}).length)},(0,i.sendCustomEvent)(e,"KWCEPA",l),o=u)};t.default=function(e,t){var n=1e3*(t=t||30);setInterval(r.bind(null,e),n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initAdvancedPixel=t.sendAdvancedPageView=void 0;var i=n(0),o=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},r=null,a=null,s=function(){return r.localStorage&&r.localStorage.keyweeHistory?JSON.parse(r.localStorage.keyweeHistory):{}},c=function(e){r.localStorage&&(r.localStorage.keyweeHistory=JSON.stringify(e))},u=function(e){var t,n,o=r.document.title,a=r.location.href.indexOf("kwp_4=")>0,u=(t=e||i.todayStr,s()[t]||{date:t});return u.categories||(u.categories={}),u.categories.general||(u.categories.general={articles_read:0,keywee_articles_read:0,time_spent:0,category:"general"}),(n=u.categories.general).last_visited_article!==o&&(n.articles_read++,a&&n.keywee_articles_read++,n.last_visited_article=o),function(e,t){var n=s();n[e]=t,c(n)}(e||i.todayStr,u),u},l=function(e,t){var n=s();return function(e,t,n){return Object.keys(e).filter(function(e){return e>=t&&(!n||e<=n)})}(n,e,t).map(function(e){return n[e]})};t.sendAdvancedPageView=function(e){var t;u(),t=function(){var e=l(i.last30DaysDateStr),t=l(i.firstMonthDateStr),n=l(i.todayStr,i.todayStr),r=a.getAndUpdateSessionData(new Date),s=function(e){return 1===e.length?o(e[0].categories):e.reduce(function(e,t){return e.concat(o(t.categories))},[])},c=function(e,t){return 1===e.length?e[0][t]:e.reduce(function(e,n){return e+n[t]},0)},u=s(e),f=s(t),d=c(s(n),"keywee_articles_read"),p={noad30:e.length,noadcm:t.length,nokart:d,pvps:r.pageViews,slensec:r.sessionLengthSeconds};return["articles_read","keywee_articles_read","time_spent"].forEach(function(e){var t=function(e){return e.split("_").map(function(e){return e[0]}).join("")}(e);[[t+"30d",u],[t+"cm",f]].forEach(function(t){var n=t[0],o=t[1],r=c(o,e);p[n]=(0,i.roundToTwo)(r)})}),p=function(e){return e.kar30d>0&&0===e.nokart?e.kru=1:e.kru=0,e}(p)}(),(0,i.sendCustomEvent)(e,"KWCEPV",t),(0,i.sendEvent)(e,"PageView")},t.initAdvancedPixel=function(e,t){var n,o,s;r=e,a=t,o=i.last30DaysDateStr,s={},i.firstMonthDateStr<o&&(o=i.firstMonthDateStr),n&&(o=n),l(o).forEach(function(e){s[e.date]=e}),c(s)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=t.DEFAULT_SNOWPLOW_SRC="//dc8xl0ndzn2cb.cloudfront.net/sp.js";t.SnowplowManager=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appendScriptToDom=function(e,t,n,i,o,r,a){e[o]||(e.GlobalSnowplowNamespace=e.GlobalSnowplowNamespace||[],e.GlobalSnowplowNamespace.push(o),e[o]=function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].q=e[o].q||[],r=t.createElement(n),a=t.getElementsByTagName(n)[0],r.async=1,r.src=i,a.parentNode.insertBefore(r,a))},this.initSnowplow=function(e,t,n,o,r,a){o=o||30,a=a||i,this.appendScriptToDom(e,e.document,"script",a,"snowplowKW"),e.snowplowKW("newTracker","cf","pixel.keywee.co",{appId:t,cookieDomain:n}),e.snowplowKW("setVisitorCookieTimeout",33696e3),r&&e.snowplowKW("enableActivityTracking",o,o)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t,n,i,o,r,a;t=window,n=document,i="script",t.fbq||(o=t.fbq=function(){o.callMethod?o.callMethod.apply(o,arguments):o.queue.push(arguments)},t._fbq||(t._fbq=o),o.push=o,o.loaded=!0,o.version="2.0",o.queue=[],(r=n.createElement(i)).async=!0,r.src="//connect.facebook.net/en_US/fbevents.js",(a=n.getElementsByTagName(i)[0]).parentNode.insertBefore(r,a)),window.fbq("init",e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tracker=void 0;var i=u(n(6)),o=n(5),r=n(4),a=u(n(3)),s=n(2),c=n(1);function u(e){return e&&e.__esModule?e:{default:e}}t.Tracker=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.snowplowManager=new o.SnowplowManager,this.setKeyweeAdId=function(e){var n=new RegExp("kwp_4=([^&#]*)","i").exec(t.location.href),i=n&&unescape(n[1])||"";""!==i&&this.cookieHandler.createCookie("keywee.kwp_4",i,30),t.snowplowKW&&t.snowplowKW("setUserIdFromCookie","keywee.kwp_4")},this.getConfig=function(e){var n=t.document.createElement("script");n.type="text/javascript",n.src="//cdn.keywee.co/config/"+e+".js",t.document.getElementsByTagName("head")[0].appendChild(n)},this.initiateTracking=function(){var e=this.config,n=this.testDomain||e.domain;this.cookieHandler=new s.CookieHandler(t.document,n);var o=new c.SessionTracker(this.cookieHandler);e.fbPixelId&&((0,i.default)(e.fbPixelId),(0,a.default)(e.fbPixelId,this.pixelPeriodTimeSec),(0,r.initAdvancedPixel)(t,o)),e.appId&&this.snowplowManager.initSnowplow(t,e.appId,n,this.pixelPeriodTimeSec,e.ping_activity,e.snowplow_src),this.setKeyweeAdId(n),this.sendPageView()},this.loadConfig=function(e){var t=e.in_eu||!1;this.config=e,t&&!this.trackEU||this.initiateTracking()},this.init=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.pixelPeriodTimeSec=t.pixelPeriodTimeSec,this.testDomain=t.testDomain,void 0===t.trackEU?this.trackEU=!0:this.trackEU=t.trackEU,this.getConfig(e)},this.sendPageView=function(){t.snowplowKW&&t.snowplowKW("trackPageView"),this.config.fbPixelId&&(0,r.sendAdvancedPageView)(this.config.fbPixelId)},this.setCustomUrl=function(e){t.snowplowKW&&t.snowplowKW("setCustomUrl",e)},this.applyFunc=function(){try{var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments),t=e.slice(1),n=e[0];"initialize"===n?this.init.apply(this,t):"sendPageView"===n?this.sendPageView.apply(this,t):"loadConfig"===n?this.loadConfig.apply(this,t):"setCustomUrl"===n&&this.setCustomUrl.apply(this,t)}catch(t){n=e[0],console.log("Error in keywee-analytics-tracker occurred trying to run the function "+n+": ",t)}}}},function(e,t,n){"use strict";var i=new(n(7).Tracker)(window);window.kwa&&window.kwa.q&&window.kwa.q.forEach(function(e){i.applyFunc.apply(i,e)});window.kwa=i.applyFunc.bind(i)}]);
//# sourceMappingURL=analytics.min.js.map
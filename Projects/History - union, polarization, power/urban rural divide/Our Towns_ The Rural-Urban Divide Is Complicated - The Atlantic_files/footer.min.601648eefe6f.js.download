SystemJS.config({
  paths: {
    'github:': 'jspm_packages/github/',
    'npm:': 'jspm_packages/npm/',
    'adsjs': 'https://www.theatlantic.com/packages/adsjs/ads.min.js',
    'disqus_embed': 'https://theatlanticcities.disqus.com/embed.js',
    'twitter': 'https://platform.twitter.com/widgets.js',
    'scrolljs': 'https://static.scroll.com/js/scroll.js'
  },
  sassPluginOptions: {
    'autoprefixer': true,
    'sassOptions': {
      'includePaths': [
        'node_modules/support-for/sass',
        'node_modules/normalize-scss/sass',
        'node_modules/breakpoint-sass/stylesheets'
      ]
    }
  },
  devConfig: {
    'map': {
      'babel-runtime': 'npm:babel-runtime@5.8.38',
      'core-js': 'npm:core-js@1.2.7',
      'plugin-babel': 'npm:systemjs-plugin-babel@0.0.25',
      'babel-plugin-syntax-dynamic-import': 'npm:babel-plugin-syntax-dynamic-import@6.18.0',
      'babel-plugin-transform-es2015-modules-systemjs': 'npm:babel-plugin-transform-es2015-modules-systemjs@6.24.1'
    },
    'packages': {
      'npm:babel-runtime@5.8.38': {
        'map': {}
      },
      'npm:core-js@1.2.7': {
        'map': {
          'systemjs-json': 'github:systemjs/plugin-json@0.1.2'
        }
      },
      'npm:babel-plugin-transform-es2015-modules-systemjs@6.24.1': {
        'map': {
          'babel-template': 'npm:babel-template@6.26.0',
          'babel-helper-hoist-variables': 'npm:babel-helper-hoist-variables@6.24.1',
          'babel-runtime': 'npm:babel-runtime@6.26.0'
        }
      },
      'npm:babel-template@6.26.0': {
        'map': {
          'babel-runtime': 'npm:babel-runtime@6.26.0',
          'lodash': 'npm:lodash@4.17.11',
          'babylon': 'npm:babylon@6.18.0',
          'babel-types': 'npm:babel-types@6.26.0',
          'babel-traverse': 'npm:babel-traverse@6.26.0'
        }
      },
      'npm:babel-helper-hoist-variables@6.24.1': {
        'map': {
          'babel-runtime': 'npm:babel-runtime@6.26.0',
          'babel-types': 'npm:babel-types@6.26.0'
        }
      },
      'npm:babel-types@6.26.0': {
        'map': {
          'babel-runtime': 'npm:babel-runtime@6.26.0',
          'lodash': 'npm:lodash@4.17.11',
          'to-fast-properties': 'npm:to-fast-properties@1.0.3',
          'esutils': 'npm:esutils@2.0.2'
        }
      },
      'npm:babel-traverse@6.26.0': {
        'map': {
          'babel-runtime': 'npm:babel-runtime@6.26.0',
          'babel-types': 'npm:babel-types@6.26.0',
          'babylon': 'npm:babylon@6.18.0',
          'lodash': 'npm:lodash@4.17.11',
          'invariant': 'npm:invariant@2.2.4',
          'babel-code-frame': 'npm:babel-code-frame@6.26.0',
          'globals': 'npm:globals@9.18.0',
          'babel-messages': 'npm:babel-messages@6.23.0',
          'debug': 'npm:debug@2.6.9'
        }
      },
      'npm:babel-code-frame@6.26.0': {
        'map': {
          'esutils': 'npm:esutils@2.0.2',
          'chalk': 'npm:chalk@1.1.3',
          'js-tokens': 'npm:js-tokens@3.0.2'
        }
      },
      'npm:babel-messages@6.23.0': {
        'map': {
          'babel-runtime': 'npm:babel-runtime@6.26.0'
        }
      },
      'npm:invariant@2.2.4': {
        'map': {
          'loose-envify': 'npm:loose-envify@1.4.0'
        }
      },
      'npm:loose-envify@1.4.0': {
        'map': {
          'js-tokens': 'npm:js-tokens@4.0.0'
        }
      }
    }
  },
  transpiler: 'plugin-babel',
  bundles: {
    'dist/theatlantic/js/bundle.js': [
      'theatlantic/js/main.js'
    ],
    'dist/theatlantic/js/legacy.js': [
      'theatlantic/js/legacy.js'
    ],
    'dist/theatlantic/js/polyfill.js': [
      'theatlantic/js/polyfill.js'
    ],
    'dist/theatlantic/js/bundle/homepage.js': [
      'theatlantic/js/homepage.js'
    ],
    'dist/theatlantic/js/bundle/editorial-projects.js': [
      'theatlantic/js/editorial-projects.js'
    ],
    'dist/theatlantic/js/bundle/components/crossword.js': [
      'theatlantic/js/components/crossword.js'
    ],
    'dist/theatlantic/js/bundle/components/recirc-content.js': [
      'theatlantic/js/components/recirc-content.js'
    ],
    'dist/theatlantic/js/bundle/components/newsletter-list.js': [
      'theatlantic/js/components/newsletter-list.js'
    ],
    'dist/theatlantic/js/bundle/lacroix/components/recirc-content.js': [
      'theatlantic/js/lacroix/components/recirc-content.js'
    ],
    'dist/theatlantic/js/bundle/components/most-popular.js': [
      'theatlantic/js/components/most-popular.js'
    ],
    'dist/theatlantic/js/bundle/lacroix/components/most-popular.js': [
      'theatlantic/js/lacroix/components/most-popular.js'
    ],
    'dist/theatlantic/js/bundle/lacroix/components/editors-choice.js': [
      'theatlantic/js/lacroix/components/editors-choice.js'
    ],
    'dist/theatlantic/js/bundle/components/navigation.js': [
      'theatlantic/js/components/navigation.js'
    ],
    'dist/theatlantic/js/bundle/components/article-video.js': [
      'theatlantic/js/components/article-video.js'
    ],
    'dist/theatlantic/js/bundle/lacroix/components/article-video.js': [
      'theatlantic/js/lacroix/components/article-video.js'
    ],
    'dist/theatlantic/js/bundle/components/footer.js': [
      'theatlantic/js/components/footer.js'
    ],
    'dist/theatlantic/js/bundle/lacroix/components/footer.js': [
      'theatlantic/js/lacroix/components/footer.js'
    ],
    'dist/theatlantic/js/bundle/components/share-social.js': [
      'theatlantic/js/components/share-social.js'
    ],
    'dist/theatlantic/js/bundle/components/leaflet.js': [
      'theatlantic/js/components/leaflet.js'
    ],
    'dist/theatlantic/js/bundle/lacroix/components/leaflet.js': [
      'theatlantic/js/lacroix/components/leaflet.js'
    ],
    'dist/theatlantic/js/bundle/components/related-video.js': [
      'theatlantic/js/components/related-video.js'
    ],
    'dist/theatlantic/js/bundle/utils/debug.js': [
      'theatlantic/js/utils/debug.js'
    ],
    'dist/theatlantic/js/bundle/utils/iframe-resizer.js': [
      'theatlantic/js/utils/iframe-resizer.js'
    ],
    'dist/theatlantic/js/bundle/pages/year-in-review.js': [
      'theatlantic/js/pages/year-in-review.js'
    ]
  },
  packages: {
    'citylab': {
      'main': 'js/main.js',
      'defaultExtension': 'js',
      'format': 'esm'
    },
    'theatlantic': {
      'main': 'js/main.js',
      'defaultExtension': 'js',
      'format': 'esm'
    },
    'systemjs-nunjucks-loader': {
      'defaultExtension': 'js',
      'main': 'index.js'
    },
    'hippo': {
      'main': 'base.html',
      'defaultExtension': 'html'
    },
    'concrete': {
      'main': 'base.html',
      'defaultExtension': 'html'
    },
    'npm:systemjs-plugin-babel@0.0.25': {
      'meta': {
        '*.js': {
          'loader': false
        }
      }
    }
  },
  meta: {
    '*.html': {
      'loader': 'systemjs-nunjucks-loader'
    },
    '*.js': {
      'babelOptions': {
        'optional': [
          'runtime',
          'optimisation.modules.system'
        ]
      }
    },
    '*.scss': {
      'loader': 'sass'
    },
    'pageInfo': {
      'build': false
    },
    'accountsConfig': {
      'build': false
    },
    'adsConfig': {
      'build': false
    },
    'vendorConfig': {
      'build': false
    },
    'adsjs': {
      'build': false,
      'format': 'global',
      'scriptLoad': true,
      'exports': 'ads'
    },
    'disqus_embed': {
      'build': false,
      'format': 'global',
      'scriptLoad': true,
      'exports': 'DISQUS'
    },
    'twitter': {
      'build': false,
      'format': 'global',
      'scriptLoad': true,
      'exports': 'twttr'
    },
    'gtm': {
      'build': false,
      'format': 'global',
      'scriptLoad': true,
      'exports': 'google_tag_manager'
    },
    'scrolljs': {
      'build': false,
      'format': 'global',
      'scriptLoad': true,
      'exports': 'Scroll'
    }
  },
  map: {
    'babel': 'npm:babel-core@5.8.38',
    'hippo': 'theatlantic/templates/hippo',
    'fromEntries': 'npm:object.fromentries@2.0.0'
  },
  nodeConfig: {
    'map': {}
  }
});

SystemJS.config({
  packageConfigPaths: [
    'npm:@*/*.json',
    'npm:*.json',
    'github:*/*.json'
  ],
  map: {
    'clipboard': 'npm:clipboard@2.0.4',
    'babel-polyfill': 'npm:babel-polyfill@6.26.0',
    'es6-object-assign': 'npm:es6-object-assign@1.1.0',
    'breakpoint': 'npm:breakpoint-sass@2.7.1',
    'jwt-decode': 'npm:jwt-decode@2.2.0',
    'nunjucks': 'npm:nunjucks@3.1.7',
    'a-sync-waterfall': 'npm:a-sync-waterfall@1.0.1',
    'asap': 'npm:asap@2.0.6',
    'graceful-fs': 'npm:graceful-fs@4.1.15',
    'accessibilityjs': 'npm:accessibilityjs@1.0.1',
    'assert': 'npm:jspm-nodelibs-assert@0.2.1',
    'bcrypt-pbkdf': 'npm:bcrypt-pbkdf@1.0.1',
    'buffer': 'npm:jspm-nodelibs-buffer@0.2.3',
    'child_process': 'npm:jspm-nodelibs-child_process@0.2.1',
    'constants': 'npm:jspm-nodelibs-constants@0.2.1',
    'crypto': 'npm:jspm-nodelibs-crypto@0.2.1',
    'css': 'github:systemjs/plugin-css@0.1.35',
    'debug': 'npm:debug@2.6.9',
    'dgram': 'npm:jspm-nodelibs-dgram@0.2.1',
    'dns': 'npm:jspm-nodelibs-dns@0.2.1',
    'domain': 'npm:jspm-nodelibs-domain@0.2.1',
    'ecc-jsbn': 'npm:ecc-jsbn@0.1.1',
    'events': 'npm:jspm-nodelibs-events@0.2.2',
    'fontfaceobserver': 'npm:fontfaceobserver@2.0.13',
    'fs': 'npm:jspm-nodelibs-fs@0.2.1',
    'fsevents': 'npm:fsevents@1.2.7',
    'http': 'npm:jspm-nodelibs-http@0.2.0',
    'https': 'npm:jspm-nodelibs-https@0.2.2',
    'iframe-resizer': 'npm:iframe-resizer@3.6.2',
    'intersection-observer': 'npm:intersection-observer@0.5.1',
    'jquery': 'npm:jquery@3.3.1',
    'js-cookie': 'npm:js-cookie@2.1.4',
    'jsbn': 'npm:jsbn@0.1.1',
    'json': 'github:systemjs/plugin-json@0.3.0',
    'lazysizes': 'github:theatlantic/lazysizes@4.0.5',
    'module': 'npm:jspm-nodelibs-module@0.2.1',
    'net': 'npm:jspm-nodelibs-net@0.2.1',
    'object.fromentries': 'npm:object.fromentries@2.0.0',
    'os': 'npm:jspm-nodelibs-os@0.2.2',
    'path': 'npm:jspm-nodelibs-path@0.2.3',
    'picturefill': 'npm:picturefill@3.0.2',
    'process': 'npm:jspm-nodelibs-process@0.2.1',
    'promise-polyfill': 'npm:promise-polyfill@7.1.2',
    'querystring': 'npm:jspm-nodelibs-querystring@0.2.2',
    'regenerator-runtime': 'npm:regenerator-runtime@0.13.2',
    'sass': 'github:fdintino/plugin-sass@0.7.0',
    'stream': 'npm:jspm-nodelibs-stream@0.2.1',
    'string_decoder': 'npm:jspm-nodelibs-string_decoder@0.2.2',
    'system-image': 'npm:system-image@0.1.0',
    'system-script': 'npm:system-script@0.1.9',
    'theatlantic-nunjucks-helpers': 'github:theatlantic/theatlantic-nunjucks-helpers@1.6.1',
    'tls': 'npm:jspm-nodelibs-tls@0.2.1',
    'tti-polyfill': 'npm:tti-polyfill@0.2.2',
    'tty': 'npm:jspm-nodelibs-tty@0.2.1',
    'tweetnacl': 'npm:tweetnacl@0.14.5',
    'url': 'npm:jspm-nodelibs-url@0.2.1',
    'usertiming': 'npm:usertiming@0.1.8',
    'util': 'npm:jspm-nodelibs-util@0.2.2',
    'uuid': 'npm:uuid@3.0.1',
    'vm': 'npm:jspm-nodelibs-vm@0.2.1',
    'waypoints': 'npm:waypoints@4.0.1',
    'whatwg-fetch': 'npm:whatwg-fetch@2.0.3',
    'zlib': 'npm:jspm-nodelibs-zlib@0.2.3'
  },
  packages: {
    'npm:bcrypt-pbkdf@1.0.1': {
      'map': {
        'tweetnacl': 'npm:tweetnacl@0.14.5'
      }
    },
    'npm:browserify-rsa@4.0.1': {
      'map': {
        'bn.js': 'npm:bn.js@4.11.8',
        'randombytes': 'npm:randombytes@2.0.6'
      }
    },
    'npm:browserify-sign@4.0.4': {
      'map': {
        'bn.js': 'npm:bn.js@4.11.8',
        'browserify-rsa': 'npm:browserify-rsa@4.0.1',
        'create-hash': 'npm:create-hash@1.2.0',
        'create-hmac': 'npm:create-hmac@1.1.7',
        'elliptic': 'npm:elliptic@6.4.1',
        'inherits': 'npm:inherits@2.0.3',
        'parse-asn1': 'npm:parse-asn1@5.1.3',
        'systemjs-json': 'github:systemjs/plugin-json@0.1.2'
      }
    },
    'npm:browserify-zlib@0.1.4': {
      'map': {
        'pako': 'npm:pako@0.2.9',
        'readable-stream': 'npm:readable-stream@2.3.6'
      }
    },
    'npm:buffer-xor@1.0.3': {
      'map': {
        'systemjs-json': 'github:systemjs/plugin-json@0.1.2'
      }
    },
    'npm:core-util-is@1.0.2': {
      'map': {}
    },
    'npm:des.js@1.0.0': {
      'map': {
        'inherits': 'npm:inherits@2.0.3',
        'minimalistic-assert': 'npm:minimalistic-assert@1.0.1'
      }
    },
    'npm:ecc-jsbn@0.1.1': {
      'map': {
        'jsbn': 'npm:jsbn@0.1.1'
      }
    },
    'npm:fs.realpath@1.0.0': {
      'map': {}
    },
    'npm:gauge@2.7.4': {
      'map': {
        'aproba': 'npm:aproba@1.2.0',
        'console-control-strings': 'npm:console-control-strings@1.1.0',
        'has-unicode': 'npm:has-unicode@2.0.1',
        'object-assign': 'npm:object-assign@4.1.1',
        'signal-exit': 'npm:signal-exit@3.0.2',
        'string-width': 'npm:string-width@1.0.2',
        'strip-ansi': 'npm:strip-ansi@3.0.1',
        'wide-align': 'npm:wide-align@1.1.3'
      }
    },
    'npm:has-unicode@2.0.1': {
      'map': {}
    },
    'npm:hmac-drbg@1.0.1': {
      'map': {
        'hash.js': 'npm:hash.js@1.1.7',
        'minimalistic-assert': 'npm:minimalistic-assert@1.0.1',
        'minimalistic-crypto-utils': 'npm:minimalistic-crypto-utils@1.0.1',
        'systemjs-json': 'github:systemjs/plugin-json@0.1.2'
      }
    },
    'npm:iframe-resizer@3.6.2': {
      'map': {}
    },
    'npm:inflight@1.0.6': {
      'map': {
        'once': 'npm:once@1.4.0',
        'wrappy': 'npm:wrappy@1.0.2'
      }
    },
    'npm:inherits@2.0.3': {
      'map': {}
    },
    'npm:is-fullwidth-code-point@1.0.0': {
      'map': {
        'number-is-nan': 'npm:number-is-nan@1.0.1'
      }
    },
    'npm:isarray@1.0.0': {
      'map': {
        'systemjs-json': 'github:systemjs/plugin-json@0.1.2'
      }
    },
    'npm:js-cookie@2.1.4': {
      'map': {}
    },
    'npm:minimatch@3.0.4': {
      'map': {
        'brace-expansion': 'npm:brace-expansion@1.1.11'
      }
    },
    'npm:mkdirp@0.5.1': {
      'map': {
        'minimist': 'npm:minimist@0.0.8'
      }
    },
    'npm:nopt@4.0.1': {
      'map': {
        'abbrev': 'npm:abbrev@1.1.1',
        'osenv': 'npm:osenv@0.1.5'
      }
    },
    'npm:npmlog@4.1.2': {
      'map': {
        'are-we-there-yet': 'npm:are-we-there-yet@1.1.5',
        'console-control-strings': 'npm:console-control-strings@1.1.0',
        'gauge': 'npm:gauge@2.7.4',
        'set-blocking': 'npm:set-blocking@2.0.0'
      }
    },
    'npm:once@1.4.0': {
      'map': {
        'wrappy': 'npm:wrappy@1.0.2'
      }
    },
    'npm:os-homedir@1.0.2': {
      'map': {}
    },
    'npm:os-tmpdir@1.0.2': {
      'map': {}
    },
    'npm:pako@0.2.9': {
      'map': {}
    },
    'npm:path-is-absolute@1.0.1': {
      'map': {}
    },
    'npm:picturefill@3.0.2': {
      'map': {}
    },
    'npm:punycode@1.3.2': {
      'map': {}
    },
    'npm:set-blocking@2.0.0': {
      'map': {}
    },
    'npm:signal-exit@3.0.2': {
      'map': {}
    },
    'npm:string-width@1.0.2': {
      'map': {
        'code-point-at': 'npm:code-point-at@1.1.0',
        'is-fullwidth-code-point': 'npm:is-fullwidth-code-point@1.0.0',
        'strip-ansi': 'npm:strip-ansi@3.0.1'
      }
    },
    'npm:string_decoder@0.10.31': {
      'map': {}
    },
    'npm:strip-ansi@3.0.1': {
      'map': {
        'ansi-regex': 'npm:ansi-regex@2.1.1'
      }
    },
    'npm:tti-polyfill@0.2.2': {
      'map': {}
    },
    'npm:url@0.11.0': {
      'map': {
        'punycode': 'npm:punycode@1.3.2',
        'querystring': 'npm:querystring@0.2.0'
      }
    },
    'npm:usertiming@0.1.8': {
      'map': {}
    },
    'npm:util-deprecate@1.0.2': {
      'map': {}
    },
    'npm:uuid@3.0.1': {
      'map': {}
    },
    'npm:waypoints@4.0.1': {
      'map': {
        'systemjs-json': 'github:systemjs/plugin-json@0.1.2'
      }
    },
    'npm:jspm-nodelibs-crypto@0.2.1': {
      'map': {
        'crypto-browserify': 'npm:crypto-browserify@3.12.0'
      }
    },
    'npm:jspm-nodelibs-domain@0.2.1': {
      'map': {
        'domain-browser': 'npm:domain-browser@1.2.0'
      }
    },
    'npm:jspm-nodelibs-buffer@0.2.3': {
      'map': {
        'buffer': 'npm:buffer@5.2.1'
      }
    },
    'npm:jspm-nodelibs-stream@0.2.1': {
      'map': {
        'stream-browserify': 'npm:stream-browserify@2.0.2'
      }
    },
    'npm:jspm-nodelibs-os@0.2.2': {
      'map': {
        'os-browserify': 'npm:os-browserify@0.3.0'
      }
    },
    'npm:jspm-nodelibs-http@0.2.0': {
      'map': {
        'http-browserify': 'npm:stream-http@2.8.3'
      }
    },
    'npm:stream-http@2.8.3': {
      'map': {
        'readable-stream': 'npm:readable-stream@2.3.6',
        'inherits': 'npm:inherits@2.0.3',
        'to-arraybuffer': 'npm:to-arraybuffer@1.0.1',
        'builtin-status-codes': 'npm:builtin-status-codes@3.0.0',
        'xtend': 'npm:xtend@4.0.1'
      }
    },
    'npm:jspm-nodelibs-string_decoder@0.2.2': {
      'map': {
        'string_decoder': 'npm:string_decoder@0.10.31'
      }
    },
    'npm:readable-stream@2.3.6': {
      'map': {
        'process-nextick-args': 'npm:process-nextick-args@2.0.0',
        'string_decoder': 'npm:string_decoder@1.1.1',
        'core-util-is': 'npm:core-util-is@1.0.2',
        'inherits': 'npm:inherits@2.0.3',
        'isarray': 'npm:isarray@1.0.0',
        'safe-buffer': 'npm:safe-buffer@5.1.2',
        'util-deprecate': 'npm:util-deprecate@1.0.2'
      }
    },
    'npm:string_decoder@1.1.1': {
      'map': {
        'safe-buffer': 'npm:safe-buffer@5.1.2'
      }
    },
    'npm:jspm-nodelibs-zlib@0.2.3': {
      'map': {
        'browserify-zlib': 'npm:browserify-zlib@0.1.4'
      }
    },
    'npm:debug@2.6.9': {
      'map': {
        'ms': 'npm:ms@2.0.0'
      }
    },
    'npm:buffer@5.2.1': {
      'map': {
        'base64-js': 'npm:base64-js@1.3.0',
        'ieee754': 'npm:ieee754@1.1.12'
      }
    },
    'npm:crypto-browserify@3.12.0': {
      'map': {
        'inherits': 'npm:inherits@2.0.3',
        'randomfill': 'npm:randomfill@1.0.4',
        'browserify-cipher': 'npm:browserify-cipher@1.0.1',
        'create-hash': 'npm:create-hash@1.2.0',
        'randombytes': 'npm:randombytes@2.0.6',
        'create-ecdh': 'npm:create-ecdh@4.0.3',
        'create-hmac': 'npm:create-hmac@1.1.7',
        'pbkdf2': 'npm:pbkdf2@3.0.17',
        'diffie-hellman': 'npm:diffie-hellman@5.0.3',
        'browserify-sign': 'npm:browserify-sign@4.0.4',
        'public-encrypt': 'npm:public-encrypt@4.0.3'
      }
    },
    'npm:randomfill@1.0.4': {
      'map': {
        'safe-buffer': 'npm:safe-buffer@5.1.2',
        'randombytes': 'npm:randombytes@2.0.6'
      }
    },
    'npm:create-hash@1.2.0': {
      'map': {
        'inherits': 'npm:inherits@2.0.3',
        'ripemd160': 'npm:ripemd160@2.0.2',
        'sha.js': 'npm:sha.js@2.4.11',
        'md5.js': 'npm:md5.js@1.3.5',
        'cipher-base': 'npm:cipher-base@1.0.4'
      }
    },
    'npm:randombytes@2.0.6': {
      'map': {
        'safe-buffer': 'npm:safe-buffer@5.1.2'
      }
    },
    'npm:create-hmac@1.1.7': {
      'map': {
        'create-hash': 'npm:create-hash@1.2.0',
        'inherits': 'npm:inherits@2.0.3',
        'safe-buffer': 'npm:safe-buffer@5.1.2',
        'ripemd160': 'npm:ripemd160@2.0.2',
        'sha.js': 'npm:sha.js@2.4.11',
        'cipher-base': 'npm:cipher-base@1.0.4'
      }
    },
    'npm:browserify-cipher@1.0.1': {
      'map': {
        'browserify-des': 'npm:browserify-des@1.0.2',
        'browserify-aes': 'npm:browserify-aes@1.2.0',
        'evp_bytestokey': 'npm:evp_bytestokey@1.0.3'
      }
    },
    'npm:pbkdf2@3.0.17': {
      'map': {
        'create-hash': 'npm:create-hash@1.2.0',
        'create-hmac': 'npm:create-hmac@1.1.7',
        'safe-buffer': 'npm:safe-buffer@5.1.2',
        'ripemd160': 'npm:ripemd160@2.0.2',
        'sha.js': 'npm:sha.js@2.4.11'
      }
    },
    'npm:browserify-des@1.0.2': {
      'map': {
        'inherits': 'npm:inherits@2.0.3',
        'safe-buffer': 'npm:safe-buffer@5.1.2',
        'cipher-base': 'npm:cipher-base@1.0.4',
        'des.js': 'npm:des.js@1.0.0'
      }
    },
    'npm:evp_bytestokey@1.0.3': {
      'map': {
        'safe-buffer': 'npm:safe-buffer@5.1.2',
        'md5.js': 'npm:md5.js@1.3.5'
      }
    },
    'npm:browserify-aes@1.2.0': {
      'map': {
        'create-hash': 'npm:create-hash@1.2.0',
        'evp_bytestokey': 'npm:evp_bytestokey@1.0.3',
        'safe-buffer': 'npm:safe-buffer@5.1.2',
        'cipher-base': 'npm:cipher-base@1.0.4',
        'inherits': 'npm:inherits@2.0.3',
        'buffer-xor': 'npm:buffer-xor@1.0.3'
      }
    },
    'npm:md5.js@1.3.5': {
      'map': {
        'safe-buffer': 'npm:safe-buffer@5.1.2',
        'inherits': 'npm:inherits@2.0.3',
        'hash-base': 'npm:hash-base@3.0.4'
      }
    },
    'npm:ripemd160@2.0.2': {
      'map': {
        'inherits': 'npm:inherits@2.0.3',
        'hash-base': 'npm:hash-base@3.0.4'
      }
    },
    'npm:sha.js@2.4.11': {
      'map': {
        'inherits': 'npm:inherits@2.0.3',
        'safe-buffer': 'npm:safe-buffer@5.1.2'
      }
    },
    'npm:cipher-base@1.0.4': {
      'map': {
        'inherits': 'npm:inherits@2.0.3',
        'safe-buffer': 'npm:safe-buffer@5.1.2'
      }
    },
    'npm:create-ecdh@4.0.3': {
      'map': {
        'elliptic': 'npm:elliptic@6.4.1',
        'bn.js': 'npm:bn.js@4.11.8'
      }
    },
    'npm:public-encrypt@4.0.3': {
      'map': {
        'bn.js': 'npm:bn.js@4.11.8',
        'create-hash': 'npm:create-hash@1.2.0',
        'randombytes': 'npm:randombytes@2.0.6',
        'safe-buffer': 'npm:safe-buffer@5.1.2',
        'browserify-rsa': 'npm:browserify-rsa@4.0.1',
        'parse-asn1': 'npm:parse-asn1@5.1.3'
      }
    },
    'npm:diffie-hellman@5.0.3': {
      'map': {
        'randombytes': 'npm:randombytes@2.0.6',
        'bn.js': 'npm:bn.js@4.11.8',
        'miller-rabin': 'npm:miller-rabin@4.0.1'
      }
    },
    'npm:elliptic@6.4.1': {
      'map': {
        'inherits': 'npm:inherits@2.0.3',
        'bn.js': 'npm:bn.js@4.11.8',
        'minimalistic-assert': 'npm:minimalistic-assert@1.0.1',
        'hmac-drbg': 'npm:hmac-drbg@1.0.1',
        'brorand': 'npm:brorand@1.1.0',
        'minimalistic-crypto-utils': 'npm:minimalistic-crypto-utils@1.0.1',
        'hash.js': 'npm:hash.js@1.1.7'
      }
    },
    'npm:hash-base@3.0.4': {
      'map': {
        'safe-buffer': 'npm:safe-buffer@5.1.2',
        'inherits': 'npm:inherits@2.0.3'
      }
    },
    'npm:rimraf@2.6.3': {
      'map': {
        'glob': 'npm:glob@7.1.3'
      }
    },
    'npm:parse-asn1@5.1.3': {
      'map': {
        'browserify-aes': 'npm:browserify-aes@1.2.0',
        'create-hash': 'npm:create-hash@1.2.0',
        'evp_bytestokey': 'npm:evp_bytestokey@1.0.3',
        'safe-buffer': 'npm:safe-buffer@5.1.2',
        'pbkdf2': 'npm:pbkdf2@3.0.17',
        'asn1.js': 'npm:asn1.js@4.10.1'
      }
    },
    'npm:hash.js@1.1.7': {
      'map': {
        'inherits': 'npm:inherits@2.0.3',
        'minimalistic-assert': 'npm:minimalistic-assert@1.0.1'
      }
    },
    'npm:miller-rabin@4.0.1': {
      'map': {
        'brorand': 'npm:brorand@1.1.0',
        'bn.js': 'npm:bn.js@4.11.8'
      }
    },
    'npm:glob@7.1.3': {
      'map': {
        'inherits': 'npm:inherits@2.0.3',
        'path-is-absolute': 'npm:path-is-absolute@1.0.1',
        'fs.realpath': 'npm:fs.realpath@1.0.0',
        'inflight': 'npm:inflight@1.0.6',
        'once': 'npm:once@1.4.0',
        'minimatch': 'npm:minimatch@3.0.4'
      }
    },
    'npm:asn1.js@4.10.1': {
      'map': {
        'bn.js': 'npm:bn.js@4.11.8',
        'inherits': 'npm:inherits@2.0.3',
        'minimalistic-assert': 'npm:minimalistic-assert@1.0.1'
      }
    },
    'npm:brace-expansion@1.1.11': {
      'map': {
        'balanced-match': 'npm:balanced-match@1.0.0',
        'concat-map': 'npm:concat-map@0.0.1'
      }
    },
    'npm:jspm-nodelibs-url@0.2.1': {
      'map': {
        'url': 'npm:url@0.11.0'
      }
    },
    'npm:stream-browserify@2.0.2': {
      'map': {
        'inherits': 'npm:inherits@2.0.3',
        'readable-stream': 'npm:readable-stream@2.3.6'
      }
    },
    'npm:fsevents@1.2.7': {
      'map': {
        'nan': 'npm:nan@2.12.1',
        'node-pre-gyp': 'npm:node-pre-gyp@0.10.3'
      }
    },
    'npm:node-pre-gyp@0.10.3': {
      'map': {
        'detect-libc': 'npm:detect-libc@1.0.3',
        'mkdirp': 'npm:mkdirp@0.5.1',
        'npmlog': 'npm:npmlog@4.1.2',
        'nopt': 'npm:nopt@4.0.1',
        'npm-packlist': 'npm:npm-packlist@1.2.0',
        'semver': 'npm:semver@5.6.0',
        'rimraf': 'npm:rimraf@2.6.3',
        'rc': 'npm:rc@1.2.8',
        'tar': 'npm:tar@4.4.8',
        'needle': 'npm:needle@2.2.4'
      }
    },
    'npm:tar@4.4.8': {
      'map': {
        'mkdirp': 'npm:mkdirp@0.5.1',
        'safe-buffer': 'npm:safe-buffer@5.1.2',
        'fs-minipass': 'npm:fs-minipass@1.2.5',
        'chownr': 'npm:chownr@1.1.1',
        'minizlib': 'npm:minizlib@1.2.1',
        'yallist': 'npm:yallist@3.0.3',
        'minipass': 'npm:minipass@2.3.5'
      }
    },
    'npm:rc@1.2.8': {
      'map': {
        'minimist': 'npm:minimist@1.2.0',
        'deep-extend': 'npm:deep-extend@0.6.0',
        'strip-json-comments': 'npm:strip-json-comments@2.0.1',
        'ini': 'npm:ini@1.3.5'
      }
    },
    'npm:needle@2.2.4': {
      'map': {
        'debug': 'npm:debug@2.6.9',
        'sax': 'npm:sax@1.2.4',
        'iconv-lite': 'npm:iconv-lite@0.4.24'
      }
    },
    'npm:npm-packlist@1.2.0': {
      'map': {
        'npm-bundled': 'npm:npm-bundled@1.0.5',
        'ignore-walk': 'npm:ignore-walk@3.0.1'
      }
    },
    'npm:are-we-there-yet@1.1.5': {
      'map': {
        'readable-stream': 'npm:readable-stream@2.3.6',
        'delegates': 'npm:delegates@1.0.0'
      }
    },
    'npm:fs-minipass@1.2.5': {
      'map': {
        'minipass': 'npm:minipass@2.3.5'
      }
    },
    'npm:minizlib@1.2.1': {
      'map': {
        'minipass': 'npm:minipass@2.3.5'
      }
    },
    'npm:osenv@0.1.5': {
      'map': {
        'os-homedir': 'npm:os-homedir@1.0.2',
        'os-tmpdir': 'npm:os-tmpdir@1.0.2'
      }
    },
    'npm:minipass@2.3.5': {
      'map': {
        'safe-buffer': 'npm:safe-buffer@5.1.2',
        'yallist': 'npm:yallist@3.0.3'
      }
    },
    'npm:ignore-walk@3.0.1': {
      'map': {
        'minimatch': 'npm:minimatch@3.0.4'
      }
    },
    'npm:wide-align@1.1.3': {
      'map': {
        'string-width': 'npm:string-width@2.1.1'
      }
    },
    'npm:string-width@2.1.1': {
      'map': {
        'strip-ansi': 'npm:strip-ansi@4.0.0',
        'is-fullwidth-code-point': 'npm:is-fullwidth-code-point@2.0.0'
      }
    },
    'npm:iconv-lite@0.4.24': {
      'map': {
        'safer-buffer': 'npm:safer-buffer@2.1.2'
      }
    },
    'npm:strip-ansi@4.0.0': {
      'map': {
        'ansi-regex': 'npm:ansi-regex@3.0.0'
      }
    },
    'npm:asap@2.0.6': {
      'map': {
        'a-sync-waterfall': 'npm:a-sync-waterfall@1.0.1',
        'asap': 'npm:asap@2.0.6'
      }
    },
    'npm:a-sync-waterfall@1.0.1': {
      'map': {
        'a-sync-waterfall': 'npm:a-sync-waterfall@1.0.1',
        'asap': 'npm:asap@2.0.6'
      }
    },
    'npm:nunjucks@3.1.7': {
      'map': {
        'a-sync-waterfall': 'npm:a-sync-waterfall@1.0.1',
        'asap': 'npm:asap@2.0.6'
      }
    },
    'npm:babel-runtime@6.26.0': {
      'map': {
        'regenerator-runtime': 'npm:regenerator-runtime@0.11.1',
        'core-js': 'npm:core-js@2.6.5'
      }
    },
    'npm:chalk@1.1.3': {
      'map': {
        'ansi-styles': 'npm:ansi-styles@2.2.1',
        'escape-string-regexp': 'npm:escape-string-regexp@1.0.5',
        'has-ansi': 'npm:has-ansi@2.0.0',
        'strip-ansi': 'npm:strip-ansi@3.0.1',
        'supports-color': 'npm:supports-color@2.0.0'
      }
    },
    'npm:has-ansi@2.0.0': {
      'map': {
        'ansi-regex': 'npm:ansi-regex@2.1.1'
      }
    },
    'github:fdintino/plugin-sass@0.7.0': {
      'map': {
        'postcss': 'npm:postcss@5.2.18',
        'autoprefixer': 'npm:autoprefixer@6.7.7',
        'css-asset-copier': 'npm:css-asset-copier@1.0.2',
        'css-url-rewriter-ex': 'npm:css-url-rewriter-ex@1.0.6',
        'sass.js': 'npm:sass.js@0.9.13',
        'reqwest': 'github:ded/reqwest@2.0.5'
      }
    },
    'npm:autoprefixer@6.7.7': {
      'map': {
        'postcss': 'npm:postcss@5.2.18',
        'normalize-range': 'npm:normalize-range@0.1.2',
        'num2fraction': 'npm:num2fraction@1.2.2',
        'postcss-value-parser': 'npm:postcss-value-parser@3.3.1',
        'browserslist': 'npm:browserslist@1.7.7',
        'caniuse-db': 'npm:caniuse-db@1.0.30000932'
      }
    },
    'npm:postcss@5.2.18': {
      'map': {
        'js-base64': 'npm:js-base64@2.5.1',
        'supports-color': 'npm:supports-color@3.2.3',
        'chalk': 'npm:chalk@1.1.3',
        'source-map': 'npm:source-map@0.5.7'
      }
    },
    'npm:supports-color@3.2.3': {
      'map': {
        'has-flag': 'npm:has-flag@1.0.0'
      }
    },
    'npm:css-asset-copier@1.0.2': {
      'map': {
        'fs-extra': 'npm:fs-extra@0.30.0',
        'babel-runtime': 'npm:babel-runtime@6.26.0'
      }
    },
    'npm:css-url-rewriter-ex@1.0.6': {
      'map': {
        'babel-runtime': 'npm:babel-runtime@6.26.0'
      }
    },
    'npm:fs-extra@0.30.0': {
      'map': {
        'graceful-fs': 'npm:graceful-fs@4.1.15',
        'path-is-absolute': 'npm:path-is-absolute@1.0.1',
        'klaw': 'npm:klaw@1.3.1',
        'jsonfile': 'npm:jsonfile@2.4.0',
        'rimraf': 'npm:rimraf@2.6.3'
      }
    },
    'npm:browserslist@1.7.7': {
      'map': {
        'electron-to-chromium': 'npm:electron-to-chromium@1.3.108',
        'caniuse-db': 'npm:caniuse-db@1.0.30000932'
      }
    },
    'npm:babel-polyfill@6.26.0': {
      'map': {
        'regenerator-runtime': 'npm:regenerator-runtime@0.10.5',
        'core-js': 'npm:core-js@2.6.5',
        'babel-runtime': 'npm:babel-runtime@6.26.0'
      }
    },
    'npm:object.fromentries@2.0.0': {
      'map': {
        'has': 'npm:has@1.0.3',
        'define-properties': 'npm:define-properties@1.1.3',
        'es-abstract': 'npm:es-abstract@1.13.0',
        'function-bind': 'npm:function-bind@1.1.1'
      }
    },
    'npm:has@1.0.3': {
      'map': {
        'function-bind': 'npm:function-bind@1.1.1'
      }
    },
    'npm:es-abstract@1.13.0': {
      'map': {
        'function-bind': 'npm:function-bind@1.1.1',
        'has': 'npm:has@1.0.3',
        'is-callable': 'npm:is-callable@1.1.4',
        'is-regex': 'npm:is-regex@1.0.4',
        'es-to-primitive': 'npm:es-to-primitive@1.2.0',
        'object-keys': 'npm:object-keys@1.1.1'
      }
    },
    'npm:es-to-primitive@1.2.0': {
      'map': {
        'is-callable': 'npm:is-callable@1.1.4',
        'is-symbol': 'npm:is-symbol@1.0.2',
        'is-date-object': 'npm:is-date-object@1.0.1'
      }
    },
    'npm:is-regex@1.0.4': {
      'map': {
        'has': 'npm:has@1.0.3'
      }
    },
    'npm:define-properties@1.1.3': {
      'map': {
        'object-keys': 'npm:object-keys@1.1.1'
      }
    },
    'npm:is-symbol@1.0.2': {
      'map': {
        'has-symbols': 'npm:has-symbols@1.0.0'
      }
    },
    'npm:clipboard@2.0.4': {
      'map': {
        'good-listener': 'npm:good-listener@1.2.2',
        'select': 'npm:select@1.1.2',
        'tiny-emitter': 'npm:tiny-emitter@2.1.0'
      }
    },
    'npm:good-listener@1.2.2': {
      'map': {
        'delegate': 'npm:delegate@3.2.0'
      }
    }
  }
});

;System.registerDynamic("npm:usertiming@0.1.8.json",[],!0,function(){return{main:"src/usertiming.js",format:"cjs",meta:{"*":{globals:{process:"process"}},"*.json":{format:"json"}}}}),System.registerDynamic("npm:usertiming@0.1.8/src/usertiming.js",["process"],!0,function(a,b,c){var d=a("process");this||self;!function(a){"use strict";void 0===a&&(a={}),void 0===a.performance&&(a.performance={}),a._perfRefForUserTimingPolyfill=a.performance,a.performance.userTimingJsNow=!1,a.performance.userTimingJsNowPrefixed=!1,a.performance.userTimingJsUserTiming=!1,a.performance.userTimingJsUserTimingPrefixed=!1,a.performance.userTimingJsPerformanceTimeline=!1,a.performance.userTimingJsPerformanceTimelinePrefixed=!1;var b,e,f=[],g=[],h=null;if("function"!=typeof a.performance.now){for(a.performance.userTimingJsNow=!0,g=["webkitNow","msNow","mozNow"],b=0;b<g.length;b++)if("function"==typeof a.performance[g[b]]){a.performance.now=a.performance[g[b]],a.performance.userTimingJsNowPrefixed=!0;break}var i=+new Date;a.performance.timing&&a.performance.timing.navigationStart?i=a.performance.timing.navigationStart:void 0!==d&&"function"==typeof d.hrtime&&(i=d.hrtime(),a.performance.now=function(){var a=d.hrtime(i);return 1e3*a[0]+1e-6*a[1]}),"function"!=typeof a.performance.now&&(Date.now?a.performance.now=function(){return Date.now()-i}:a.performance.now=function(){return+new Date-i})}var j=function(){},k=function(){},l=[],m=!1,n=!1;if("function"!=typeof a.performance.getEntries||"function"!=typeof a.performance.mark){for("function"==typeof a.performance.getEntries&&"function"!=typeof a.performance.mark&&(n=!0),a.performance.userTimingJsPerformanceTimeline=!0,f=["webkit","moz"],g=["getEntries","getEntriesByName","getEntriesByType"],b=0;b<g.length;b++)for(e=0;e<f.length;e++)h=f[e]+g[b].substr(0,1).toUpperCase()+g[b].substr(1),"function"==typeof a.performance[h]&&(a.performance[g[b]]=a.performance[h],a.performance.userTimingJsPerformanceTimelinePrefixed=!0);j=function(a){l.push(a),"measure"===a.entryType&&(m=!0)};var o=function(){m&&(l.sort(function(a,b){return a.startTime-b.startTime}),m=!1)};if(k=function(a,c){for(b=0;b<l.length;)l[b].entryType===a&&(void 0===c||l[b].name===c)?l.splice(b,1):b++},"function"!=typeof a.performance.getEntries||n){var p=a.performance.getEntries;a.performance.getEntries=function(){o();var b=l.slice(0);return n&&p&&(Array.prototype.push.apply(b,p.call(a.performance)),b.sort(function(a,b){return a.startTime-b.startTime})),b}}if("function"!=typeof a.performance.getEntriesByType||n){var q=a.performance.getEntriesByType;a.performance.getEntriesByType=function(c){if(void 0===c||"mark"!==c&&"measure"!==c)return n&&q?q.call(a.performance,c):[];"measure"===c&&o();var d=[];for(b=0;b<l.length;b++)l[b].entryType===c&&d.push(l[b]);return d}}if("function"!=typeof a.performance.getEntriesByName||n){var r=a.performance.getEntriesByName;a.performance.getEntriesByName=function(c,d){if(d&&"mark"!==d&&"measure"!==d)return n&&r?r.call(a.performance,c,d):[];void 0!==d&&"measure"===d&&o();var e=[];for(b=0;b<l.length;b++)void 0!==d&&l[b].entryType!==d||l[b].name===c&&e.push(l[b]);return n&&r&&(Array.prototype.push.apply(e,r.call(a.performance,c,d)),e.sort(function(a,b){return a.startTime-b.startTime})),e}}}if("function"!=typeof a.performance.mark){for(a.performance.userTimingJsUserTiming=!0,f=["webkit","moz","ms"],g=["mark","measure","clearMarks","clearMeasures"],b=0;b<g.length;b++)for(e=0;e<f.length;e++)h=f[e]+g[b].substr(0,1).toUpperCase()+g[b].substr(1),"function"==typeof a.performance[h]&&(a.performance[g[b]]=a.performance[h],a.performance.userTimingJsUserTimingPrefixed=!0);var s={};"function"!=typeof a.performance.mark&&(a.performance.mark=function(b){var c=a.performance.now();if(void 0===b)throw new SyntaxError("Mark name must be specified");if(a.performance.timing&&b in a.performance.timing)throw new SyntaxError("Mark name is not allowed");s[b]||(s[b]=[]),s[b].push(c),j({entryType:"mark",name:b,startTime:c,duration:0})}),"function"!=typeof a.performance.clearMarks&&(a.performance.clearMarks=function(a){a?s[a]=[]:s={},k("mark",a)}),"function"!=typeof a.performance.measure&&(a.performance.measure=function(b,c,d){var e=a.performance.now();if(void 0===b)throw new SyntaxError("Measure must be specified");if(!c)return void j({entryType:"measure",name:b,startTime:0,duration:e});var f=0;if(a.performance.timing&&c in a.performance.timing){if("navigationStart"!==c&&0===a.performance.timing[c])throw new Error(c+" has a timing of 0");f=a.performance.timing[c]-a.performance.timing.navigationStart}else{if(!(c in s))throw new Error(c+" mark not found");f=s[c][s[c].length-1]}var g=e;if(d)if(g=0,a.performance.timing&&d in a.performance.timing){if("navigationStart"!==d&&0===a.performance.timing[d])throw new Error(d+" has a timing of 0");g=a.performance.timing[d]-a.performance.timing.navigationStart}else{if(!(d in s))throw new Error(d+" mark not found");g=s[d][s[d].length-1]}j({entryType:"measure",name:b,startTime:f,duration:g-f})}),"function"!=typeof a.performance.clearMeasures&&(a.performance.clearMeasures=function(a){k("measure",a)})}void 0!==c&&void 0!==c.exports&&(c.exports=a.performance)}("undefined"!=typeof window?window:void 0)}),System.registerDynamic("github:systemjs/plugin-css@0.1.35.json",[],!0,function(){return{main:"css"}}),System.registerDynamic("github:systemjs/plugin-css@0.1.35/css.js",[],!0,function(a,b,c){function d(a){return o||(o=System.import("./css-plugin-base.js",c.id).then(function(a){return new a(function(a,b){return{css:a,map:null,moduleSource:null,moduleFormat:null}})}))}function e(a,b){var c=[];return f(a,function(a){b(a)&&c.push(a)}),c}function f(a,b){for(var c=0;c<a.length;c++)b(a[c])}this||self;if("undefined"!=typeof window){var g=100,h=document.getElementsByTagName("head")[0],i=!!window.navigator.userAgent.match(/AppleWebKit\/([^ ;]*)/),j=function(a,b){setTimeout(function(){for(var c=0;c<document.styleSheets.length;c++){if(document.styleSheets[c].href==a.href)return b()}j(a,b)},10)},k=function(a){var b=!0;return f(a,function(a){a.hasAttribute("data-systemjs-css")||(b=!1,a.setAttribute("data-systemjs-css",""))}),b},l=function(a){return e(h.getElementsByTagName("link"),function(b){return b.href===a})},m=function(){},n=function(a,b){return new Promise(function(c,d){var e=setTimeout(function(){d("Unable to load CSS")},1e3*g),f=function(a){clearTimeout(e),k.onload=k.onerror=m,setTimeout(function(){a?d(a):c("")},7)},k=document.createElement("link");k.type="text/css",k.rel="stylesheet",k.href=a,k.setAttribute("data-systemjs-css",""),i?j(k,f):k.onload=function(){f()},k.onerror=function(a){f(a.error||new Error("Error loading CSS file."))},b.length?h.insertBefore(k,b[0]):h.appendChild(k)}).then(function(a){return f(b,function(a){a.parentElement.removeChild(a)}),a},function(a){throw f(b,function(a){a.parentElement.removeChild(a)}),a})};b.fetch=function(a){var b=l(a.address);return k(b)?n(a.address,b):""}}else{var o;b.cssPlugin=!0,b.fetch=function(a,b){return this.builder?b(a):""},b.translate=function(a,b){if(!this.builder)return"";var c=this;return d(c).then(function(d){return d.translate.call(c,a,b)})},b.instantiate=function(a,b){if(this.builder){var c=this;return d(c).then(function(d){return d.instantiate.call(c,a,b)})}},b.bundle=function(a,b,c){var e=this;return d(e).then(function(d){return d.bundle.call(e,a,b,c)})},b.listAssets=function(a,b){var c=this;return d(c).then(function(d){return d.listAssets.call(c,a,b)})}}}),System.registerDynamic("npm:whatwg-fetch@2.0.3.json",[],!0,function(){return{main:"fetch.js",format:"cjs",meta:{"*.json":{format:"json"}}}}),System.registerDynamic("npm:whatwg-fetch@2.0.3/fetch.js",[],!0,function(a,b,c){this||self;!function(a){"use strict";function b(a){if("string"!=typeof a&&(a=String(a)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(a))throw new TypeError("Invalid character in header field name");return a.toLowerCase()}function c(a){return"string"!=typeof a&&(a=String(a)),a}function d(a){var b={next:function(){var b=a.shift();return{done:void 0===b,value:b}}};return r.iterable&&(b[Symbol.iterator]=function(){return b}),b}function e(a){this.map={},a instanceof e?a.forEach(function(a,b){this.append(b,a)},this):Array.isArray(a)?a.forEach(function(a){this.append(a[0],a[1])},this):a&&Object.getOwnPropertyNames(a).forEach(function(b){this.append(b,a[b])},this)}function f(a){if(a.bodyUsed)return Promise.reject(new TypeError("Already read"));a.bodyUsed=!0}function g(a){return new Promise(function(b,c){a.onload=function(){b(a.result)},a.onerror=function(){c(a.error)}})}function h(a){var b=new FileReader,c=g(b);return b.readAsArrayBuffer(a),c}function i(a){var b=new FileReader,c=g(b);return b.readAsText(a),c}function j(a){for(var b=new Uint8Array(a),c=new Array(b.length),d=0;d<b.length;d++)c[d]=String.fromCharCode(b[d]);return c.join("")}function k(a){if(a.slice)return a.slice(0);var b=new Uint8Array(a.byteLength);return b.set(new Uint8Array(a)),b.buffer}function l(){return this.bodyUsed=!1,this._initBody=function(a){if(this._bodyInit=a,a)if("string"==typeof a)this._bodyText=a;else if(r.blob&&Blob.prototype.isPrototypeOf(a))this._bodyBlob=a;else if(r.formData&&FormData.prototype.isPrototypeOf(a))this._bodyFormData=a;else if(r.searchParams&&URLSearchParams.prototype.isPrototypeOf(a))this._bodyText=a.toString();else if(r.arrayBuffer&&r.blob&&t(a))this._bodyArrayBuffer=k(a.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!r.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(a)&&!u(a))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=k(a)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof a?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r.searchParams&&URLSearchParams.prototype.isPrototypeOf(a)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r.blob&&(this.blob=function(){var a=f(this);if(a)return a;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?f(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(h)}),this.text=function(){var a=f(this);if(a)return a;if(this._bodyBlob)return i(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(j(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r.formData&&(this.formData=function(){return this.text().then(o)}),this.json=function(){return this.text().then(JSON.parse)},this}function m(a){var b=a.toUpperCase();return v.indexOf(b)>-1?b:a}function n(a,b){b=b||{};var c=b.body;if(a instanceof n){if(a.bodyUsed)throw new TypeError("Already read");this.url=a.url,this.credentials=a.credentials,b.headers||(this.headers=new e(a.headers)),this.method=a.method,this.mode=a.mode,c||null==a._bodyInit||(c=a._bodyInit,a.bodyUsed=!0)}else this.url=String(a);if(this.credentials=b.credentials||this.credentials||"omit",!b.headers&&this.headers||(this.headers=new e(b.headers)),this.method=m(b.method||this.method||"GET"),this.mode=b.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&c)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(c)}function o(a){var b=new FormData;return a.trim().split("&").forEach(function(a){if(a){var c=a.split("="),d=c.shift().replace(/\+/g," "),e=c.join("=").replace(/\+/g," ");b.append(decodeURIComponent(d),decodeURIComponent(e))}}),b}function p(a){var b=new e;return a.split(/\r?\n/).forEach(function(a){var c=a.split(":"),d=c.shift().trim();if(d){var e=c.join(":").trim();b.append(d,e)}}),b}function q(a,b){b||(b={}),this.type="default",this.status="status"in b?b.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in b?b.statusText:"OK",this.headers=new e(b.headers),this.url=b.url||"",this._initBody(a)}if(!a.fetch){var r={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch(a){return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};if(r.arrayBuffer)var s=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],t=function(a){return a&&DataView.prototype.isPrototypeOf(a)},u=ArrayBuffer.isView||function(a){return a&&s.indexOf(Object.prototype.toString.call(a))>-1};e.prototype.append=function(a,d){a=b(a),d=c(d);var e=this.map[a];this.map[a]=e?e+","+d:d},e.prototype.delete=function(a){delete this.map[b(a)]},e.prototype.get=function(a){return a=b(a),this.has(a)?this.map[a]:null},e.prototype.has=function(a){return this.map.hasOwnProperty(b(a))},e.prototype.set=function(a,d){this.map[b(a)]=c(d)},e.prototype.forEach=function(a,b){for(var c in this.map)this.map.hasOwnProperty(c)&&a.call(b,this.map[c],c,this)},e.prototype.keys=function(){var a=[];return this.forEach(function(b,c){a.push(c)}),d(a)},e.prototype.values=function(){var a=[];return this.forEach(function(b){a.push(b)}),d(a)},e.prototype.entries=function(){var a=[];return this.forEach(function(b,c){a.push([c,b])}),d(a)},r.iterable&&(e.prototype[Symbol.iterator]=e.prototype.entries);var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];n.prototype.clone=function(){return new n(this,{body:this._bodyInit})},l.call(n.prototype),l.call(q.prototype),q.prototype.clone=function(){return new q(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new e(this.headers),url:this.url})},q.error=function(){var a=new q(null,{status:0,statusText:""});return a.type="error",a};var w=[301,302,303,307,308];q.redirect=function(a,b){if(-1===w.indexOf(b))throw new RangeError("Invalid status code");return new q(null,{status:b,headers:{location:a}})},a.Headers=e,a.Request=n,a.Response=q,a.fetch=function(a,b){return new Promise(function(c,d){var e=new n(a,b),f=new XMLHttpRequest;f.onload=function(){var a={status:f.status,statusText:f.statusText,headers:p(f.getAllResponseHeaders()||"")};a.url="responseURL"in f?f.responseURL:a.headers.get("X-Request-URL");var b="response"in f?f.response:f.responseText;c(new q(b,a))},f.onerror=function(){d(new TypeError("Network request failed"))},f.ontimeout=function(){d(new TypeError("Network request failed"))},f.open(e.method,e.url,!0),"include"===e.credentials&&(f.withCredentials=!0),"responseType"in f&&r.blob&&(f.responseType="blob"),e.headers.forEach(function(a,b){f.setRequestHeader(b,a)}),f.send(void 0===e._bodyInit?null:e._bodyInit)})},a.fetch.polyfill=!0}}("undefined"!=typeof self?self:b)}),System.registerDynamic("npm:regenerator-runtime@0.13.2.json",[],!0,function(){return{main:"runtime.js",format:"cjs",meta:{"*.json":{format:"json"}}}}),System.registerDynamic("npm:regenerator-runtime@0.13.2/runtime.js",[],!0,function(a,b,c){var d=(this||self,function(a){"use strict";function b(a,b,c,e){var f=b&&b.prototype instanceof d?b:d,g=Object.create(f.prototype),h=new m(e||[]);return g._invoke=i(a,c,h),g}function c(a,b,c){try{return{type:"normal",arg:a.call(b,c)}}catch(a){return{type:"throw",arg:a}}}function d(){}function e(){}function f(){}function g(a){["next","throw","return"].forEach(function(b){a[b]=function(a){return this._invoke(b,a)}})}function h(a){function b(d,e,f,g){var h=c(a[d],a,e);if("throw"!==h.type){var i=h.arg,j=i.value;return j&&"object"==typeof j&&r.call(j,"__await")?Promise.resolve(j.__await).then(function(a){b("next",a,f,g)},function(a){b("throw",a,f,g)}):Promise.resolve(j).then(function(a){i.value=a,f(i)},function(a){return b("throw",a,f,g)})}g(h.arg)}function d(a,c){function d(){return new Promise(function(d,e){b(a,c,d,e)})}return e=e?e.then(d,d):d()}var e;this._invoke=d}function i(a,b,d){var e=w;return function(f,g){if(e===y)throw new Error("Generator is already running");if(e===z){if("throw"===f)throw g;return o()}for(d.method=f,d.arg=g;;){var h=d.delegate;if(h){var i=j(h,d);if(i){if(i===A)continue;return i}}if("next"===d.method)d.sent=d._sent=d.arg;else if("throw"===d.method){if(e===w)throw e=z,d.arg;d.dispatchException(d.arg)}else"return"===d.method&&d.abrupt("return",d.arg);e=y;var k=c(a,b,d);if("normal"===k.type){if(e=d.done?z:x,k.arg===A)continue;return{value:k.arg,done:d.done}}"throw"===k.type&&(e=z,d.method="throw",d.arg=k.arg)}}}function j(a,b){var d=a.iterator[b.method];if(d===p){if(b.delegate=null,"throw"===b.method){if(a.iterator.return&&(b.method="return",b.arg=p,j(a,b),"throw"===b.method))return A;b.method="throw",b.arg=new TypeError("The iterator does not provide a 'throw' method")}return A}var e=c(d,a.iterator,b.arg);if("throw"===e.type)return b.method="throw",b.arg=e.arg,b.delegate=null,A;var f=e.arg;return f?f.done?(b[a.resultName]=f.value,b.next=a.nextLoc,"return"!==b.method&&(b.method="next",b.arg=p),b.delegate=null,A):f:(b.method="throw",b.arg=new TypeError("iterator result is not an object"),b.delegate=null,A)}function k(a){var b={tryLoc:a[0]};1 in a&&(b.catchLoc=a[1]),2 in a&&(b.finallyLoc=a[2],b.afterLoc=a[3]),this.tryEntries.push(b)}function l(a){var b=a.completion||{};b.type="normal",delete b.arg,a.completion=b}function m(a){this.tryEntries=[{tryLoc:"root"}],a.forEach(k,this),this.reset(!0)}function n(a){if(a){var b=a[t];if(b)return b.call(a);if("function"==typeof a.next)return a;if(!isNaN(a.length)){var c=-1,d=function b(){for(;++c<a.length;)if(r.call(a,c))return b.value=a[c],b.done=!1,b;return b.value=p,b.done=!0,b};return d.next=d}}return{next:o}}function o(){return{value:p,done:!0}}var p,q=Object.prototype,r=q.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},t=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",v=s.toStringTag||"@@toStringTag";a.wrap=b;var w="suspendedStart",x="suspendedYield",y="executing",z="completed",A={},B={};B[t]=function(){return this};var C=Object.getPrototypeOf,D=C&&C(C(n([])));D&&D!==q&&r.call(D,t)&&(B=D);var E=f.prototype=d.prototype=Object.create(B);return e.prototype=E.constructor=f,f.constructor=e,f[v]=e.displayName="GeneratorFunction",a.isGeneratorFunction=function(a){var b="function"==typeof a&&a.constructor;return!!b&&(b===e||"GeneratorFunction"===(b.displayName||b.name))},a.mark=function(a){return Object.setPrototypeOf?Object.setPrototypeOf(a,f):(a.__proto__=f,v in a||(a[v]="GeneratorFunction")),a.prototype=Object.create(E),a},a.awrap=function(a){return{__await:a}},g(h.prototype),h.prototype[u]=function(){return this},a.AsyncIterator=h,a.async=function(c,d,e,f){var g=new h(b(c,d,e,f));return a.isGeneratorFunction(d)?g:g.next().then(function(a){return a.done?a.value:g.next()})},g(E),E[v]="Generator",E[t]=function(){return this},E.toString=function(){return"[object Generator]"},a.keys=function(a){var b=[];for(var c in a)b.push(c);return b.reverse(),function c(){for(;b.length;){var d=b.pop();if(d in a)return c.value=d,c.done=!1,c}return c.done=!0,c}},a.values=n,m.prototype={constructor:m,reset:function(a){if(this.prev=0,this.next=0,this.sent=this._sent=p,this.done=!1,this.delegate=null,this.method="next",this.arg=p,this.tryEntries.forEach(l),!a)for(var b in this)"t"===b.charAt(0)&&r.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=p)},stop:function(){this.done=!0;var a=this.tryEntries[0],b=a.completion;if("throw"===b.type)throw b.arg;return this.rval},dispatchException:function(a){function b(b,d){return f.type="throw",f.arg=a,c.next=b,d&&(c.method="next",c.arg=p),!!d}if(this.done)throw a;for(var c=this,d=this.tryEntries.length-1;d>=0;--d){var e=this.tryEntries[d],f=e.completion;if("root"===e.tryLoc)return b("end");if(e.tryLoc<=this.prev){var g=r.call(e,"catchLoc"),h=r.call(e,"finallyLoc");if(g&&h){if(this.prev<e.catchLoc)return b(e.catchLoc,!0);if(this.prev<e.finallyLoc)return b(e.finallyLoc)}else if(g){if(this.prev<e.catchLoc)return b(e.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<e.finallyLoc)return b(e.finallyLoc)}}}},abrupt:function(a,b){for(var c=this.tryEntries.length-1;c>=0;--c){var d=this.tryEntries[c];if(d.tryLoc<=this.prev&&r.call(d,"finallyLoc")&&this.prev<d.finallyLoc){var e=d;break}}e&&("break"===a||"continue"===a)&&e.tryLoc<=b&&b<=e.finallyLoc&&(e=null);var f=e?e.completion:{};return f.type=a,f.arg=b,e?(this.method="next",this.next=e.finallyLoc,A):this.complete(f)},complete:function(a,b){if("throw"===a.type)throw a.arg;return"break"===a.type||"continue"===a.type?this.next=a.arg:"return"===a.type?(this.rval=this.arg=a.arg,this.method="return",this.next="end"):"normal"===a.type&&b&&(this.next=b),A},finish:function(a){for(var b=this.tryEntries.length-1;b>=0;--b){var c=this.tryEntries[b];if(c.finallyLoc===a)return this.complete(c.completion,c.afterLoc),l(c),A}},catch:function(a){for(var b=this.tryEntries.length-1;b>=0;--b){var c=this.tryEntries[b];if(c.tryLoc===a){var d=c.completion;if("throw"===d.type){var e=d.arg;l(c)}return e}}throw new Error("illegal catch attempt")},delegateYield:function(a,b,c){return this.delegate={iterator:n(a),resultName:b,nextLoc:c},"next"===this.method&&(this.arg=p),A}},a}("object"==typeof c?c.exports:{}));try{regeneratorRuntime=d}catch(a){Function("r","regeneratorRuntime = r")(d)}}),System.register("theatlantic/js/utils/polyfills.js",[],function(a,b){"use strict";function c(){!function(a){function b(a){a=a||"",(a instanceof URLSearchParams||a instanceof b)&&(a=a.toString()),this[m]=f(a)}function c(a){var b={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(a).replace(/[!'\(\)~]|%20|%00/g,function(a){return b[a]})}function d(a){return a.replace(/[ +]/g,"%20").replace(/(%[a-f0-9]{2})+/gi,function(a){return decodeURIComponent(a)})}function e(b){var c={next:function(){var a=b.shift();return{done:void 0===a,value:a}}};return p&&(c[a.Symbol.iterator]=function(){return c}),c}function f(a){var b={};if("object"==typeof a)if(h(a))for(var c=0;c<a.length;c++){var e=a[c];if(!h(e)||2!==e.length)throw new TypeError("Failed to construct 'URLSearchParams': Sequence initializer must only contain pair elements");g(b,e[0],e[1])}else for(var f in a)a.hasOwnProperty(f)&&g(b,f,a[f]);else{0===a.indexOf("?")&&(a=a.slice(1));for(var i=a.split("&"),j=0;j<i.length;j++){var k=i[j],l=k.indexOf("=");-1<l?g(b,d(k.slice(0,l)),d(k.slice(l+1))):k&&g(b,d(k),"")}}return b}function g(a,b,c){var d="string"==typeof c?c:null!==c&&void 0!==c&&"function"==typeof c.toString?c.toString():JSON.stringify(c);i(a,b)?a[b].push(d):a[b]=[d]}function h(a){return!!a&&"[object Array]"===Object.prototype.toString.call(a)}function i(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var j=a.URLSearchParams&&a.URLSearchParams.prototype.get?a.URLSearchParams:null,k=j&&"a=1"===new j({a:1}).toString(),l=j&&"+"===new j("s=%2B").get("s"),m="__URLSearchParams__",n=!j||function(){var a=new j;return a.append("s"," &"),"s=+%26"===a.toString()}(),o=b.prototype,p=!(!a.Symbol||!a.Symbol.iterator);if(!(j&&k&&l&&n)){o.append=function(a,b){g(this[m],a,b)},o.delete=function(a){delete this[m][a]},o.get=function(a){var b=this[m];return this.has(a)?b[a][0]:null},o.getAll=function(a){var b=this[m];return this.has(a)?b[a].slice(0):[]},o.has=function(a){return i(this[m],a)},o.set=function(a,b){this[m][a]=[""+b]},o.toString=function(){var a,b,d,e,f=this[m],g=[];for(b in f)for(d=c(b),a=0,e=f[b];a<e.length;a++)g.push(d+"="+c(e[a]));return g.join("&")};var q=!l,r=!q&&j&&!k&&a.Proxy;Object.defineProperty(a,"URLSearchParams",{value:r?new Proxy(j,{construct:function(a,c){return new a(new b(c[0]).toString())}}):b});var s=a.URLSearchParams.prototype;s.polyfill=!0,s.forEach=s.forEach||function(a,b){var c=f(this.toString());Object.getOwnPropertyNames(c).forEach(function(d){c[d].forEach(function(c){a.call(b,c,d,this)},this)},this)},s.sort=s.sort||function(){var a,b,c,d=f(this.toString()),e=[];for(a in d)e.push(a);for(e.sort(),b=0;b<e.length;b++)this.delete(e[b]);for(b=0;b<e.length;b++){var g=e[b],h=d[g];for(c=0;c<h.length;c++)this.append(g,h[c])}},s.keys=s.keys||function(){var a=[];return this.forEach(function(b,c){a.push(c)}),e(a)},s.values=s.values||function(){var a=[];return this.forEach(function(b){a.push(b)}),e(a)},s.entries=s.entries||function(){var a=[];return this.forEach(function(b,c){a.push([c,b])}),e(a)},p&&(s[a.Symbol.iterator]=s[a.Symbol.iterator]||s.entries)}}("undefined"!=typeof global?global:"undefined"!=typeof window?window:this)}function d(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(a){var b=this;if(!document.documentElement.contains(b))return null;do{if(b.matches(a))return b;b=b.parentElement}while(null!==b);return null})}function e(){function a(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{bubbles:!1,cancelable:!1,detail:void 0},c=document.createEvent("CustomEvent");return c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail),c}if("function"==typeof window.CustomEvent)return!1;a.prototype=window.Event.prototype,window.CustomEvent=a}function f(){[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(a){a.hasOwnProperty("append")||Object.defineProperty(a,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){var a=Array.prototype.slice.call(arguments),b=document.createDocumentFragment();a.forEach(function(a){var c=a instanceof Node;b.appendChild(c?a:document.createTextNode(String(a)))}),this.appendChild(b)}})})}function g(a){a.forEach(function(a){a.hasOwnProperty("remove")||Object.defineProperty(a,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){null!==this.parentNode&&this.parentNode.removeChild(this)}})})}function h(){window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(a,b){b=b||window;for(var c=0;c<this.length;c++)a.call(b,this[c],c,this)})}function i(){"document"in self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))||function(a){if("Element"in a){var b="classList",c="prototype",d=a.Element[c],e=Object,f=String[c].trim||function(){return this.replace(/^\s+|\s+$/g,"")},g=Array[c].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1},h=function(a,b){this.name=a,this.code=DOMException[a],this.message=b},i=function(a,b){if(""===b)throw new h("SYNTAX_ERR","The token must not be empty.");if(/\s/.test(b))throw new h("INVALID_CHARACTER_ERR","The token must not contain space characters.");return g.call(a,b)},j=function(a){for(var b=f.call(a.getAttribute("class")||""),c=b?b.split(/\s+/):[],d=0,e=c.length;d<e;d++)this.push(c[d]);this._updateClassName=function(){a.setAttribute("class",this.toString())}},k=j[c]=[],l=function(){return new j(this)};if(h[c]=Error[c],k.item=function(a){return this[a]||null},k.contains=function(a){return~i(this,a+"")},k.add=function(){var a,b=arguments,c=0,d=b.length,e=!1;do{a=b[c]+"",~i(this,a)||(this.push(a),e=!0)}while(++c<d);e&&this._updateClassName()},k.remove=function(){var a,b,c=arguments,d=0,e=c.length,f=!1;do{for(a=c[d]+"",b=i(this,a);~b;)this.splice(b,1),f=!0,b=i(this,a)}while(++d<e);f&&this._updateClassName()},k.toggle=function(a,b){var c=this.contains(a),d=c?!0!==b&&"remove":!1!==b&&"add";return d&&this[d](a),!0===b||!1===b?b:!c},k.replace=function(a,b){var c=i(a+"");~c&&(this.splice(c,1,b),this._updateClassName())},k.toString=function(){return this.join(" ")},e.defineProperty){var m={get:l,enumerable:!0,configurable:!0};try{e.defineProperty(d,b,m)}catch(a){void 0!==a.number&&-2146823252!==a.number||(m.enumerable=!1,e.defineProperty(d,b,m))}}else e[c].__defineGetter__&&d.__defineGetter__(b,l)}}(self),function(){var a=document.createElement("_");if(a.classList.add("c1","c2"),!a.classList.contains("c2")){var b=function(a){var b=DOMTokenList.prototype[a];DOMTokenList.prototype[a]=function(a){var c,d=arguments.length;for(c=0;c<d;c++)a=arguments[c],b.call(this,a)}};b("add"),b("remove")}if(a.classList.toggle("c3",!1),a.classList.contains("c3")){var c=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(a,b){return 1 in arguments&&!this.contains(a)==!b?b:c.call(this,a)}}"replace"in document.createElement("_").classList||(DOMTokenList.prototype.replace=function(a,b){var c=this.toString().split(" "),d=c.indexOf(a+"");~d&&(c=c.slice(d),this.remove.apply(this,c),this.add(b),this.add.apply(this,c.slice(1)))}),a=null}())}return a("URLSearchParamsPolyfill",c),a("closestPolyfill",d),a("customEventPolyfill",e),a("appendPolyfill",f),a("removePolyfill",g),a("forEachPolyfill",h),a("classListPolyfill",i),{setters:[],execute:function(){!function(){c(),d(),e(),f(),g([Element.prototype,CharacterData.prototype,DocumentType.prototype]),h(),i()}()}}}),System.register("theatlantic/js/utils/endpoints.js",["npm:systemjs-plugin-babel@0.0.25/babel-helpers/classCallCheck.js","npm:systemjs-plugin-babel@0.0.25/babel-helpers/createClass.js","./log","../constants/endpoints"],function(a,b){"use strict";var c,d,e,f,g,h,i,j,k;return{setters:[function(a){c=a.default},function(a){d=a.default},function(a){e=a.Log},function(a){f=a.relatedArticles,g=a.mostPopular,h=a.video}],execute:function(){i=e("atl:endpoints"),j=function(){function a(){c(this,a),this.relatedArticles=f,this.mostPopular=g,this.video=h}return d(a,[{key:"get",value:function(a){return this[a]}},{key:"set",value:function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";""===b&&i.warn("No `value` set for endpoint"),this[a]=b}}]),a}(),a("endpoints",k=new j),a("endpoints",k)}}}),System.registerDynamic("npm:uuid@3.0.1/v1.js",["./lib/rng","./lib/bytesToUuid"],!0,function(a,b,c){function d(a,b,c){var d=b&&c||0,e=b||[];a=a||{};var g=void 0!==a.clockseq?a.clockseq:i,l=void 0!==a.msecs?a.msecs:(new Date).getTime(),m=void 0!==a.nsecs?a.nsecs:k+1,n=l-j+(m-k)/1e4;if(n<0&&void 0===a.clockseq&&(g=g+1&16383),(n<0||l>j)&&void 0===a.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");j=l,k=m,i=g,l+=122192928e5;var o=(1e4*(268435455&l)+m)%4294967296;e[d++]=o>>>24&255,e[d++]=o>>>16&255,e[d++]=o>>>8&255,e[d++]=255&o;var p=l/4294967296*1e4&268435455;e[d++]=p>>>8&255,e[d++]=255&p,e[d++]=p>>>24&15|16,e[d++]=p>>>16&255,e[d++]=g>>>8|128,e[d++]=255&g;for(var q=a.node||h,r=0;r<6;++r)e[d+r]=q[r];return b||f(e)}var e=(this||self,a("./lib/rng")),f=a("./lib/bytesToUuid"),g=e(),h=[1|g[0],g[1],g[2],g[3],g[4],g[5]],i=16383&(g[6]<<8|g[7]),j=0,k=0;c.exports=d}),System.registerDynamic("npm:uuid@3.0.1/lib/rng-browser.js",[],!0,function(a,b,c){var d,e=this||self,f=e.crypto||e.msCrypto;if(f&&f.getRandomValues){var g=new Uint8Array(16);d=function(){return f.getRandomValues(g),g}}if(!d){var h=new Array(16);d=function(){for(var a,b=0;b<16;b++)0==(3&b)&&(a=4294967296*Math.random()),h[b]=a>>>((3&b)<<3)&255;return h}}c.exports=d}),System.registerDynamic("npm:uuid@3.0.1/lib/bytesToUuid.js",[],!0,function(a,b,c){function d(a,b){var c=b||0,d=e;return d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+"-"+d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]+d[a[c++]]}for(var e=(this||self,[]),f=0;f<256;++f)e[f]=(f+256).toString(16).substr(1);c.exports=d}),System.registerDynamic("npm:uuid@3.0.1/v4.js",["./lib/rng","./lib/bytesToUuid"],!0,function(a,b,c){function d(a,b,c){var d=b&&c||0;"string"==typeof a&&(b="binary"==a?new Array(16):null,a=null),a=a||{};var g=a.random||(a.rng||e)();if(g[6]=15&g[6]|64,g[8]=63&g[8]|128,b)for(var h=0;h<16;++h)b[d+h]=g[h];return b||f(g)}var e=(this||self,a("./lib/rng")),f=a("./lib/bytesToUuid");c.exports=d}),System.registerDynamic("npm:uuid@3.0.1.json",[],!0,function(){return{main:"index.js",format:"cjs",meta:{"*.json":{format:"json"}},map:{"./lib/rng.js":{browser:"./lib/rng-browser.js"}}}}),System.registerDynamic("npm:uuid@3.0.1/index.js",["./v1","./v4"],!0,function(a,b,c){var d=(this||self,a("./v1")),e=a("./v4"),f=e;f.v1=d,f.v4=e,c.exports=f}),System.register("theatlantic/js/utils/namespace.js",["uuid","./log","./user"],function(a,b){"use strict";var c,d,e,f,g,h;return{setters:[function(a){c=a.default},function(a){d=a.Log},function(a){e=a.User}],execute:function(){f="atl:namespace",g=d(f),h=Object.defineProperties({},{page_view_id:{value:c.v4(),writable:!1},User:{value:new e,writable:!1}}),window.Atlantic=Object.assign(h,window.Atlantic),g(window.Atlantic)}}}),System.registerDynamic("github:theatlantic/lazysizes@4.0.5/lazysizes.js",[],!0,function(a,b,c){this||self;!function(a,b){var d=b(a,a.document);a.lazySizes=d,"object"==typeof c&&c.exports&&(c.exports=d)}(window,function(a,b){"use strict";if(b.getElementsByClassName){var c,d,e=b.documentElement,f=a.Date,g=a.HTMLPictureElement,h="addEventListener",i="getAttribute",j=a[h],k=a.setTimeout,l=a.requestAnimationFrame||k,m=a.requestIdleCallback,n=/^picture$/i,o=["load","error","lazyincluded","_lazyloaded"],p={},q=Array.prototype.forEach,r=function(a,b){return p[b]||(p[b]=new RegExp("(\\s|^)"+b+"(\\s|$)")),p[b].test(a[i]("class")||"")&&p[b]},s=function(a,b){r(a,b)||a.setAttribute("class",(a[i]("class")||"").trim()+" "+b)},t=function(a,b){var c;(c=r(a,b))&&a.setAttribute("class",(a[i]("class")||"").replace(c," "))},u=function(a,b,c){var d=c?h:"removeEventListener";c&&u(a,b),o.forEach(function(c){a[d](c,b)})},v=function(a,d,e,f,g){var h=b.createEvent("CustomEvent");return e||(e={}),e.instance=c,h.initCustomEvent(d,!f,!g,e),a.dispatchEvent(h),h},w=function(b,c){var e;!g&&(e=a.picturefill||d.pf)?e({reevaluate:!0,elements:[b]}):c&&c.src&&(b.src=c.src)},x=function(a,b){return(getComputedStyle(a,null)||{})[b]},y=function(a,b,c){for(c=c||a.offsetWidth;c<d.minSize&&b&&!a._lazysizesWidth;)c=b.offsetWidth,b=b.parentNode;return c},z=function(){var a,c,d=[],e=[],f=d,g=function(){var b=f;for(f=d.length?e:d,a=!0,c=!1;b.length;)b.shift()();a=!1},h=function(d,e){a&&!e?d.apply(this,arguments):(f.push(d),c||(c=!0,(b.hidden?k:l)(g)))};return h._lsFlush=g,h}(),A=function(a,b){return b?function(){z(a)}:function(){var b=this,c=arguments;z(function(){a.apply(b,c)})}},B=function(a){var b,c=0,e=d.throttleDelay,g=d.ricTimeout,h=function(){b=!1,c=f.now(),a()},i=m&&g>49?function(){m(h,{timeout:g}),g!==d.ricTimeout&&(g=d.ricTimeout)}:A(function(){k(h)},!0);return function(a){var d;(a=!0===a)&&(g=33),b||(b=!0,d=e-(f.now()-c),d<0&&(d=0),a||d<9?i():k(i,d))}},C=function(a){var b,c,d=99,e=function(){b=null,a()},g=function(){var a=f.now()-c;a<d?k(g,d-a):(m||e)(e)};return function(){c=f.now(),b||(b=k(g,d))}};!function(){var b,c={lazyClass:"lazyload",loadedClass:"lazyloaded",loadingClass:"lazyloading",preloadClass:"lazypreload",errorClass:"lazyerror",autosizesClass:"lazyautosizes",srcAttr:"data-src",srcsetAttr:"data-srcset",sizesAttr:"data-sizes",minSize:40,customMedia:{},init:!0,expFactor:1.5,hFac:.8,loadMode:2,loadHidden:!0,ricTimeout:0,throttleDelay:125};d=a.lazySizesConfig||a.lazysizesConfig||{};for(b in c)b in d||(d[b]=c[b]);a.lazySizesConfig=d,k(function(){d.init&&F()})}();var D=function(){var g,l,m,o,p,y,D,F,G,H,I,J,K,L,M=/^img$/i,N=/^iframe$/i,O="onscroll"in a&&!/glebot/.test(navigator.userAgent),P=0,Q=0,R=0,S=-1,T=function(a){R--,a&&a.target&&u(a.target,T),(!a||R<0||!a.target)&&(R=0)},U=function(a,c){var d,f=a,g="hidden"==x(b.body,"visibility")||"hidden"!=x(a,"visibility");for(F-=c,I+=c,G-=c,H+=c;g&&(f=f.offsetParent)&&f!=b.body&&f!=e;)(g=(x(f,"opacity")||1)>0)&&"visible"!=x(f,"overflow")&&(d=f.getBoundingClientRect(),g=H>d.left&&G<d.right&&I>d.top-1&&F<d.bottom+1);return g},V=function(){var a,f,h,j,k,m,n,p,q,r=c.elements;if((o=d.loadMode)&&R<8&&(a=r.length)){f=0,S++,null==K&&("expand"in d||(d.expand=e.clientHeight>500&&e.clientWidth>500?500:370),J=d.expand,K=J*d.expFactor),Q<K&&R<1&&S>2&&o>2&&!b.hidden?(Q=K,S=0):Q=o>1&&S>1&&R<6?J:P;for(;f<a;f++)if(r[f]&&!r[f]._lazyRace)if(O)if((p=r[f][i]("data-expand"))&&(m=1*p)||(m=Q),q!==m&&(y=innerWidth+m*L,D=innerHeight+m,n=-1*m,q=m),h=r[f].getBoundingClientRect(),(I=h.bottom)>=n&&(F=h.top)<=D&&(H=h.right)>=n*L&&(G=h.left)<=y&&(I||H||G||F)&&(d.loadHidden||"hidden"!=x(r[f],"visibility"))&&(l&&R<3&&!p&&(o<3||S<4)||U(r[f],m))){if(ba(r[f]),k=!0,R>9)break}else!k&&l&&!j&&R<4&&S<4&&o>2&&(g[0]||d.preloadAfterLoad)&&(g[0]||!p&&(I||H||G||F||"auto"!=r[f][i](d.sizesAttr)))&&(j=g[0]||r[f]);else ba(r[f]);j&&!k&&ba(j)}},W=B(V),X=function(a){s(a.target,d.loadedClass),t(a.target,d.loadingClass),u(a.target,Z),v(a.target,"lazyloaded")},Y=A(X),Z=function(a){Y({target:a.target})},$=function(a,b){try{a.contentWindow.location.replace(b)}catch(c){a.src=b}},_=function(a){var b,c=a[i](d.srcsetAttr);(b=d.customMedia[a[i]("data-media")||a[i]("media")])&&a.setAttribute("media",b),c&&a.setAttribute("srcset",c)},aa=A(function(a,b,c,e,f){var g,h,j,l,o,p;(o=v(a,"lazybeforeunveil",b)).defaultPrevented||(e&&(c?s(a,d.autosizesClass):a.setAttribute("sizes",e)),h=a[i](d.srcsetAttr),g=a[i](d.srcAttr),f&&(j=a.parentNode,l=j&&n.test(j.nodeName||"")),p=b.firesLoad||"src"in a&&(h||g||l),o={target:a},p&&(u(a,T,!0),clearTimeout(m),m=k(T,2500),s(a,d.loadingClass),u(a,Z,!0)),l&&q.call(j.getElementsByTagName("source"),_),h?a.setAttribute("srcset",h):g&&!l&&(N.test(a.nodeName)?$(a,g):a.src=g),f&&(h||l)&&w(a,{src:g})),a._lazyRace&&delete a._lazyRace,t(a,d.lazyClass),z(function(){(!p||a.complete&&a.naturalWidth>1)&&(p?T(o):R--,X(o))},!0)}),ba=function(a){var b,c=M.test(a.nodeName),e=c&&(a[i](d.sizesAttr)||a[i]("sizes")),f="auto"==e;(!f&&l||!c||!a[i]("src")&&!a.srcset||a.complete||r(a,d.errorClass)||!r(a,d.lazyClass))&&(b=v(a,"lazyunveilread").detail,f&&E.updateElem(a,!0,a.offsetWidth),a._lazyRace=!0,R++,aa(a,b,f,e,c))},ca=function(){if(!l){if(f.now()-p<999)return void k(ca,999);var a=C(function(){d.loadMode=3,W()});l=!0,d.loadMode=3,W(),j("scroll",function(){3==d.loadMode&&(d.loadMode=2),a()},!0)}};return{_:function(){p=f.now(),c.elements=b.getElementsByClassName(d.lazyClass),g=b.getElementsByClassName(d.lazyClass+" "+d.preloadClass),L=d.hFac,j("scroll",W,!0),j("resize",W,!0),a.MutationObserver?new MutationObserver(W).observe(e,{childList:!0,subtree:!0,attributes:!0}):(e[h]("DOMNodeInserted",W,!0),e[h]("DOMAttrModified",W,!0),setInterval(W,999)),j("hashchange",W,!0),["focus","mouseover","click","load","transitionend","animationend","webkitAnimationEnd"].forEach(function(a){b[h](a,W,!0)}),/d$|^c/.test(b.readyState)?ca():(j("load",ca),b[h]("DOMContentLoaded",W),k(ca,2e4)),c.elements.length?(V(),z._lsFlush()):W()},checkElems:W,unveil:ba}}(),E=function(){var a,c=A(function(a,b,c,d){var e,f,g;if(a._lazysizesWidth=d,d+="px",a.setAttribute("sizes",d),n.test(b.nodeName||""))for(e=b.getElementsByTagName("source"),f=0,g=e.length;f<g;f++)e[f].setAttribute("sizes",d);c.detail.dataAttr||w(a,c.detail)}),e=function(a,b,d){var e,f=a.parentNode;f&&(d=y(a,f,d),e=v(a,"lazybeforesizes",{width:d,dataAttr:!!b}),e.defaultPrevented||(d=e.detail.width)&&d!==a._lazysizesWidth&&c(a,f,e,d))},f=function(){var b,c=a.length;if(c)for(b=0;b<c;b++)e(a[b])},g=C(f);return{_:function(){a=b.getElementsByClassName(d.autosizesClass),j("resize",g)},checkElems:g,updateElem:e}}(),F=function(){F.i||(F.i=!0,E._(),D._())};return c={cfg:d,autoSizer:E,loader:D,init:F,uP:w,aC:s,rC:t,hC:r,fire:v,gW:y,rAF:z}}})}),System.registerDynamic("github:theatlantic/lazysizes@4.0.5.json",[],!0,function(){return{main:"lazysizes.js"}}),System.registerDynamic("github:theatlantic/lazysizes@4.0.5/plugins/include/ls.include.js",["lazysizes"],!0,function(a,b,c){this||self;!function(b,d){var e=function(){d(b.lazySizes),b.removeEventListener("lazyunveilread",e,!0)};d=d.bind(null,b,b.document),"object"==typeof c&&c.exports?d(a("lazysizes")):b.lazySizes?e():b.addEventListener("lazyunveilread",e,!0)}(window,function(a,b,c){"use strict";function d(a){var b;(b=a.match(B))?this.urls[b[1]]=v.map[b[2]]||b[2]:this.urls.include=v.map[a]||a}function e(a){var b,c,e;return a=a.trim(),a=v.map[a]||a,c=a.match(C),c?(e=c[1],b={condition:u.include.conditions[c[3]]||u.customMedia[c[3]]||c[2]||null,name:c[3]}):(e=a,b={condition:null,name:""}),b.urls={},(v.map[e]||e).split(A).forEach(d,b),!b.urls.include&&b.urls.amd&&(this.saved=!0,b.initial=this),b}function f(a){var b,d,f=a.getAttribute("data-include")||"",g=a.lazyInclude;return g&&g.str==f&&!v.allowReload||(d={saved:!1,content:null},g={str:f,candidates:(v.map[f]||f).split(y).map(e,d)},!(b=g.candidates.length)||g.candidates[b-1].condition?(d.saved=!0,g.candidates.push({urls:{},condition:null,name:"initial",content:d})):d.saved&&1==g.candidates.length&&(d.saved=!1),g.initialContent=d,d.saved&&(d.content=a.innerHTML),a.lazyInclude=g,g.candidates.length>1?c.aC(a,"lazyconditionalinclude"):c.rC(a,"lazyconditionalinclude")),g}function g(b,c){var d=!c.condition;return c.condition&&(h(),x[c.name]?d=!0:a.matchMedia&&"string"==typeof c.condition?d=(matchMedia(c.condition)||{}).matches:"function"==typeof c.condition&&(d=c.condition(b,c))),d}function h(){var a;x||(w||(w=b.querySelector(v.contentElement)),w?(a=(G(w,":after").getPropertyValue("content")||"none").replace(D,""),x={},a&&(x[a]=1),(a=(G(w,":before").getPropertyValue("content")||"none").replace(D,""))&&(x[a]=1)):x={})}function i(a){var b,c,d=a.lazyInclude;if(d&&d.candidates)for(b=0;b<d.candidates.length&&(c=d.candidates[b],!g(a,c));b++);return c&&c!=d.current||(c=null),c}function j(a,b){var c=new XMLHttpRequest;c.addEventListener("readystatechange",function(){var a=this.DONE||4;this.readyState===a&&(b(c),c=null)},!1),c.open.apply(c,a.openArgs),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.xhrModifier&&a.xhrModifier(c,a.candidate),c.send(a.sendData)}function k(a,b){a=a.split("|,|");var d=a.length-1;c.cfg.requireJs?c.cfg.requireJs(a,b):a.forEach(function(a,c){m(a,c==d?b:null)})}function l(a,b){c.cfg.systemJs?c.cfg.systemJs(a,b):m(a,b)}function m(a,c,d){if(!z[a]){var e=b.createElement(!0===c?"script":"link"),f=b.getElementsByTagName("script")[0];c?(e.src=a,e.async=!1):(e.rel="stylesheet",e.href=a),f.parentNode.insertBefore(e,f),z[a]=!0,z[e.href]=!0}}function n(a){a=a.split("|,|"),a.forEach(m)}function o(a){a&&"function"==typeof a.lazytransform&&a.lazytransform(this)}function p(a){a&&"function"==typeof a.lazyunload&&a.lazyunload(this)}function q(a){a&&"function"==typeof a.lazyload&&a.lazyload(this)}function r(a,b){var d,e,f,g=a.lazyInclude.current||null,h={candidate:b,openArgs:["GET",b.urls.include,!0],sendData:null,xhrModifier:null,content:b.content&&b.content.content||b.content,oldCandidate:g};if(c.fire(a,"lazyincludeload",h).defaultPrevented)return void H.d();if(d=function(){var d,h=e.status,i=e.content||e.responseText,j=!(null!=i||!g||!g.urls.include),k=!0;"false"===a.dataset.insert&&(k=!1);var l={candidate:b,content:i,text:e.responseText||e.content,response:e.response,xml:e.responseXML,isSuccess:!("status"in e)||(h>=200&&h<300||304===h),oldCandidate:g,insert:k,resetHTML:j},m={target:a,details:l,detail:l};b.modules=f,g&&g.modules&&(g.modules.forEach(p,m),g.modules=null,l.resetHTML&&null==l.content&&b.initial&&b.initial.saved&&(l.content=b.initial.content)),f.forEach(o,m),d=c.fire(a,"lazyincludeloaded",l),l.insert&&l.isSuccess&&!d.defaultPrevented&&null!=l.content&&l.content!=a.innerHTML&&(a.innerHTML=l.content),H.d(),f.forEach(q,m),setTimeout(function(){c.fire(a,"lazyincluded",l)}),e=null,f=null},a.lazyInclude.current=b,a.setAttribute("data-currentinclude",b.name),b.urls.css&&n(b.urls.css),null==h.content&&b.urls.include?j(h,function(a){e=a,f&&d()}):e=h,b.urls.amd||b.urls.module){var i=function(){f=Array.prototype.slice.call(arguments),e&&d()};b.urls.amd?k(b.urls.amd,i):l(b.urls.module,i)}else f=[];e&&f&&d()}function s(a){var b;if(f(a).candidates.length&&E.contains(a))return b=i(a),b&&r(a,b),!0}function t(a){a.detail.instance==c&&!a.defaultPrevented&&a.target.getAttribute("data-include")&&(H.q(a.target),a.detail.firesLoad=!0)}if(b.getElementsByClassName){var u,v,w,x,y=/\s*,+\s+/,z={},A=/\s+/,B=/^(amd|css|module)\:(.+)/i,C=/(.+)\s+(\(\s*(.+)\s*\))/,D=/['"]/g,E=b.documentElement,F=b.getElementsByClassName("lazyconditionalinclude"),G=function(b,c){var d=b.ownerDocument.defaultView;return d.opener||(d=a),d.getComputedStyle(b,c||null)||{getPropertyValue:function(){},isNull:!0}},H=function(){var a=2,b=a,c=0,d=0,e=[],f=function(){var a,b=function(){e.length&&(c=0,e.d())};return function(){clearTimeout(a),a=setTimeout(b,999)}}();return{q:function(a){var g=null==a.getAttribute("data-lazyqueue");g&&(d++,b=3),c>b?e[g?"unshift":"push"](a):s(a)&&(c++,f())},d:function(){if(c&&c--,d>0&&(--d||(b=a)),!(c>b)){for(;e.length;)if(s(e.shift())){c++;break}f()}}}}(),I=function(){var a,b=function(){for(var a=0,b=F.length;a<b;a++)!c.hC(F[a],u.lazyClass)&&i(F[a])&&c.aC(F[a],u.lazyClass)};return function(c){clearTimeout(a),x=null,a=setTimeout(b,"resize"==c.type?31:0)}}();u=c&&c.cfg||a.lazySizesConfig,u||(u={},a.lazySizesConfig=u),u.include||(u.include={}),v=u.include,v.contentElement||(v.contentElement="html"),v.conditions||(v.conditions={}),v.map||(v.map={}),addEventListener("lazybeforeunveil",t,!1),addEventListener("resize",I,!1),addEventListener("lazyrefreshincludes",I,!1)}})}),System.register("theatlantic/js/utils/lazysizes.js",["npm:systemjs-plugin-babel@0.0.25/babel-helpers/toConsumableArray.js","lazysizes","lazysizes/plugins/include/ls.include","pageInfo"],function(a,b){"use strict";function c(){i.forEach(function(a){a.addEventListener("lazyincludeload",d)})}function d(a){a.detail&&(a.detail.xhrModifier=e)}function e(a){a.setRequestHeader("Accept","application/json"),a.setRequestHeader("Authorization","token "+h)}var f,g,h,i;return{setters:[function(a){f=a.default},function(a){g=a.default},function(a){},function(a){h=a.token}],execute:function(){i=[].concat(f(document.querySelectorAll(".js-dynamic-content"))),Object.assign(g.cfg,{systemJs:function(a,b){System.import(a).then(b)}}),c(),g.init()}}}),System.register("theatlantic/js/components/bottom-persistent-ad.js",["../constants/url","../utils/log","../utils/helpers","../utils/device"],function(a,b){"use strict";function c(){function a(){i("close bottom persistent?"),requestAnimationFrame(function(){d.classList.add(j)})}function b(){i("getting to show bottom persistent?"),requestAnimationFrame(function(){d.classList.remove(j)})}function c(){i("removing deferred attribute from bottomPersistent"),e.removeAttribute("defer")}i("initBottomPersistent");var d=document.querySelector(".js-bottom-persistent-ad");if(d){var e=d.querySelector(".js-bottom-persistent"),h=d.querySelector(".js-bottom-persistent-ad__button");f(window,"scroll",c),"desktop"===g()&&c(),e.addEventListener("ad-loaded",b),e.addEventListener("viewable-impression",function(){setTimeout(function(){i("are we getting here?!"),f(window,"scroll",a)},1e4)}),h&&h.addEventListener("click",a)}}var d,e,f,g,h,i,j;return{setters:[function(a){d=a.disable},function(a){e=a.Log},function(a){f=a.once},function(a){g=a.getDeviceType}],execute:function(){h="atl:bottom-persistent-ad",i=e(h),j="c-bottom-persistent-ad--hidden",-1===d.indexOf("bottom-persistent-ad")&&c()}}}),System.register("theatlantic/scss/components/ad.scss",[],function(){return{setters:[],execute:function(){}}}),System.register("theatlantic/scss/components/bottom-persistent-ad.scss",[],function(){return{setters:[],execute:function(){}}}),System.register("theatlantic/js/utils/ads/scroll.js",["../log","../user","../../constants/url","../loaders"],function(a,b){"use strict";var c,d,e,f,g,h;return{setters:[function(a){c=a.Log},function(a){d=a.isScrollSubscriber},function(a){e=a.disable},function(a){f=a.script}],execute:function(){-1===e.indexOf("ads")&&(g="atl:scroll",h=c(g),performance.mark(g+"_loaded"),function(a,b,c,d){if(!a[b]){var e=a[b]={};e[c]=[],e[d]=function(a){e[c].push(a)}}}(window,"Scroll","_q","do"),window.Scroll.config={orientation:"bottom",detected:d()},performance.mark(g+":requested"),f("https://static.scroll.com/js/scroll.js").then(function(){return performance.mark(g+":loaded")}).catch(function(a){return h.error(a)}))}}}),System.register("theatlantic/js/constants/preconnect.js",[],function(a,b){"use strict";var c;return{setters:[],execute:function(){a("ads",c=["https://z.moatads.com","https://www.googletagservices.com","https://c.amazon-adsystem.com"]),a("ads",c)}}}),System.register("theatlantic/js/utils/random.js",[],function(a,b){"use strict";function c(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return a+Math.floor(Math.random()*(b-a+1))}return a("random",c),{setters:[],execute:function(){}}}),System.register("theatlantic/js/utils/loaders.js",[],function(a,b){"use strict";function c(a){return new Promise(function(b,c){var d=document.createElement("script");d.addEventListener("load",function a(c){d.removeEventListener("load",a),b(c)}),d.addEventListener("error",function a(b){d.removeEventListener("error",a),c(b)}),d.src=a,d.async=!0,document.body.appendChild(d)})}function d(a){return new Promise(function(b,c){var d=new Image;d.addEventListener("load",function a(c){d.removeEventListener("load",a),b(c)}),d.addEventListener("error",function a(b){d.removeEventListener("error",a),c(b)}),d.src=a})}function e(a){var b=document.createElement("link");Object.keys(a).map(function(c){return b[c]=a[c]}),document.head.appendChild(b)}return a("script",c),a("image",d),a("link",e),{setters:[],execute:function(){}}}),System.register("theatlantic/js/utils/ads.js",["npm:systemjs-plugin-babel@0.0.25/regenerator-runtime.js","npm:systemjs-plugin-babel@0.0.25/babel-helpers/asyncToGenerator.js","theatlantic/js/components/bottom-persistent-ad","theatlantic/scss/components/ad.scss","theatlantic/scss/components/bottom-persistent-ad.scss","./ads/scroll","adsConfig","../constants/preconnect","../constants/url","./log","./random","./loaders","./user","../paywall/paywall","pageInfo"],function(a,b){"use strict";function c(a){var b=document.querySelector(".blah");if(b){var c=b.querySelector(".l-article__container__container"),d=b.querySelector('.l-rail gpt-sizeset[sizes="rail"]'),e=c.getBoundingClientRect(),f=e.height;a||(f+=150),f<1020&&d.setAttribute("sizes","[[300, 250]]")}}var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;return{setters:[function(a){d=a.default},function(a){e=a.default},function(a){},function(a){},function(a){},function(a){},function(a){f=a},function(a){g=a.ads},function(a){h=a.disable},function(a){i=a.Log},function(a){j=a.random},function(a){k=a.link},function(a){l=a.getEntitlementsList},function(a){m=a.meter},function(a){n=a}],execute:function(){o=function(){var a=e(d.mark(function a(){var b,e,h;return d.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(b=Object.assign({},f),0!==Object.keys(b).length){a.next=3;break}return a.abrupt("return");case 3:return g.map(function(a){return k({href:a,rel:"preconnect dns-prefetch",crossOrigin:"anonymous"})}),c(b.globals.nopromo),a.prev=5,b.globals.user=l(),b.globals.abt=r,a.next=10,System.import("adsjs");case 10:e=a.sent,h=e.Controller,new h(f),a.next=20;break;case 15:return a.prev=15,a.t0=a.catch(5),q.error(a.t0),a.next=20,System.import("theatlantic/js/components/house-creative-fallback");case 20:case"end":return a.stop()}},a,this,[[5,15]])}));return function(){return a.apply(this,arguments)}}(),p="atl:ads",q=i(p),performance.mark(p+"_loaded"),a("ab_test_group",r=j(1,100)),a("ab_test_group",r),s=m.hasHitCap()&&n.show_nudges&&-1===l().indexOf("paymeter_access"),-1!==h.indexOf("ads")||s||o()}}}),System.registerDynamic("npm:jspm-nodelibs-events@0.2.2.json",[],!0,function(){return{main:"./events.js"}}),System.registerDynamic("npm:jspm-nodelibs-events@0.2.2/events.js",[],!0,function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}this||self;c.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||a<0||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if((b=arguments[1])instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:f=Array.prototype.slice.call(arguments,1),c.apply(this,f)}else if(g(c))for(f=Array.prototype.slice.call(arguments,1),j=c.slice(),d=j.length,i=0;i<d;i++)j[i].apply(this,f);return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned&&(c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners)&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace()),this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-- >0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(d<0)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else if(c)for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){return this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.prototype.listenerCount=function(a){if(this._events){var b=this._events[a];if(e(b))return 1;if(b)return b.length}return 0},d.listenerCount=function(a,b){return a.listenerCount(b)}}),System.register("theatlantic/js/paywall/utils/Cookie.js",["npm:systemjs-plugin-babel@0.0.25/babel-helpers/classCallCheck.js","npm:systemjs-plugin-babel@0.0.25/babel-helpers/createClass.js","js-cookie"],function(a,b){"use strict";var c,d,e,f;return{setters:[function(a){c=a.default},function(a){d=a.default},function(a){e=a.default}],execute:function(){f=function(){function a(b){c(this,a);var d=new Date;this.articleViewsCookie=b,this.expirationDate=new Date(d.getFullYear(),d.getMonth()+1,1),this.viewedArticles=e.get(this.articleViewsCookie)||"[]",this.viewedArticlesArray=JSON.parse(this.viewedArticles)}return d(a,[{key:"length",get:function(){return this.viewedArticlesArray.length}}]),a}(),a("default",f)}}}),System.register("theatlantic/js/paywall/utils/Meter.js",["npm:systemjs-plugin-babel@0.0.25/babel-helpers/classCallCheck.js","npm:systemjs-plugin-babel@0.0.25/babel-helpers/createClass.js","events","./Cookie"],function(a,b){"use strict";var c,d,e,f,g;return{setters:[function(a){c=a.default},function(a){d=a.default},function(a){e=a.default},function(a){f=a.default}],execute:function(){g=function(){function a(b){var d=b.cap,g=b.identifier,h=b.cookieName,i=void 0===h?"dev_articleviews":h;c(this,a),this.cap=d,this.cookie=new f(i),this._events=new e,this.identifier=g,this.enabled=!1}return d(a,[{key:"enable",value:function(){this.enabled=!0,this.hasHitCap()&&this._emit("cap-hit"),this._emit("pageview")}},{key:"on",value:function(a,b){this._events.once(a,b)}},{key:"_emit",value:function(a){this._events.emit(a,{identifier:this.identifier,viewCount:this.getPageViews(),cap:this.getCap()})}},{key:"getCap",value:function(){return this.cap}},{key:"getPageViews",value:function(){return this.cookie.length}},{key:"hasHitCap",value:function(){return this.getPageViews()>this.getCap()&&this.enabled}}]),a}(),a("default",g)}}}),System.register("npm:systemjs-plugin-babel@0.0.25/babel-helpers/toArray.js",[],function(a,b){"use strict";return{setters:[],execute:function(){a("default",function(a){return Array.isArray(a)?a:Array.from(a)})}}}),System.register("theatlantic/js/paywall/utils/Intervention.js",["npm:systemjs-plugin-babel@0.0.25/babel-helpers/toArray.js","npm:systemjs-plugin-babel@0.0.25/regenerator-runtime.js","npm:systemjs-plugin-babel@0.0.25/babel-helpers/extends.js","npm:systemjs-plugin-babel@0.0.25/babel-helpers/toConsumableArray.js","npm:systemjs-plugin-babel@0.0.25/babel-helpers/asyncToGenerator.js","npm:systemjs-plugin-babel@0.0.25/babel-helpers/classCallCheck.js","npm:systemjs-plugin-babel@0.0.25/babel-helpers/createClass.js"],function(a,b){"use strict";var c,d,e,f,g,h,i,j,k;return{setters:[function(a){c=a.default},function(a){d=a.default},function(a){e=a.default},function(a){f=a.default},function(a){g=a.default},function(a){h=a.default},function(a){i=a.default}],execute:function(){j=function(a){return"function"==typeof a?a:function(){return a}},k=function(){function a(b){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};h(this,a),this._template=b,this._contextQueue=[],this.render=this.render.bind(this),this.pushContext(c)}return i(a,[{key:"setTemplate",value:function(a){this._template=a}},{key:"pushContext",value:function(a){this._contextQueue.push(a)}},{key:"_reduceContext",value:function(){function a(){return b.apply(this,arguments)}var b=g(d.mark(function a(){var b;return d.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Promise.all([].concat(f(this._contextQueue)));case 2:return b=a.sent,a.abrupt("return",b.reduce(function(a,b){return e({},a,b)},{}));case 4:case"end":return a.stop()}},a,this)}));return a}()},{key:"render",value:function(){function a(a){return b.apply(this,arguments)}var b=g(d.mark(function a(b){var g,h,i,k,l,m;return d.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this._reduceContext();case 2:return g=a.sent,a.next=5,Promise.all([j(this._template)()].concat(f(Object.values(g).map(function(a){return j(a)()}))));case 5:return h=a.sent,i=c(h),k=i[0],l=i.slice(1),m=Object.fromEntries(Object.keys(g).map(function(a,b){return[a,l[b]]})),a.abrupt("return",k(e({},m,b)));case 11:case"end":return a.stop()}},a,this)}));return a}()}]),a}(),a("default",k)}}}),System.register("theatlantic/js/utils/device.js",["../constants/breakpoints.json!"],function(a,b){"use strict";function c(){var a="mobile";return window.matchMedia(e.xlarge).matches?a="desktop":window.matchMedia(e.large).matches?a="desktop":window.matchMedia(e.medium).matches?a="tablet":window.matchMedia(e.small).matches&&(a="tablet"),a}function d(){var a="portrait";return window.matchMedia("(orientation: landscape)").matches&&(a="landscape"),a}var e;return a("getDeviceType",c),a("getDeviceOrientation",d),{setters:[function(a){e=a.default}],execute:function(){}}}),System.register("theatlantic/js/paywall/nudge.js",["npm:systemjs-plugin-babel@0.0.25/regenerator-runtime.js","npm:systemjs-plugin-babel@0.0.25/babel-helpers/asyncToGenerator.js","pageInfo","js-cookie","./utils/renderIntoDom","../utils/device","../utils/events","../globals/dataLayer"],function(a,b){"use strict";function c(){var a=this;return function(){var b=e(d.mark(function b(c){var e,l,m,n,o,p,q,r,s,t,u,v;return d.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:e=function(a){return a&&c.viewCount!==c.cap?c.compressedElem:c.expandedElem},l=function(a){var b="true"===g.get("hasCollapsed"),d=["nudge:user_expand","nudge:user_collapse","nudge:scroll_collapse"],f=-1===d.indexOf(a)?"paywall:interaction":"nudge:interaction",h={action:a,label:e(b),value:c.viewCount};j(window,f,{detail:h})},m=function(a){return a===c.expandedElem?c.compressedElem:c.expandedElem},n=function(a,b){h(a,b).then(function(b){p(a),q(b,m(a)),o()})},o=function(){var a=document.querySelectorAll(".c-nudge__button"),b=!0,c=!1,d=void 0;try{for(var e,f=a[Symbol.iterator]();!(b=(e=f.next()).done);b=!0){e.value.addEventListener("click",function(){l("nudge:click_subscribe")})}}catch(a){c=!0,d=a}finally{try{!b&&f.return&&f.return()}finally{if(c)throw d}}},p=function(a){(a===c.expandedElem?document.querySelector(".js-login-click-expanded"):document.querySelector(".js-login-click-compressed")).addEventListener("click",function(){l("nudge:click_login")})},q=function(a,b){a.querySelector(".c-nudge__icon").addEventListener("click",function(a){a.preventDefault();var d=b===c.expandedElem?"nudge:user_expand":"nudge:user_collapse";l(d),n(b,c),r()})},r=function(){var a="true"===g.get("hasCollapsed");g.set("hasCollapsed",!a)},s=function(){g.set("hasCollapsed",!0)},t=function(){var a="true"===g.get("hasCollapsed");document.querySelector(".c-alert")&&(a=!0);var b=e(a);"feature"===f.layout&&(window.ad_queue=window.ad_queue||[],window.ad_queue.push(function(){document.querySelector("#ad-boxonly").remove()})),n(b,c);var d={nudgeTemplate:b,event:"Nudge Template Set"};k.push(d)},t(),u=function(a){var b=-(a.offsetHeight-64)+"px";a.classList.add("c-nudge-expanded__container--slide-out"),a.style.bottom=b,document.querySelector(".c-nudge__nudge-container").classList.add("c-nudge__nudge-container--fade-out");var c=document.querySelector(".c-nudge__header-mobile");c&&c.classList.add("c-nudge__nudge-container--fade-out"),document.querySelector(".c-nudge__compress-icon").classList.add("c-nudge__compress-icon--rotate")},v=function a(){var b=i(),d="mobile"===b,e=d?100:500,f=document.querySelector(".c-nudge-expanded__container");if(window.pageYOffset>e&&f){u(f);var g=function(){n(c.compressedElem,c)};f.addEventListener("transitionend",g),f.addEventListener("webkitTransitionEnd",g),s(),l("nudge:scroll_collapse"),document.removeEventListener("scroll",a)}},document.addEventListener("scroll",v);case 14:case"end":return a.stop()}},b,a)}));return function(a){return b.apply(this,arguments)}}()}var d,e,f,g,h,i,j,k;return a("default",c),{setters:[function(a){d=a.default},function(a){e=a.default},function(a){f=a},function(a){g=a.default},function(a){h=a.default},function(a){i=a.getDeviceType},function(a){j=a.dataEvent},function(a){k=a.default}],execute:function(){}}}),System.register("npm:systemjs-plugin-babel@0.0.25/babel-helpers/extends.js",[],function(a,b){"use strict";return{setters:[],execute:function(){a("default",Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a})}}}),System.registerDynamic("theatlantic/templates/hippo/components/nudge-expanded.html",[],!0,function(a,b,c){var d=this||self,e=d.nunjucksPrecompiled=d.nunjucksPrecompiled||{},f=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{var i,j=null;i=d.contextOrFrameLookup(b,c,"cap")-d.contextOrFrameLookup(b,c,"viewCount")==0,c.set("final",i,!0),c.topLevel&&b.setVariable("final",i),c.topLevel&&b.addExport("final",i),h+=" ";var k;k=1==d.contextOrFrameLookup(b,c,"viewCount"),c.set("first",k,!0),c.topLevel&&b.setVariable("first",k),c.topLevel&&b.addExport("first",k),h+="\n\x3c!-- template for all nudges but last, which is below --\x3e\n",d.contextOrFrameLookup(b,c,"final")||(h+="\n\x3c!-- left container for meter count and copy --\x3e\n",h+=d.suppressValue((f=4,g=10,d.callWrap(d.contextOrFrameLookup(b,c,"component"),"component",b,["hippo/components/paywall/expanded-mid.html",d.makeKeywordArgs({message:d.contextOrFrameLookup(b,c,"message"),cap:d.contextOrFrameLookup(b,c,"cap"),viewCount:d.contextOrFrameLookup(b,c,"viewCount"),countNotice:d.contextOrFrameLookup(b,c,"countNotice"),countNoticeMobile:d.contextOrFrameLookup(b,c,"countNoticeMobile"),subheader:d.contextOrFrameLookup(b,c,"subheader")})])),a.opts.autoescape),h+="\n"),h+="\n\n\x3c!-- final nudge --\x3e\n",d.contextOrFrameLookup(b,c,"final")&&(h+=" ",h+=d.suppressValue((f=14,g=21,d.callWrap(d.contextOrFrameLookup(b,c,"component"),"component",b,["hippo/components/paywall/expanded-final.html",d.makeKeywordArgs({message:d.contextOrFrameLookup(b,c,"message"),cap:d.contextOrFrameLookup(b,c,"cap"),viewCount:d.contextOrFrameLookup(b,c,"viewCount"),countNotice:d.contextOrFrameLookup(b,c,"countNotice"),countNoticeMobile:d.contextOrFrameLookup(b,c,"countNoticeMobile"),subheaderMobile:d.contextOrFrameLookup(b,c,"subheaderMobile"),subheader:d.contextOrFrameLookup(b,c,"subheader")})])),a.opts.autoescape),h+="\n"),h+="\n",j?j.rootRenderFunc(a,b,c,d,e):e(null,h)}catch(a){e(d.handleError(a,f,g))}}return{root:a}}();e["hippo/components/nudge-expanded.html"]=f,c.exports=f}),System.registerDynamic("theatlantic/templates/hippo/components/nudge-compressed.html",[],!0,function(a,b,c){var d=this||self,e=d.nunjucksPrecompiled=d.nunjucksPrecompiled||{},f=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{var i=null;h+="\x3c!-- left container for meter count and copy --\x3e\n";var j;j=d.contextOrFrameLookup(b,c,"cap")-d.contextOrFrameLookup(b,c,"viewCount")==0,c.set("final",j,!0),c.topLevel&&b.setVariable("final",j),c.topLevel&&b.addExport("final",j),h+="\n";var k;k=1==d.contextOrFrameLookup(b,c,"viewCount"),c.set("first",k,!0),c.topLevel&&b.setVariable("first",k),c.topLevel&&b.addExport("first",k),h+="\n\x3c!-- all nudges render from this template except the final one, which is below --\x3e\n",d.contextOrFrameLookup(b,c,"final")||d.contextOrFrameLookup(b,c,"first")||(h+="\n",h+=d.suppressValue((f=5,g=10,d.callWrap(d.contextOrFrameLookup(b,c,"component"),"component",b,["hippo/components/paywall/compressed-mid.html",d.makeKeywordArgs({message:d.contextOrFrameLookup(b,c,"message"),cap:d.contextOrFrameLookup(b,c,"cap"),viewCount:d.contextOrFrameLookup(b,c,"viewCount"),countNotice:d.contextOrFrameLookup(b,c,"countNotice"),countNoticeMobile:d.contextOrFrameLookup(b,c,"countNoticeMobile"),subheader:d.contextOrFrameLookup(b,c,"subheader"),messageCompressed:d.contextOrFrameLookup(b,c,"messageCompressed")})])),a.opts.autoescape),h+="\n"),h+="\n\n\x3c!-- final nudge displays different elems --\x3e\n",d.contextOrFrameLookup(b,c,"final")&&(h+="\n",h+=d.suppressValue((f=17,g=10,d.callWrap(d.contextOrFrameLookup(b,c,"component"),"component",b,["hippo/components/paywall/compressed-final.html",d.makeKeywordArgs({message:d.contextOrFrameLookup(b,c,"message"),cap:d.contextOrFrameLookup(b,c,"cap"),viewCount:d.contextOrFrameLookup(b,c,"viewCount"),countNotice:d.contextOrFrameLookup(b,c,"countNotice"),countNoticeMobile:d.contextOrFrameLookup(b,c,"countNoticeMobile"),messageCompressed:d.contextOrFrameLookup(b,c,"messageCompressed"),subheader:d.contextOrFrameLookup(b,c,"subheader")})])),a.opts.autoescape),h+="\n"),h+="\n\n\x3c!-- first nudge displays different elems --\x3e\n",d.contextOrFrameLookup(b,c,"first")&&(h+="\n",h+=d.suppressValue((f=29,g=10,d.callWrap(d.contextOrFrameLookup(b,c,"component"),"component",b,["hippo/components/paywall/compressed-first.html",d.makeKeywordArgs({message:d.contextOrFrameLookup(b,c,"message"),cap:d.contextOrFrameLookup(b,c,"cap"),viewCount:d.contextOrFrameLookup(b,c,"viewCount"),countNotice:d.contextOrFrameLookup(b,c,"countNotice"),countNoticeMobile:d.contextOrFrameLookup(b,c,"countNoticeMobile"),messageCompressed:d.contextOrFrameLookup(b,c,"messageCompressed"),subheader:d.contextOrFrameLookup(b,c,"subheader")})])),a.opts.autoescape),h+="\n"),h+="\n",i?i.rootRenderFunc(a,b,c,d,e):e(null,h)}catch(a){e(d.handleError(a,f,g))}}return{root:a}}();e["hippo/components/nudge-compressed.html"]=f,c.exports=f}),System.registerDynamic("theatlantic/templates/hippo/components/nudge-onboarding.html",[],!0,function(a,b,c){var d=this||self,e=d.nunjucksPrecompiled=d.nunjucksPrecompiled||{},f=function(){function a(a,b,c,d,e){var f="";try{var g=null;f+='<div class="c-nudge-onboarding">\n  <div class="c-nudge-onboarding__text-container">\n      <svg class="c-nudge-onboarding__icon" width="24" height="24">\n          <use xlink:href="#icon-onboarding-',f+=d.suppressValue(d.memberLookup(d.contextOrFrameLookup(b,c,"message"),"icon"),a.opts.autoescape),f+='"></use>\n      </svg>\n    <div class="c-nudge-onboarding__text">',f+=d.suppressValue(d.memberLookup(d.contextOrFrameLookup(b,c,"message"),"desktop"),a.opts.autoescape),f+='</div>\n    <a class="c-nudge-onboarding__link--desktop js-onboarding-link" href="',f+=d.suppressValue(d.memberLookup(d.contextOrFrameLookup(b,c,"message"),"linkUrl"),a.opts.autoescape),f+='">\n      ',f+=d.suppressValue(d.memberLookup(d.contextOrFrameLookup(b,c,"message"),"link"),a.opts.autoescape),f+='\n    </a>\n    <div class="c-nudge-onboarding__container-mobile">\n      <a href="',f+=d.suppressValue(d.memberLookup(d.contextOrFrameLookup(b,c,"message"),"linkUrl"),a.opts.autoescape),f+='" class="c-nudge-onboarding__link--mobile js-onboarding-link" >\n          ',f+=d.suppressValue(d.memberLookup(d.contextOrFrameLookup(b,c,"message"),"mobile"),a.opts.autoescape),f+='\n      </a>\n    </div>\n  </div>\n  <svg class="c-nudge-onboarding__close-icon">\n      <use xlink:href="#icon-nav-close"></use>\n  </svg>\n</div>\n',g?g.rootRenderFunc(a,b,c,d,e):e(null,f)}catch(a){e(d.handleError(a,null,null))}}return{root:a}}();e["hippo/components/nudge-onboarding.html"]=f,c.exports=f}),System.registerDynamic("theatlantic/templates/hippo/components/paywall/nudge-login.html",[],!0,function(a,b,c){var d=this||self,e=d.nunjucksPrecompiled=d.nunjucksPrecompiled||{},f=function(){function a(a,b,c,d,e){var f="";try{var g=null;f+='<a\n  href="',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"accounts_url"),a.opts.autoescape),d.contextOrFrameLookup(b,c,"loggedIn")||(f+="/login/"),f+='"\n  class="c-nudge__compressed-anchor ',d.contextOrFrameLookup(b,c,"border")&&(f+="c-nudge__login--bordered"),f+=" ",d.contextOrFrameLookup(b,c,"loggedIn")||(f+="js-accounts-modal"),f+=" ",f+=d.suppressValue(d.contextOrFrameLookup(b,c,"tracking"),a.opts.autoescape),f+='"\n  role="button"\n>\n  ',d.contextOrFrameLookup(b,c,"loggedIn")?f+=" Link your account ":f+=" Sign in ",f+="\n</a>\n",g?g.rootRenderFunc(a,b,c,d,e):e(null,f)}catch(a){e(d.handleError(a,null,null))}}return{root:a}}();e["hippo/components/paywall/nudge-login.html"]=f,c.exports=f}),System.registerDynamic("theatlantic/templates/hippo/components/paywall/nudge-icon-expand.html",[],!0,function(a,b,c){var d=this||self,e=d.nunjucksPrecompiled=d.nunjucksPrecompiled||{},f=function(){function a(a,b,c,d,e){var f="";try{var g=null;f+='<a class="c-nudge__icon" aria-label="expand message" role="button" href="#">\n    <svg class="c-nudge__expand-icon"><use xlink:href="#icon-ui-chevron-expand"></use></svg>\n  </a>',g?g.rootRenderFunc(a,b,c,d,e):e(null,f)}catch(a){e(d.handleError(a,null,null))}}return{root:a}}();e["hippo/components/paywall/nudge-icon-expand.html"]=f,c.exports=f}),System.registerDynamic("theatlantic/templates/hippo/components/paywall/nudge-subscribe.html",[],!0,function(a,b,c){var d=this||self,e=d.nunjucksPrecompiled=d.nunjucksPrecompiled||{},f=function(){function a(a,b,c,d,e){var f="";try{var g=null;f+='<a href="',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"accounts_url"),a.opts.autoescape),f+="/products?source=nudge",f+=d.suppressValue(d.contextOrFrameLookup(b,c,"viewCount"),a.opts.autoescape),f+='" class="c-nudge__button">\n    Subscribe Now\n  </a>',g?g.rootRenderFunc(a,b,c,d,e):e(null,f)}catch(a){e(d.handleError(a,null,null))}}return{root:a}}();e["hippo/components/paywall/nudge-subscribe.html"]=f,c.exports=f}),System.registerDynamic("theatlantic/templates/hippo/components/paywall/compressed-final.html",[],!0,function(a,b,c){var d=this||self,e=d.nunjucksPrecompiled=d.nunjucksPrecompiled||{},f=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{var i=null;h+='<div class="c-nudge__spacing-container">\n    \x3c!-- right container for subscribe button and compression button --\x3e\n    <div class="c-nudge__compressed-link ',d.contextOrFrameLookup(b,c,"buttonCentered")&&(h+=" c-nudge__compressed-link--mobile-hidden "),h+='">\n      <span class="c-nudge__message-desktop c-nudge__message-desktop--emphasized">',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"messageCompressed"),a.opts.autoescape),h+='</span>\n      <span class="c-nudge__message-mobile c-nudge__message-mobile--emphasized">',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"countNoticeMobile"),a.opts.autoescape),h+="</span>\n    </div>\n    ",h+=d.suppressValue((f=6,g=14,d.callWrap(d.contextOrFrameLookup(b,c,"component"),"component",b,["hippo/components/paywall/nudge-login.html",d.makeKeywordArgs({tracking:"js-login-click-compressed",border:!0})])),a.opts.autoescape),h+='\n      <div class="c-nudge__subscribe-container">\n      ',h+=d.suppressValue((f=10,g=16,d.callWrap(d.contextOrFrameLookup(b,c,"component"),"component",b,["hippo/components/paywall/nudge-icon-expand.html"])),a.opts.autoescape),h+="\n      ",h+=d.suppressValue((f=11,g=16,d.callWrap(d.contextOrFrameLookup(b,c,"component"),"component",b,["hippo/components/paywall/nudge-subscribe.html"])),a.opts.autoescape),h+="\n    </div>\n  </div>",i?i.rootRenderFunc(a,b,c,d,e):e(null,h)}catch(a){e(d.handleError(a,f,g))}}return{root:a}}();e["hippo/components/paywall/compressed-final.html"]=f,c.exports=f}),System.registerDynamic("theatlantic/templates/hippo/components/paywall/compressed-first.html",[],!0,function(a,b,c){var d=this||self,e=d.nunjucksPrecompiled=d.nunjucksPrecompiled||{},f=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{var i=null;h+='<div class="c-nudge__spacing-container">\n    \x3c!-- right container for subscribe button and compression button --\x3e\n    <div class="c-nudge__compressed-link c-nudge__compressed-link--mobile-hidden">\n      <span class="c-nudge__message-desktop">',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"messageCompressed"),a.opts.autoescape),h+='</span>\n      <span class="c-nudge__message-mobile c-nudge__message-mobile--emphasized">',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"countNoticeMobile"),a.opts.autoescape),h+="</span>\n    </div>\n    ",h+=d.suppressValue((f=6,g=14,d.callWrap(d.contextOrFrameLookup(b,c,"component"),"component",b,["hippo/components/paywall/nudge-login.html",d.makeKeywordArgs({tracking:"js-login-click-compressed",border:!0})])),a.opts.autoescape),h+='\n    <div class="c-nudge__subscribe-container">\n      ',h+=d.suppressValue((f=10,g=16,d.callWrap(d.contextOrFrameLookup(b,c,"component"),"component",b,["hippo/components/paywall/nudge-icon-expand.html"])),a.opts.autoescape),h+='\n      <a\n        href="',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"accounts_url"),a.opts.autoescape),h+="/products?source=nudge",h+=d.suppressValue(d.contextOrFrameLookup(b,c,"viewCount"),a.opts.autoescape),h+='"\n        class="c-nudge__subscribe-link-mobile c-nudge__button c-nudge__button--centered"\n      >\n        Subscribe for less than $1 per week\n      </a>\n      <a\n        href="',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"accounts_url"),a.opts.autoescape),h+="/products?source=nudge",h+=d.suppressValue(d.contextOrFrameLookup(b,c,"viewCount"),a.opts.autoescape),h+='"\n        class="c-nudge__button c-nudge__button--mobile-hidden"\n      >\n        Subscribe Now\n      </a>\n    </div>\n  </div>',i?i.rootRenderFunc(a,b,c,d,e):e(null,h)}catch(a){e(d.handleError(a,f,g))}}return{root:a}}();e["hippo/components/paywall/compressed-first.html"]=f,c.exports=f}),System.registerDynamic("theatlantic/templates/hippo/components/paywall/compressed-mid.html",[],!0,function(a,b,c){var d=this||self,e=d.nunjucksPrecompiled=d.nunjucksPrecompiled||{},f=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{var i=null;h+='<div class="c-nudge__spacing-container">\n    \x3c!-- right container for subscribe button and compression button --\x3e\n    <div class="c-nudge__compressed-link">\n      <span class="c-nudge__count" role="text"\n        >',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"cap")-d.contextOrFrameLookup(b,c,"viewCount"),a.opts.autoescape),h+='</span>\n      <span class="c-nudge__message-desktop">',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"messageCompressed"),a.opts.autoescape),h+='</span>\n      <span class="c-nudge__message-mobile">',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"countNoticeMobile"),a.opts.autoescape),h+="</span>\n    </div>\n    ",h+=d.suppressValue((f=8,g=14,d.callWrap(d.contextOrFrameLookup(b,c,"component"),"component",b,["hippo/components/paywall/nudge-login.html",d.makeKeywordArgs({tracking:"js-login-click-compressed",border:!0})])),a.opts.autoescape),h+='\n    <div class="c-nudge__subscribe-container">\n      ',h+=d.suppressValue((f=12,g=16,d.callWrap(d.contextOrFrameLookup(b,c,"component"),"component",b,["hippo/components/paywall/nudge-icon-expand.html"])),a.opts.autoescape),h+="\n      ",h+=d.suppressValue((f=13,g=16,d.callWrap(d.contextOrFrameLookup(b,c,"component"),"component",b,["hippo/components/paywall/nudge-subscribe.html"])),a.opts.autoescape),h+="\n    </div>\n  </div>",i?i.rootRenderFunc(a,b,c,d,e):e(null,h)}catch(a){e(d.handleError(a,f,g))}}return{root:a}}();e["hippo/components/paywall/compressed-mid.html"]=f,c.exports=f}),System.registerDynamic("theatlantic/templates/hippo/components/paywall/expanded-final.html",[],!0,function(a,b,c){var d=this||self,e=d.nunjucksPrecompiled=d.nunjucksPrecompiled||{},f=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{var i=null;h+='<div class="c-nudge__spacing-container">\n    <a class="c-nudge__icon" aria-label="collapse message" role="button" href="#">\n        <svg class="c-nudge__compress-icon">\n            <use xlink:href="#icon-ui-chevron-compress"></use>\n        </svg>\n    </a>\n\n    <div class="c-nudge__nudge-container">\n        <span class="c-nudge__notice c-nudge__notice--emphasized">',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"countNotice"),a.opts.autoescape),h+='</span>\n        <span class="c-nudge__login--bordered">\n            Already a subscriber?\n            ',h+=d.suppressValue((f=11,g=22,d.callWrap(d.contextOrFrameLookup(b,c,"component"),"component",b,["hippo/components/paywall/nudge-login.html",d.makeKeywordArgs({tracking:"js-login-click-expanded"})])),a.opts.autoescape),h+='\n        </span>\n    </div>\n    <div class="c-nudge__copy-container">\n        <span class="c-nudge__header-mobile c-nudge__header-mobile--emphasized">',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"countNoticeMobile"),a.opts.autoescape),h+='</span>\n        <p class="c-nudge__header">',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"message"),a.opts.autoescape),h+='</p>\n        <p class="c-nudge__subheader subheader-mobile">',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"subheaderMobile"),a.opts.autoescape),h+='</p>\n        <p class="c-nudge__subheader subheader-desktop">',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"subheader"),a.opts.autoescape),h+='</p>\n    </div>\n    \x3c!-- right container for subscribe button and compression button --\x3e\n    <div class="c-nudge__subscribe-container">\n        ',h+=d.suppressValue((f=22,g=18,d.callWrap(d.contextOrFrameLookup(b,c,"component"),"component",b,["hippo/components/paywall/nudge-subscribe.html"])),a.opts.autoescape),h+="\n    </div>\n</div>",i?i.rootRenderFunc(a,b,c,d,e):e(null,h)}catch(a){e(d.handleError(a,f,g))}}return{root:a}}();e["hippo/components/paywall/expanded-final.html"]=f,c.exports=f}),System.registerDynamic("theatlantic/templates/hippo/components/paywall/expanded-mid.html",[],!0,function(a,b,c){var d=this||self,e=d.nunjucksPrecompiled=d.nunjucksPrecompiled||{},f=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{var i=null;h+='<div class="c-nudge__spacing-container">\n    <a class="c-nudge__icon" aria-label="collapse message" role="button" href="#">\n        <svg class="c-nudge__compress-icon">\n            <use xlink:href="#icon-ui-chevron-compress"></use>\n        </svg>\n    </a>\n\n    <div class="c-nudge__nudge-container">\n        <span class="c-nudge__count" role="text">',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"cap")-d.contextOrFrameLookup(b,c,"viewCount"),a.opts.autoescape),h+='</span>\n        <span class="c-nudge__notice">',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"countNotice"),a.opts.autoescape),h+='</span>\n        <span class="c-nudge__login--bordered">\n            Already a subscriber?\n            ',h+=d.suppressValue((f=12,g=22,d.callWrap(d.contextOrFrameLookup(b,c,"component"),"component",b,["hippo/components/paywall/nudge-login.html",d.makeKeywordArgs({tracking:"js-login-click-expanded",border:!1})])),a.opts.autoescape),h+='\n        </span>\n    </div>\n    <div class="c-nudge__copy-container">\n        ',d.contextOrFrameLookup(b,c,"first")||(h+='<span class="c-nudge__count-mobile" role="text">',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"cap")-d.contextOrFrameLookup(b,c,"viewCount"),a.opts.autoescape),h+="</span>"),h+='\n        <span class="c-nudge__header-mobile">',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"countNoticeMobile"),a.opts.autoescape),h+='</span>\n        <p class="c-nudge__header">',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"message"),a.opts.autoescape),h+='</p>\n        <p class="c-nudge__subheader">',h+=d.suppressValue(d.contextOrFrameLookup(b,c,"subheader"),a.opts.autoescape),h+='</p>\n    </div>\n    \x3c!-- right container for subscribe button and compression button --\x3e\n    <div class="c-nudge__subscribe-container">\n        ',h+=d.suppressValue((f=25,g=18,d.callWrap(d.contextOrFrameLookup(b,c,"component"),"component",b,["hippo/components/paywall/nudge-subscribe.html"])),a.opts.autoescape),h+="\n    </div>\n</div>",i?i.rootRenderFunc(a,b,c,d,e):e(null,h)}catch(a){e(d.handleError(a,f,g))}}return{root:a}}();e["hippo/components/paywall/expanded-mid.html"]=f,c.exports=f}),System.register("theatlantic/js/paywall/utils/renderIntoDom.js",["npm:systemjs-plugin-babel@0.0.25/regenerator-runtime.js","npm:systemjs-plugin-babel@0.0.25/babel-helpers/extends.js","npm:systemjs-plugin-babel@0.0.25/babel-helpers/asyncToGenerator.js","hippo/components/nudge-expanded","hippo/components/nudge-compressed","hippo/components/nudge-onboarding","hippo/components/paywall/nudge-login","hippo/components/paywall/nudge-icon-expand","hippo/components/paywall/nudge-subscribe","hippo/components/paywall/compressed-final","hippo/components/paywall/compressed-first","hippo/components/paywall/compressed-mid","hippo/components/paywall/expanded-final","hippo/components/paywall/expanded-mid","../../utils/user","../../utils/nunjucks"],function(a,b){"use strict";var c,d,e,f,g,h;return{setters:[function(a){c=a.default},function(a){d=a.default},function(a){e=a.default},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){f=a.isLoggedIn},function(a){g=a.render}],execute:function(){h=".c-article-header, .c-article-header--ideas, .article-body, .article-container",a("default",function(){function a(a,c){return b.apply(this,arguments)}var b=e(c.mark(function a(b,e){var i,j,k,l;return c.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return i=f(),j=document.querySelector(".c-nudge__container"),j&&j.remove(),k=document.createElement("div"),k.className="c-nudge__container c-"+b+"__container",k.tabIndex=-1,a.next=8,g(b,d({},e,{loggedIn:i}));case 8:return k.innerHTML=a.sent,l=document.querySelector(h),l.append(k),a.abrupt("return",k);case 12:case"end":return a.stop()}},a,this)}));return a}())}}}),System.registerDynamic("theatlantic/templates/hippo/components/gate.html",[],!0,function(a,b,c){var d=this||self,e=d.nunjucksPrecompiled=d.nunjucksPrecompiled||{},f=function(){function a(a,b,c,d,e){var f="";try{var g=null;f+='<div class="c-gate__viewport">\n  \x3c!-- begin shadow --\x3e\n    <div class="c-gate__shadow"></div>\n    \x3c!-- begin gate viewport --\x3e\n    <div class="c-gate__spacing-container">\n      <span>',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"mobileSubtitle"),a.opts.autoescape),f+='</span>\n      <p class="c-gate__header">',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"mobileTitle"),a.opts.autoescape),f+="</p>\n      <span>",f+=d.suppressValue(d.contextOrFrameLookup(b,c,"mobileTitleBelow"),a.opts.autoescape),f+='</span>\n      <a href="',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"accounts_url"),a.opts.autoescape),f+='/products?source=gate" role="link"><div class="c-gate__subscribe-button">See Plans</div></a>\n      <span class="c-gate__subscribe-link">Already a subscriber? \n        <a href="',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"accounts_url"),a.opts.autoescape),d.contextOrFrameLookup(b,c,"loggedIn")||(f+="/login/"),f+='" class="c-gate__link ',d.contextOrFrameLookup(b,c,"loggedIn")||(f+="js-accounts-modal"),f+='" role="button">\n          ',d.contextOrFrameLookup(b,c,"loggedIn")?f+="\n          Link your account\n          ":f+="\n          Sign in\n          ",f+="\n        </a>\n      </span>    \n    </div>\n    \x3c!-- end gate viewport --\x3e\n</div>\n",g?g.rootRenderFunc(a,b,c,d,e):e(null,f)}catch(a){e(d.handleError(a,null,null))}}return{root:a}}();e["hippo/components/gate.html"]=f,c.exports=f}),System.register("theatlantic/js/paywall/gate.js",["npm:systemjs-plugin-babel@0.0.25/regenerator-runtime.js","npm:systemjs-plugin-babel@0.0.25/babel-helpers/asyncToGenerator.js","./utils/renderIntoDom","../globals/dataLayer","hippo/components/gate"],function(a,b){"use strict";function c(){var a=this;return function(){var b=e(d.mark(function b(c){return d.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:document.body.classList.add("with-gate"),f("gate",c).then(function(){if("button-color.blue"===window.Atlantic.page_info.request.experiment){document.querySelector(".c-gate__subscribe-button").classList.add("c-gate__subscribe-button--variant")}}),g.push({gateTemplate:"gate",event:"Gate Template Set"});case 3:case"end":return a.stop()}},b,a)}));return function(a){return b.apply(this,arguments)}}()}var d,e,f,g;return a("default",c),{setters:[function(a){d=a.default},function(a){e=a.default},function(a){f=a.default},function(a){g=a.default},function(a){}],execute:function(){}}}),System.registerDynamic("npm:is-date-object@1.0.1.json",[],!0,function(){return{main:"index.js",format:"cjs",meta:{"*.json":{format:"json"}}}}),System.registerDynamic("npm:is-date-object@1.0.1/index.js",[],!0,function(a,b,c){"use strict";var d=(this||self,Date.prototype.getDay),e=function(a){try{return d.call(a),!0}catch(a){return!1}},f=Object.prototype.toString,g="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;c.exports=function(a){return"object"==typeof a&&null!==a&&(g?e(a):"[object Date]"===f.call(a))}}),System.registerDynamic("npm:has-symbols@1.0.0/shams.js",[],!0,function(a,b,c){"use strict";this||self;c.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var a={},b=Symbol("test"),c=Object(b);if("string"==typeof b)return!1;if("[object Symbol]"!==Object.prototype.toString.call(b))return!1;if("[object Symbol]"!==Object.prototype.toString.call(c))return!1;var d=42;a[b]=d;for(b in a)return!1;if("function"==typeof Object.keys&&0!==Object.keys(a).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(a).length)return!1;var e=Object.getOwnPropertySymbols(a);if(1!==e.length||e[0]!==b)return!1;if(!Object.prototype.propertyIsEnumerable.call(a,b))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var f=Object.getOwnPropertyDescriptor(a,b);if(f.value!==d||!0!==f.enumerable)return!1}return!0}}),System.registerDynamic("npm:has-symbols@1.0.0.json",[],!0,function(){return{main:"index.js",format:"cjs",meta:{"*.json":{format:"json"}},map:{"./test":"./test/index.js"}}}),System.registerDynamic("npm:has-symbols@1.0.0/index.js",["./shams"],!0,function(a,b,c){"use strict";var d=this||self,e=d.Symbol,f=a("./shams");c.exports=function(){return"function"==typeof e&&("function"==typeof Symbol&&("symbol"==typeof e("foo")&&("symbol"==typeof Symbol("bar")&&f())))}}),System.registerDynamic("npm:is-symbol@1.0.2.json",[],!0,function(){return{main:"index.js",format:"cjs",meta:{"*.json":{format:"json"}},map:{"./test":"./test/index.js"}}}),System.registerDynamic("npm:is-symbol@1.0.2/index.js",["has-symbols"],!0,function(a,b,c){"use strict";var d=(this||self,Object.prototype.toString);if(a("has-symbols")()){var e=Symbol.prototype.toString,f=/^Symbol\(.*\)$/,g=function(a){return"symbol"==typeof a.valueOf()&&f.test(e.call(a))};c.exports=function(a){if("symbol"==typeof a)return!0;if("[object Symbol]"!==d.call(a))return!1;try{return g(a)}catch(a){return!1}}}else c.exports=function(a){return!1}}),System.registerDynamic("npm:es-to-primitive@1.2.0/es2015.js",["./helpers/isPrimitive","is-callable","is-date-object","is-symbol"],!0,function(a,b,c){"use strict";var d=(this||self,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator),e=a("./helpers/isPrimitive"),f=a("is-callable"),g=a("is-date-object"),h=a("is-symbol"),i=function(a,b){if(void 0===a||null===a)throw new TypeError("Cannot call method on "+a);if("string"!=typeof b||"number"!==b&&"string"!==b)throw new TypeError('hint must be "string" or "number"');var c,d,g,h="string"===b?["toString","valueOf"]:["valueOf","toString"];for(g=0;g<h.length;++g)if(c=a[h[g]],f(c)&&(d=c.call(a),e(d)))return d;throw new TypeError("No default value")},j=function(a,b){var c=a[b];if(null!==c&&void 0!==c){if(!f(c))throw new TypeError(c+" returned for property "+b+" of object "+a+" is not a function");return c}};c.exports=function(a){if(e(a))return a;var b="default";arguments.length>1&&(arguments[1]===String?b="string":arguments[1]===Number&&(b="number"));var c;if(d&&(Symbol.toPrimitive?c=j(a,Symbol.toPrimitive):h(a)&&(c=Symbol.prototype.valueOf)),void 0!==c){var f=c.call(a,b);if(e(f))return f;throw new TypeError("unable to convert exotic object to primitive")}return"default"===b&&(g(a)||h(a))&&(b="string"),i(a,"default"===b?"number":b)}}),System.registerDynamic("npm:es-to-primitive@1.2.0/es6.js",["./es2015"],!0,function(a,b,c){"use strict";this||self;c.exports=a("./es2015")}),System.registerDynamic("npm:es-abstract@1.13.0/helpers/isPrimitive.js",[],!0,function(a,b,c){this||self;c.exports=function(a){return null===a||"function"!=typeof a&&"object"!=typeof a}}),System.registerDynamic("npm:es-abstract@1.13.0/helpers/assertRecord.js",["../GetIntrinsic","has"],!0,function(a,b,c){"use strict";var d=(this||self,a("../GetIntrinsic")),e=d("%TypeError%"),f=d("%SyntaxError%"),g=a("has"),h={"Property Descriptor":function(a,b){if("Object"!==a.Type(b))return!1;var c={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var d in b)if(g(b,d)&&!c[d])return!1;var f=g(b,"[[Value]]"),h=g(b,"[[Get]]")||g(b,"[[Set]]");if(f&&h)throw new e("Property Descriptors may not be both accessor and data descriptors");return!0}};c.exports=function(a,b,c,d){var g=h[b];if("function"!=typeof g)throw new f("unknown record type: "+b);if(!g(a,d))throw new e(c+" must be a "+b);console.log(g(a,d),d)}}),System.registerDynamic("npm:es-abstract@1.13.0/helpers/isNaN.js",[],!0,function(a,b,c){this||self;c.exports=Number.isNaN||function(a){return a!==a}}),System.registerDynamic("npm:es-abstract@1.13.0/helpers/isFinite.js",[],!0,function(a,b,c){var d=(this||self,Number.isNaN||function(a){return a!==a});c.exports=Number.isFinite||function(a){return"number"==typeof a&&!d(a)&&a!==1/0&&a!==-1/0}}),System.registerDynamic("npm:es-abstract@1.13.0/helpers/sign.js",[],!0,function(a,b,c){this||self;c.exports=function(a){return a>=0?1:-1}}),System.registerDynamic("npm:es-abstract@1.13.0/helpers/mod.js",[],!0,function(a,b,c){this||self;c.exports=function(a,b){var c=a%b;return Math.floor(c>=0?c:c+b)}}),System.registerDynamic("npm:es-to-primitive@1.2.0/helpers/isPrimitive.js",[],!0,function(a,b,c){this||self;c.exports=function(a){return null===a||"function"!=typeof a&&"object"!=typeof a}}),System.registerDynamic("npm:is-callable@1.1.4.json",[],!0,function(){return{main:"index.js",format:"cjs",meta:{"*.json":{format:"json"}}}}),System.registerDynamic("npm:is-callable@1.1.4/index.js",[],!0,function(a,b,c){"use strict";var d=(this||self,Function.prototype.toString),e=/^\s*class\b/,f=function(a){try{var b=d.call(a);return e.test(b)}catch(a){return!1}},g=function(a){try{return!f(a)&&(d.call(a),!0)}catch(a){return!1}},h=Object.prototype.toString,i="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;c.exports=function(a){if(!a)return!1;if("function"!=typeof a&&"object"!=typeof a)return!1;if("function"==typeof a&&!a.prototype)return!0;if(i)return g(a);if(f(a))return!1;var b=h.call(a);return"[object Function]"===b||"[object GeneratorFunction]"===b}}),System.registerDynamic("npm:es-to-primitive@1.2.0.json",[],!0,function(){return{main:"index.js",format:"cjs",meta:{"*.json":{format:"json"}},map:{"./test":"./test/index.js"}}}),System.registerDynamic("npm:es-to-primitive@1.2.0/es5.js",["./helpers/isPrimitive","is-callable"],!0,function(a,b,c){"use strict";var d=(this||self,Object.prototype.toString),e=a("./helpers/isPrimitive"),f=a("is-callable"),g={"[[DefaultValue]]":function(a){var b;if((b=arguments.length>1?arguments[1]:"[object Date]"===d.call(a)?String:Number)===String||b===Number){var c,g,h=b===String?["toString","valueOf"]:["valueOf","toString"];for(g=0;g<h.length;++g)if(f(a[h[g]])&&(c=a[h[g]](),e(c)))return c;throw new TypeError("No default value")}throw new TypeError("invalid [[DefaultValue]] hint supplied")}};c.exports=function(a){return e(a)?a:arguments.length>1?g["[[DefaultValue]]"](a,arguments[1]):g["[[DefaultValue]]"](a)}}),System.registerDynamic("npm:es-abstract@1.13.0/es5.js",["./GetIntrinsic","./helpers/assertRecord","./helpers/isNaN","./helpers/isFinite","./helpers/sign","./helpers/mod","is-callable","es-to-primitive/es5","has"],!0,function(a,b,c){"use strict";var d=(this||self,a("./GetIntrinsic")),e=d("%Object%"),f=d("%TypeError%"),g=d("%String%"),h=a("./helpers/assertRecord"),i=a("./helpers/isNaN"),j=a("./helpers/isFinite"),k=a("./helpers/sign"),l=a("./helpers/mod"),m=a("is-callable"),n=a("es-to-primitive/es5"),o=a("has"),p={ToPrimitive:n,ToBoolean:function(a){return!!a},ToNumber:function(a){return+a},ToInteger:function(a){var b=this.ToNumber(a);return i(b)?0:0!==b&&j(b)?k(b)*Math.floor(Math.abs(b)):b},ToInt32:function(a){return this.ToNumber(a)>>0},ToUint32:function(a){return this.ToNumber(a)>>>0},ToUint16:function(a){var b=this.ToNumber(a);if(i(b)||0===b||!j(b))return 0;var c=k(b)*Math.floor(Math.abs(b));return l(c,65536)},ToString:function(a){return g(a)},ToObject:function(a){return this.CheckObjectCoercible(a),e(a)},CheckObjectCoercible:function(a,b){if(null==a)throw new f(b||"Cannot call method on "+a);return a},IsCallable:m,SameValue:function(a,b){return a===b?0!==a||1/a==1/b:i(a)&&i(b)},Type:function(a){return null===a?"Null":void 0===a?"Undefined":"function"==typeof a||"object"==typeof a?"Object":"number"==typeof a?"Number":"boolean"==typeof a?"Boolean":"string"==typeof a?"String":void 0},IsPropertyDescriptor:function(a){if("Object"!==this.Type(a))return!1;var b={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var c in a)if(o(a,c)&&!b[c])return!1;var d=o(a,"[[Value]]"),e=o(a,"[[Get]]")||o(a,"[[Set]]");if(d&&e)throw new f("Property Descriptors may not be both accessor and data descriptors");return!0},IsAccessorDescriptor:function(a){return void 0!==a&&(h(this,"Property Descriptor","Desc",a),!(!o(a,"[[Get]]")&&!o(a,"[[Set]]")))},IsDataDescriptor:function(a){return void 0!==a&&(h(this,"Property Descriptor","Desc",a),!(!o(a,"[[Value]]")&&!o(a,"[[Writable]]")))},IsGenericDescriptor:function(a){return void 0!==a&&(h(this,"Property Descriptor","Desc",a),!this.IsAccessorDescriptor(a)&&!this.IsDataDescriptor(a))},FromPropertyDescriptor:function(a){if(void 0===a)return a;if(h(this,"Property Descriptor","Desc",a),this.IsDataDescriptor(a))return{value:a["[[Value]]"],writable:!!a["[[Writable]]"],enumerable:!!a["[[Enumerable]]"],configurable:!!a["[[Configurable]]"]};if(this.IsAccessorDescriptor(a))return{get:a["[[Get]]"],set:a["[[Set]]"],enumerable:!!a["[[Enumerable]]"],configurable:!!a["[[Configurable]]"]};throw new f("FromPropertyDescriptor must be called with a fully populated Property Descriptor")},ToPropertyDescriptor:function(a){if("Object"!==this.Type(a))throw new f("ToPropertyDescriptor requires an object");var b={};if(o(a,"enumerable")&&(b["[[Enumerable]]"]=this.ToBoolean(a.enumerable)),o(a,"configurable")&&(b["[[Configurable]]"]=this.ToBoolean(a.configurable)),o(a,"value")&&(b["[[Value]]"]=a.value),o(a,"writable")&&(b["[[Writable]]"]=this.ToBoolean(a.writable)),o(a,"get")){var c=a.get;if(void 0!==c&&!this.IsCallable(c))throw new TypeError("getter must be a function");b["[[Get]]"]=c}if(o(a,"set")){var d=a.set;if(void 0!==d&&!this.IsCallable(d))throw new f("setter must be a function");b["[[Set]]"]=d}if((o(b,"[[Get]]")||o(b,"[[Set]]"))&&(o(b,"[[Value]]")||o(b,"[[Writable]]")))throw new f("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return b}};c.exports=p}),System.registerDynamic("npm:has@1.0.3.json",[],!0,function(){return{main:"src/index.js",format:"cjs",meta:{"*.json":{format:"json"}},map:{"./src":"./src/index.js","./test":"./test/index.js"}}}),System.registerDynamic("npm:has@1.0.3/src/index.js",["function-bind"],!0,function(a,b,c){"use strict";var d=(this||self,a("function-bind"));c.exports=d.call(Function.call,Object.prototype.hasOwnProperty)}),System.registerDynamic("npm:is-regex@1.0.4.json",[],!0,function(){return{main:"index.js",format:"cjs",meta:{"*.json":{format:"json"}}}}),System.registerDynamic("npm:is-regex@1.0.4/index.js",["has"],!0,function(a,b,c){"use strict";var d=(this||self,a("has")),e=RegExp.prototype.exec,f=Object.getOwnPropertyDescriptor,g=function(a){try{var b=a.lastIndex;return a.lastIndex=0,e.call(a),!0}catch(a){return!1}finally{a.lastIndex=b}},h=Object.prototype.toString,i="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;c.exports=function(a){if(!a||"object"!=typeof a)return!1;if(!i)return"[object RegExp]"===h.call(a);var b=f(a,"lastIndex");return!(!b||!d(b,"value"))&&g(a)}}),System.registerDynamic("npm:es-abstract@1.13.0/es2015.js",["has","es-to-primitive/es6","object-keys","./GetIntrinsic","./helpers/assertRecord","./helpers/isNaN","./helpers/isFinite","./helpers/assign","./helpers/sign","./helpers/mod","./helpers/isPrimitive","function-bind","./es5","is-regex"],!0,function(a,b,c){"use strict";var d=(this||self,a("has")),e=a("es-to-primitive/es6"),f=a("object-keys"),g=a("./GetIntrinsic"),h=g("%TypeError%"),i=g("%SyntaxError%"),j=g("%Array%"),k=g("%String%"),l=g("%Object%"),m=g("%Number%"),n=g("%Symbol%",!0),o=g("%RegExp%"),p=!!n,q=a("./helpers/assertRecord"),r=a("./helpers/isNaN"),s=a("./helpers/isFinite"),t=m.MAX_SAFE_INTEGER||Math.pow(2,53)-1,u=a("./helpers/assign"),v=a("./helpers/sign"),w=a("./helpers/mod"),x=a("./helpers/isPrimitive"),y=parseInt,z=a("function-bind"),A=z.call(Function.call,j.prototype.slice),B=z.call(Function.call,k.prototype.slice),C=z.call(Function.call,o.prototype.test,/^0b[01]+$/i),D=z.call(Function.call,o.prototype.test,/^0o[0-7]+$/i),E=z.call(Function.call,o.prototype.exec),F=["","",""].join(""),G=new o("["+F+"]","g"),H=z.call(Function.call,o.prototype.test,G),I=/^[-+]0x[0-9a-f]+$/i,J=z.call(Function.call,o.prototype.test,I),K=z.call(Function.call,k.prototype.charCodeAt),L=z.call(Function.call,Object.prototype.toString),M=z.call(Function.call,g("%NumberPrototype%").valueOf),N=z.call(Function.call,g("%BooleanPrototype%").valueOf),O=z.call(Function.call,g("%StringPrototype%").valueOf),P=z.call(Function.call,g("%DatePrototype%").valueOf),Q=Math.floor,R=Math.abs,S=Object.create,T=l.getOwnPropertyDescriptor,U=l.isExtensible,V=l.defineProperty,W=["\t\n\v\f\r ","\u2028","\u2029\ufeff"].join(""),X=new RegExp("(^["+W+"]+)|(["+W+"]+$)","g"),Y=z.call(Function.call,k.prototype.replace),Z=function(a){return Y(a,X,"")},$=a("./es5"),_=a("is-regex"),aa=u(u({},$),{Call:function(a,b){var c=arguments.length>2?arguments[2]:[];if(!this.IsCallable(a))throw new h(a+" is not a function");return a.apply(b,c)},ToPrimitive:e,ToNumber:function(a){var b=x(a)?a:e(a,m);if("symbol"==typeof b)throw new h("Cannot convert a Symbol value to a number");if("string"==typeof b){if(C(b))return this.ToNumber(y(B(b,2),2));if(D(b))return this.ToNumber(y(B(b,2),8));if(H(b)||J(b))return NaN;var c=Z(b);if(c!==b)return this.ToNumber(c)}return m(b)},ToInt16:function(a){var b=this.ToUint16(a);return b>=32768?b-65536:b},ToInt8:function(a){var b=this.ToUint8(a);return b>=128?b-256:b},ToUint8:function(a){var b=this.ToNumber(a);if(r(b)||0===b||!s(b))return 0;var c=v(b)*Q(R(b));return w(c,256)},ToUint8Clamp:function(a){var b=this.ToNumber(a);if(r(b)||b<=0)return 0;if(b>=255)return 255;var c=Q(a);return c+.5<b?c+1:b<c+.5?c:c%2!=0?c+1:c},ToString:function(a){if("symbol"==typeof a)throw new h("Cannot convert a Symbol value to a string");return k(a)},ToObject:function(a){return this.RequireObjectCoercible(a),l(a)},ToPropertyKey:function(a){var b=this.ToPrimitive(a,k);return"symbol"==typeof b?b:this.ToString(b)},ToLength:function(a){var b=this.ToInteger(a);return b<=0?0:b>t?t:b},CanonicalNumericIndexString:function(a){if("[object String]"!==L(a))throw new h("must be a string");if("-0"===a)return-0;var b=this.ToNumber(a);return this.SameValue(this.ToString(b),a)?b:void 0},RequireObjectCoercible:$.CheckObjectCoercible,IsArray:j.isArray||function(a){return"[object Array]"===L(a)},IsConstructor:function(a){return"function"==typeof a&&!!a.prototype},IsExtensible:Object.preventExtensions?function(a){return!x(a)&&U(a)}:function(a){return!0},IsInteger:function(a){if("number"!=typeof a||r(a)||!s(a))return!1;var b=R(a);return Q(b)===b},IsPropertyKey:function(a){return"string"==typeof a||"symbol"==typeof a},IsRegExp:function(a){if(!a||"object"!=typeof a)return!1;if(p){var b=a[n.match];if(void 0!==b)return $.ToBoolean(b)}return _(a)},SameValueZero:function(a,b){return a===b||r(a)&&r(b)},GetV:function(a,b){if(!this.IsPropertyKey(b))throw new h("Assertion failed: IsPropertyKey(P) is not true");return this.ToObject(a)[b]},GetMethod:function(a,b){if(!this.IsPropertyKey(b))throw new h("Assertion failed: IsPropertyKey(P) is not true");var c=this.GetV(a,b);if(null!=c){if(!this.IsCallable(c))throw new h(b+"is not a function");return c}},Get:function(a,b){if("Object"!==this.Type(a))throw new h("Assertion failed: Type(O) is not Object");if(!this.IsPropertyKey(b))throw new h("Assertion failed: IsPropertyKey(P) is not true");return a[b]},Type:function(a){return"symbol"==typeof a?"Symbol":$.Type(a)},SpeciesConstructor:function(a,b){if("Object"!==this.Type(a))throw new h("Assertion failed: Type(O) is not Object");var c=a.constructor;if(void 0===c)return b;if("Object"!==this.Type(c))throw new h("O.constructor is not an Object");var d=p&&n.species?c[n.species]:void 0;if(null==d)return b;if(this.IsConstructor(d))return d;throw new h("no constructor found")},CompletePropertyDescriptor:function(a){return q(this,"Property Descriptor","Desc",a),this.IsGenericDescriptor(a)||this.IsDataDescriptor(a)?(d(a,"[[Value]]")||(a["[[Value]]"]=void 0),d(a,"[[Writable]]")||(a["[[Writable]]"]=!1)):(d(a,"[[Get]]")||(a["[[Get]]"]=void 0),d(a,"[[Set]]")||(a["[[Set]]"]=void 0)),d(a,"[[Enumerable]]")||(a["[[Enumerable]]"]=!1),d(a,"[[Configurable]]")||(a["[[Configurable]]"]=!1),a},Set:function(a,b,c,d){if("Object"!==this.Type(a))throw new h("O must be an Object");if(!this.IsPropertyKey(b))throw new h("P must be a Property Key");if("Boolean"!==this.Type(d))throw new h("Throw must be a Boolean");if(d)return a[b]=c,!0;try{a[b]=c}catch(a){return!1}},HasOwnProperty:function(a,b){if("Object"!==this.Type(a))throw new h("O must be an Object");if(!this.IsPropertyKey(b))throw new h("P must be a Property Key");return d(a,b)},HasProperty:function(a,b){if("Object"!==this.Type(a))throw new h("O must be an Object");if(!this.IsPropertyKey(b))throw new h("P must be a Property Key");return b in a},IsConcatSpreadable:function(a){if("Object"!==this.Type(a))return!1;if(p&&"symbol"==typeof n.isConcatSpreadable){var b=this.Get(a,Symbol.isConcatSpreadable);if(void 0!==b)return this.ToBoolean(b)}return this.IsArray(a)},Invoke:function(a,b){if(!this.IsPropertyKey(b))throw new h("P must be a Property Key");var c=A(arguments,2),d=this.GetV(a,b);return this.Call(d,a,c)},GetIterator:function(a,b){if(!p)throw new SyntaxError("ES.GetIterator depends on native iterator support.");var c=b;arguments.length<2&&(c=this.GetMethod(a,n.iterator));var d=this.Call(c,a);if("Object"!==this.Type(d))throw new h("iterator must return an object");return d},IteratorNext:function(a,b){var c=this.Invoke(a,"next",arguments.length<2?[]:[b]);if("Object"!==this.Type(c))throw new h("iterator next must return an object");return c},IteratorComplete:function(a){if("Object"!==this.Type(a))throw new h("Assertion failed: Type(iterResult) is not Object");return this.ToBoolean(this.Get(a,"done"))},IteratorValue:function(a){if("Object"!==this.Type(a))throw new h("Assertion failed: Type(iterResult) is not Object");return this.Get(a,"value")},IteratorStep:function(a){var b=this.IteratorNext(a);return!0!==this.IteratorComplete(b)&&b},IteratorClose:function(a,b){if("Object"!==this.Type(a))throw new h("Assertion failed: Type(iterator) is not Object");if(!this.IsCallable(b))throw new h("Assertion failed: completion is not a thunk for a Completion Record");var c=b,d=this.GetMethod(a,"return");if(void 0===d)return c();var e;try{var f=this.Call(d,a,[])}catch(a){throw e=c(),c=null,a}if(e=c(),c=null,"Object"!==this.Type(f))throw new h("iterator .return must return an object");return e},CreateIterResultObject:function(a,b){if("Boolean"!==this.Type(b))throw new h("Assertion failed: Type(done) is not Boolean");return{value:a,done:b}},RegExpExec:function(a,b){if("Object"!==this.Type(a))throw new h("R must be an Object");if("String"!==this.Type(b))throw new h("S must be a String");var c=this.Get(a,"exec");if(this.IsCallable(c)){var d=this.Call(c,a,[b]);if(null===d||"Object"===this.Type(d))return d;throw new h('"exec" method must return `null` or an Object')}return E(a,b)},ArraySpeciesCreate:function(a,b){if(!this.IsInteger(b)||b<0)throw new h("Assertion failed: length must be an integer >= 0");var c,d=0===b?0:b;if(this.IsArray(a)&&(c=this.Get(a,"constructor"),"Object"===this.Type(c)&&p&&n.species&&null===(c=this.Get(c,n.species))&&(c=void 0)),void 0===c)return j(d);if(!this.IsConstructor(c))throw new h("C must be a constructor");return new c(d)},CreateDataProperty:function(a,b,c){if("Object"!==this.Type(a))throw new h("Assertion failed: Type(O) is not Object");if(!this.IsPropertyKey(b))throw new h("Assertion failed: IsPropertyKey(P) is not true");var d=T(a,b),e=d||"function"!=typeof U||U(a);return!(!(!d||d.writable&&d.configurable)||!e)&&(V(a,b,{configurable:!0,enumerable:!0,value:c,writable:!0}),!0)},CreateDataPropertyOrThrow:function(a,b,c){if("Object"!==this.Type(a))throw new h("Assertion failed: Type(O) is not Object");if(!this.IsPropertyKey(b))throw new h("Assertion failed: IsPropertyKey(P) is not true");var d=this.CreateDataProperty(a,b,c);if(!d)throw new h("unable to create data property");return d},ObjectCreate:function(a,b){if(null!==a&&"Object"!==this.Type(a))throw new h("Assertion failed: proto must be null or an object");if((arguments.length<2?[]:b).length>0)throw new i("es-abstract does not yet support internal slots");if(null===a&&!S)throw new i("native Object.create support is required to create null objects");return S(a)},AdvanceStringIndex:function(a,b,c){if("String"!==this.Type(a))throw new h("S must be a String");if(!this.IsInteger(b)||b<0||b>t)throw new h("Assertion failed: length must be an integer >= 0 and <= 2**53");if("Boolean"!==this.Type(c))throw new h("Assertion failed: unicode must be a Boolean");if(!c)return b+1;if(b+1>=a.length)return b+1;var d=K(a,b);if(d<55296||d>56319)return b+1;var e=K(a,b+1);return e<56320||e>57343?b+1:b+2},CreateMethodProperty:function(a,b,c){if("Object"!==this.Type(a))throw new h("Assertion failed: Type(O) is not Object");if(!this.IsPropertyKey(b))throw new h("Assertion failed: IsPropertyKey(P) is not true");return!!V(a,b,{configurable:!0,enumerable:!1,value:c,writable:!0})},DefinePropertyOrThrow:function(a,b,c){if("Object"!==this.Type(a))throw new h("Assertion failed: Type(O) is not Object");if(!this.IsPropertyKey(b))throw new h("Assertion failed: IsPropertyKey(P) is not true");return!!V(a,b,c)},DeletePropertyOrThrow:function(a,b){if("Object"!==this.Type(a))throw new h("Assertion failed: Type(O) is not Object");if(!this.IsPropertyKey(b))throw new h("Assertion failed: IsPropertyKey(P) is not true");var c=delete a[b];if(!c)throw new TypeError("Attempt to delete property failed.");return c},EnumerableOwnNames:function(a){if("Object"!==this.Type(a))throw new h("Assertion failed: Type(O) is not Object");return f(a)},thisNumberValue:function(a){return"Number"===this.Type(a)?a:M(a)},thisBooleanValue:function(a){return"Boolean"===this.Type(a)?a:N(a)},thisStringValue:function(a){return"String"===this.Type(a)?a:O(a)},thisTimeValue:function(a){return P(a)}});delete aa.CheckObjectCoercible,c.exports=aa}),System.registerDynamic("npm:es-abstract@1.13.0/es2016.js",["./es2015","./helpers/assign"],!0,function(a,b,c){"use strict";var d=(this||self,a("./es2015")),e=a("./helpers/assign"),f=e(e({},d),{SameValueNonNumber:function(a,b){if("number"==typeof a||typeof a!=typeof b)throw new TypeError("SameValueNonNumber requires two non-number values of the same type.");return this.SameValue(a,b)}});c.exports=f}),System.registerDynamic("npm:function-bind@1.1.1/implementation.js",[],!0,function(a,b,c){"use strict";var d=(this||self,Array.prototype.slice),e=Object.prototype.toString;c.exports=function(a){var b=this;if("function"!=typeof b||"[object Function]"!==e.call(b))throw new TypeError("Function.prototype.bind called on incompatible "+b);for(var c,f=d.call(arguments,1),g=function(){if(this instanceof c){var e=b.apply(this,f.concat(d.call(arguments)));return Object(e)===e?e:this}return b.apply(a,f.concat(d.call(arguments)))},h=Math.max(0,b.length-f.length),i=[],j=0;j<h;j++)i.push("$"+j);if(c=Function("binder","return function ("+i.join(",")+"){ return binder.apply(this,arguments); }")(g),b.prototype){var k=function(){};k.prototype=b.prototype,c.prototype=new k,k.prototype=null}return c}}),System.registerDynamic("npm:function-bind@1.1.1.json",[],!0,function(){return{main:"index.js",format:"cjs",meta:{"*.json":{format:"json"}},map:{"./test":"./test/index.js"}}}),System.registerDynamic("npm:function-bind@1.1.1/index.js",["./implementation"],!0,function(a,b,c){"use strict";var d=(this||self,a("./implementation"));c.exports=Function.prototype.bind||d}),System.registerDynamic("npm:es-abstract@1.13.0/helpers/assign.js",["function-bind"],!0,function(a,b,c){var d=(this||self,a("function-bind")),e=d.call(Function.call,Object.prototype.hasOwnProperty),f=Object.assign;c.exports=function(a,b){if(f)return f(a,b);for(var c in b)e(b,c)&&(a[c]=b[c]);return a}}),System.registerDynamic("npm:es-abstract@1.13.0/helpers/forEach.js",[],!0,function(a,b,c){"use strict";this||self;c.exports=function(a,b){for(var c=0;c<a.length;c+=1)b(a[c],c,a)}}),System.registerDynamic("npm:es-abstract@1.13.0/GetIntrinsic.js",[],!0,function(a,b,c){"use strict";var d,e,f,g,h=(this||self,Object.getOwnPropertyDescriptor?function(){return Object.getOwnPropertyDescriptor(arguments,"callee").get}():function(){throw new TypeError}),i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator,j=Object.getPrototypeOf||function(a){return a.__proto__},k=e?j(e):d,l=f?f.constructor:d,m=g?j(g):d,n=g?g():d,o="undefined"==typeof Uint8Array?d:j(Uint8Array),p={"$ %Array%":Array,"$ %ArrayBuffer%":"undefined"==typeof ArrayBuffer?d:ArrayBuffer,"$ %ArrayBufferPrototype%":"undefined"==typeof ArrayBuffer?d:ArrayBuffer.prototype,"$ %ArrayIteratorPrototype%":i?j([][Symbol.iterator]()):d,"$ %ArrayPrototype%":Array.prototype,"$ %ArrayProto_entries%":Array.prototype.entries,"$ %ArrayProto_forEach%":Array.prototype.forEach,"$ %ArrayProto_keys%":Array.prototype.keys,"$ %ArrayProto_values%":Array.prototype.values,"$ %AsyncFromSyncIteratorPrototype%":d,"$ %AsyncFunction%":l,"$ %AsyncFunctionPrototype%":l?l.prototype:d,"$ %AsyncGenerator%":g?j(n):d,"$ %AsyncGeneratorFunction%":m,"$ %AsyncGeneratorPrototype%":m?m.prototype:d,"$ %AsyncIteratorPrototype%":n&&i&&Symbol.asyncIterator?n[Symbol.asyncIterator]():d,"$ %Atomics%":"undefined"==typeof Atomics?d:Atomics,"$ %Boolean%":Boolean,"$ %BooleanPrototype%":Boolean.prototype,"$ %DataView%":"undefined"==typeof DataView?d:DataView,"$ %DataViewPrototype%":"undefined"==typeof DataView?d:DataView.prototype,"$ %Date%":Date,"$ %DatePrototype%":Date.prototype,"$ %decodeURI%":decodeURI,"$ %decodeURIComponent%":decodeURIComponent,"$ %encodeURI%":encodeURI,"$ %encodeURIComponent%":encodeURIComponent,"$ %Error%":Error,"$ %ErrorPrototype%":Error.prototype,"$ %eval%":eval,"$ %EvalError%":EvalError,"$ %EvalErrorPrototype%":EvalError.prototype,"$ %Float32Array%":"undefined"==typeof Float32Array?d:Float32Array,"$ %Float32ArrayPrototype%":"undefined"==typeof Float32Array?d:Float32Array.prototype,"$ %Float64Array%":"undefined"==typeof Float64Array?d:Float64Array,"$ %Float64ArrayPrototype%":"undefined"==typeof Float64Array?d:Float64Array.prototype,"$ %Function%":Function,"$ %FunctionPrototype%":Function.prototype,"$ %Generator%":e?j(e()):d,"$ %GeneratorFunction%":k,"$ %GeneratorPrototype%":k?k.prototype:d,"$ %Int8Array%":"undefined"==typeof Int8Array?d:Int8Array,"$ %Int8ArrayPrototype%":"undefined"==typeof Int8Array?d:Int8Array.prototype,"$ %Int16Array%":"undefined"==typeof Int16Array?d:Int16Array,"$ %Int16ArrayPrototype%":"undefined"==typeof Int16Array?d:Int8Array.prototype,"$ %Int32Array%":"undefined"==typeof Int32Array?d:Int32Array,"$ %Int32ArrayPrototype%":"undefined"==typeof Int32Array?d:Int32Array.prototype,"$ %isFinite%":isFinite,"$ %isNaN%":isNaN,"$ %IteratorPrototype%":i?j(j([][Symbol.iterator]())):d,"$ %JSON%":JSON,"$ %JSONParse%":JSON.parse,"$ %Map%":"undefined"==typeof Map?d:Map,"$ %MapIteratorPrototype%":"undefined"!=typeof Map&&i?j((new Map)[Symbol.iterator]()):d,"$ %MapPrototype%":"undefined"==typeof Map?d:Map.prototype,"$ %Math%":Math,"$ %Number%":Number,"$ %NumberPrototype%":Number.prototype,"$ %Object%":Object,"$ %ObjectPrototype%":Object.prototype,"$ %ObjProto_toString%":Object.prototype.toString,"$ %ObjProto_valueOf%":Object.prototype.valueOf,"$ %parseFloat%":parseFloat,"$ %parseInt%":parseInt,"$ %Promise%":"undefined"==typeof Promise?d:Promise,"$ %PromisePrototype%":"undefined"==typeof Promise?d:Promise.prototype,"$ %PromiseProto_then%":"undefined"==typeof Promise?d:Promise.prototype.then,"$ %Promise_all%":"undefined"==typeof Promise?d:Promise.all,"$ %Promise_reject%":"undefined"==typeof Promise?d:Promise.reject,"$ %Promise_resolve%":"undefined"==typeof Promise?d:Promise.resolve,"$ %Proxy%":"undefined"==typeof Proxy?d:Proxy,"$ %RangeError%":RangeError,"$ %RangeErrorPrototype%":RangeError.prototype,"$ %ReferenceError%":ReferenceError,"$ %ReferenceErrorPrototype%":ReferenceError.prototype,"$ %Reflect%":"undefined"==typeof Reflect?d:Reflect,"$ %RegExp%":RegExp,"$ %RegExpPrototype%":RegExp.prototype,"$ %Set%":"undefined"==typeof Set?d:Set,"$ %SetIteratorPrototype%":"undefined"!=typeof Set&&i?j((new Set)[Symbol.iterator]()):d,"$ %SetPrototype%":"undefined"==typeof Set?d:Set.prototype,"$ %SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?d:SharedArrayBuffer,"$ %SharedArrayBufferPrototype%":"undefined"==typeof SharedArrayBuffer?d:SharedArrayBuffer.prototype,"$ %String%":String,"$ %StringIteratorPrototype%":i?j(""[Symbol.iterator]()):d,"$ %StringPrototype%":String.prototype,"$ %Symbol%":i?Symbol:d,"$ %SymbolPrototype%":i?Symbol.prototype:d,"$ %SyntaxError%":SyntaxError,"$ %SyntaxErrorPrototype%":SyntaxError.prototype,"$ %ThrowTypeError%":h,"$ %TypedArray%":o,"$ %TypedArrayPrototype%":o?o.prototype:d,"$ %TypeError%":TypeError,"$ %TypeErrorPrototype%":TypeError.prototype,"$ %Uint8Array%":"undefined"==typeof Uint8Array?d:Uint8Array,"$ %Uint8ArrayPrototype%":"undefined"==typeof Uint8Array?d:Uint8Array.prototype,"$ %Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?d:Uint8ClampedArray,"$ %Uint8ClampedArrayPrototype%":"undefined"==typeof Uint8ClampedArray?d:Uint8ClampedArray.prototype,"$ %Uint16Array%":"undefined"==typeof Uint16Array?d:Uint16Array,"$ %Uint16ArrayPrototype%":"undefined"==typeof Uint16Array?d:Uint16Array.prototype,"$ %Uint32Array%":"undefined"==typeof Uint32Array?d:Uint32Array,"$ %Uint32ArrayPrototype%":"undefined"==typeof Uint32Array?d:Uint32Array.prototype,"$ %URIError%":URIError,"$ %URIErrorPrototype%":URIError.prototype,"$ %WeakMap%":"undefined"==typeof WeakMap?d:WeakMap,"$ %WeakMapPrototype%":"undefined"==typeof WeakMap?d:WeakMap.prototype,"$ %WeakSet%":"undefined"==typeof WeakSet?d:WeakSet,"$ %WeakSetPrototype%":"undefined"==typeof WeakSet?d:WeakSet.prototype};c.exports=function(a,b){if(arguments.length>1&&"boolean"!=typeof b)throw new TypeError('"allowMissing" argument must be a boolean');var c="$ "+a;if(!(c in p))throw new SyntaxError("intrinsic "+a+" does not exist!");if(void 0===p[c]&&!b)throw new TypeError("intrinsic "+a+" exists, but is not available. Please file an issue!");return p[c]}}),System.registerDynamic("npm:es-abstract@1.13.0.json",[],!0,function(){return{main:"index.js",format:"cjs",meta:{"*.json":{format:"json"}},map:{"./test":"./test/index.js"}}}),System.registerDynamic("npm:es-abstract@1.13.0/es2017.js",["function-bind","./es2016","./helpers/assign","./helpers/forEach","./GetIntrinsic"],!0,function(a,b,c){"use strict";var d=(this||self,a("function-bind")),e=a("./es2016"),f=a("./helpers/assign"),g=a("./helpers/forEach"),h=a("./GetIntrinsic"),i=h("%TypeError%"),j=d.call(Function.call,h("%ObjectPrototype%").propertyIsEnumerable),k=d.call(Function.apply,h("%ArrayPrototype%").push),l=f(f({},e),{ToIndex:function(a){if(void 0===a)return 0;var b=this.ToInteger(a);if(b<0)throw new RangeError("index must be >= 0");var c=this.ToLength(b);if(!this.SameValueZero(b,c))throw new RangeError("index must be >= 0 and < 2 ** 53 - 1");return c},EnumerableOwnProperties:function(a,b){var c=e.EnumerableOwnNames(a);if("key"===b)return c;if("value"===b||"key+value"===b){var d=[];return g(c,function(c){j(a,c)&&k(d,["value"===b?a[c]:[c,a[c]]])}),d}throw new i('Assertion failed: "kind" is not "key", "value", or "key+value": '+b)}});delete l.EnumerableOwnNames,c.exports=l}),System.registerDynamic("npm:object.fromentries@2.0.0/implementation.js",["es-abstract/es2017"],!0,function(a,b,c){"use strict";var d=(this||self,a("es-abstract/es2017")),e=function(a){throw a},f=function(a,b){for(var c=0;c<b.length;++c){var e=b[c];if("Object"!==d.Type(e))throw new TypeError("iterator returned a non-object; entry expected");var f=d.Get(e,"0"),g=d.Get(e,"1"),h=d.ToPropertyKey(f);d.CreateDataPropertyOrThrow(a,h,g)}},g="function"==typeof Symbol&&"symbol"==typeof Symbol("foo");c.exports=function(a){d.RequireObjectCoercible(a);var b={};if(!g){if(!d.IsArray(a))throw new TypeError("this environment lacks native Symbols, and can not support non-Array iterables");return f(b,a),b}for(var c=d.GetIterator(a);;){var h=d.IteratorStep(c);if(!1===h)return b;var i=d.IteratorValue(h);if("Object"!==d.Type(i)){var j=new TypeError("iterator returned a non-object; entry expected");return d.IteratorClose(c,e(j))}try{var k=d.Get(i,"0"),l=d.Get(i,"1"),m=d.ToPropertyKey(k);d.CreateDataPropertyOrThrow(b,m,l)}catch(a){return d.IteratorClose(c,e(a))}}}}),System.registerDynamic("npm:object.fromentries@2.0.0/polyfill.js",["./implementation"],!0,function(a,b,c){"use strict";var d=(this||self,a("./implementation"));c.exports=function(){return"function"==typeof Object.fromEntries?Object.fromEntries:d}}),System.registerDynamic("npm:object-keys@1.1.1/isArguments.js",[],!0,function(a,b,c){"use strict";var d=(this||self,Object.prototype.toString);c.exports=function(a){var b=d.call(a),c="[object Arguments]"===b;return c||(c="[object Array]"!==b&&null!==a&&"object"==typeof a&&"number"==typeof a.length&&a.length>=0&&"[object Function]"===d.call(a.callee)),c}}),System.registerDynamic("npm:object-keys@1.1.1/implementation.js",["./isArguments"],!0,function(a,b,c){"use strict";var d;this||self;if(!Object.keys){var e=Object.prototype.hasOwnProperty,f=Object.prototype.toString,g=a("./isArguments"),h=Object.prototype.propertyIsEnumerable,i=!h.call({toString:null},"toString"),j=h.call(function(){},"prototype"),k=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],l=function(a){var b=a.constructor;return b&&b.prototype===a},m={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},n=function(){if("undefined"==typeof window)return!1;for(var a in window)try{if(!m["$"+a]&&e.call(window,a)&&null!==window[a]&&"object"==typeof window[a])try{l(window[a])}catch(a){return!0}}catch(a){return!0}return!1}(),o=function(a){if("undefined"==typeof window||!n)return l(a);try{return l(a)}catch(a){return!1}};d=function(a){var b=null!==a&&"object"==typeof a,c="[object Function]"===f.call(a),d=g(a),h=b&&"[object String]"===f.call(a),l=[];if(!b&&!c&&!d)throw new TypeError("Object.keys called on a non-object");var m=j&&c;if(h&&a.length>0&&!e.call(a,0))for(var n=0;n<a.length;++n)l.push(String(n));if(d&&a.length>0)for(var p=0;p<a.length;++p)l.push(String(p));else for(var q in a)m&&"prototype"===q||!e.call(a,q)||l.push(String(q));if(i)for(var r=o(a),s=0;s<k.length;++s)r&&"constructor"===k[s]||!e.call(a,k[s])||l.push(k[s]);return l}}c.exports=d}),System.registerDynamic("npm:object-keys@1.1.1.json",[],!0,function(){return{main:"index.js",format:"cjs",meta:{"*.json":{format:"json"}},map:{"./test":"./test/index.js"}}}),System.registerDynamic("npm:object-keys@1.1.1/index.js",["./isArguments","./implementation"],!0,function(a,b,c){"use strict";var d=(this||self,Array.prototype.slice),e=a("./isArguments"),f=Object.keys,g=f?function(a){return f(a)}:a("./implementation"),h=Object.keys;g.shim=function(){if(Object.keys){(function(){var a=Object.keys(arguments);return a&&a.length===arguments.length})(1,2)||(Object.keys=function(a){return h(e(a)?d.call(a):a)})}else Object.keys=g;return Object.keys||g},c.exports=g}),System.registerDynamic("npm:define-properties@1.1.3.json",[],!0,function(){return{main:"index.js",format:"cjs",meta:{"*.json":{format:"json"}},map:{"./test":"./test/index.js"}}}),System.registerDynamic("npm:define-properties@1.1.3/index.js",["object-keys"],!0,function(a,b,c){"use strict";var d=(this||self,a("object-keys")),e="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),f=Object.prototype.toString,g=Array.prototype.concat,h=Object.defineProperty,i=function(a){return"function"==typeof a&&"[object Function]"===f.call(a)},j=function(){var a={};try{h(a,"x",{enumerable:!1,value:a});for(var b in a)return!1;return a.x===a}catch(a){return!1}},k=h&&j(),l=function(a,b,c,d){(!(b in a)||i(d)&&d())&&(k?h(a,b,{configurable:!0,enumerable:!1,value:c,writable:!0}):a[b]=c)},m=function(a,b){var c=arguments.length>2?arguments[2]:{},f=d(b);e&&(f=g.call(f,Object.getOwnPropertySymbols(b)));for(var h=0;h<f.length;h+=1)l(a,f[h],b[f[h]],c[f[h]])};m.supportsDescriptors=!!k,c.exports=m}),System.registerDynamic("npm:object.fromentries@2.0.0/shim.js",["./polyfill","define-properties"],!0,function(a,b,c){"use strict";var d=(this||self,a("./polyfill")),e=a("define-properties");c.exports=function(){var a=d();return e(Object,{fromEntries:a},{fromEntries:function(){return Object.fromEntries!==a}}),a}}),System.registerDynamic("npm:object.fromentries@2.0.0.json",[],!0,function(){return{main:"index.js",format:"cjs",meta:{"*.json":{format:"json"}},map:{"./test":"./test/index.js"}}}),System.registerDynamic("npm:object.fromentries@2.0.0/index.js",["define-properties","./implementation","./polyfill","./shim"],!0,function(a,b,c){"use strict";var d=(this||self,a("define-properties")),e=a("./implementation"),f=a("./polyfill"),g=a("./shim"),h=f();d(h,{getPolyfill:f,implementation:e,shim:g}),c.exports=h}),System.register("theatlantic/js/paywall/utils/nudgeSequence.js",[],function(a,b){"use strict";function c(a,b){return 1===a?d.initial:b-a==1?d.penultimate:a<b?d.mid:d.last}var d;return a("default",c),{setters:[],execute:function(){d={initial:{compressedElem:"nudge-compressed",expandedElem:"nudge-expanded",message:"Thank you for reading The Atlantic.",subheader:"Enjoy unlimited access for less than $1 per week.",messageCompressed:"Enjoy unlimited access to The Atlantic for less than $1 per week.",buttonCentered:!0,countNotice:"more free articles this month",countNoticeMobile:"Thank you for reading The Atlantic."},mid:{compressedElem:"nudge-compressed",expandedElem:"nudge-expanded",message:"Discover new ideas. Rethink old assumptions.",subheader:"Get unlimited access to The Atlantic for less than $1 per week.",messageCompressed:"more free articles this month",countNotice:"more free articles this month",countNoticeMobile:"more free articles"},penultimate:{compressedElem:"nudge-compressed",expandedElem:"nudge-expanded",message:"Discover new ideas. Rethink old assumptions.",subheader:"Get unlimited access to The Atlantic for less than $1 per week.",messageCompressed:"more free article this month",countNotice:"more free article this month",countNoticeMobile:"more free article"},last:{compressedElem:"nudge-compressed",expandedElem:"nudge-expanded",message:"Never miss a story from The Atlantic.",subheader:"Get unlimited access for less than $1 per week.",subheaderMobile:"Never miss a story. Get unlimited access.",messageCompressed:"This is your last free article.",countNotice:"This is your last free article.",countNoticeMobile:"This is your last free article."}}}}}),System.register("theatlantic/js/paywall/paywall.js",["pageInfo","./utils/Meter","./utils/Intervention","./nudge","./gate","./meter","./non-metered-nudge","fromEntries","./utils/nudgeSequence","../utils/user"],function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;return{setters:[function(a){c=a},function(a){d=a.default},function(a){e=a.default},function(a){f=a.default},function(a){g=a.default},function(a){h=a.default},function(a){i=a.renderNonMeteredNudge},function(a){j=a.default},function(a){k=a.default},function(a){l=a.hasPaymeterAccess}],execute:function(){j.shim(),m=3,a("meter",n=new d({cap:m,identifier:c.article_id,cookieName:"articleViews"})),a("meter",n),a("nudge",o=new e(f,k(n.getPageViews(),n.getCap()))),a("nudge",o),a("gate",p=new e(g,{mobileSubtitle:"We hope you've enjoyed your free articles.",mobileTitle:"Don't miss another story. Become a subscriber today.",title:"We hope you've enjoyed your free articles. To keep reading, subscribe today.",mobileTitleBelow:"Options starting at less than $1 per week."})),a("gate",p),n.on("pageview",h),q=new URLSearchParams(window.location.search),l()||("meter_limit_reached"===q.get("surface")?n.on("pageview",p.render):c.show_nudges&&(n.getPageViews()<=n.getCap()&&n.on("pageview",o.render),n.on("cap-hit",p.render))),c.has_meter&&n.enable(),c.has_meter||l()||"Newsletters"===c.title||i()}}}),System.register("theatlantic/js/paywall/meter.js",["../globals/dataLayer"],function(a,b){"use strict";function c(a){var b=a.cap,c=a.viewCount,e={paywallCap:b,paywallViews:c};d.push(e)}var d;return a("default",c),{setters:[function(a){d=a.default}],execute:function(){}}}),System.register("theatlantic/js/components/breaking-news.js",[],function(a,b){"use strict";function c(){e.classList.add("is-hidden"),sessionStorage.setItem("disable_breaking_news",i)}var d,e,f,g,h,i;return{setters:[],execute:function(){d="atl:breaking-news",performance.mark(d+"_loaded"),e=document.querySelector(".c-alert"),f=document.querySelector(".js-close-alert"),g=sessionStorage.getItem("disable_breaking_news"),h=document.querySelector(".c-alert__section--body"),i=h?h.textContent.trim():null,!e||g&&g===i||(e.classList.remove("is-hidden"),f.addEventListener("click",c))}}}),System.register("theatlantic/scss/components/footer.scss",[],function(){return{setters:[],execute:function(){}}}),System.registerDynamic("github:systemjs/plugin-json@0.3.0.json",[],!0,function(){return{main:"json"}}),System.register("theatlantic/js/constants/breakpoints.json!github:systemjs/plugin-json@0.3.0/json.js",[],function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m;return{setters:[],execute:function(){a("__useDefault",c=!0),a("__useDefault",c),a("xxsmall",d="(max-width: 374px)"),a("xxsmall",d),a("xsmall",e="(max-width: 575px)"),a("xsmall",e),a("small",f="(min-width: 576px)"),a("small",f),a("medium",g="(min-width: 784px)"),a("medium",g),a("large",h="(min-width: 976px)"),a("large",h),a("xlarge",i="(min-width: 1200px)"),a("xlarge",i),a("xxlarge",j="(min-width: 1376px)"),a("xxlarge",j),a("standard",k="(min-resolution: 1dppx)"),a("standard",k),a("hd",l="(min-resolution: 1.5dppx)"),a("hd",l),a("retina",m="(min-resolution: 2dppx)"),a("retina",m),a("default",{xxsmall:d,xsmall:e,small:f,medium:g,large:h,xlarge:i,xxlarge:j,"hp-mid":"(min-width: 1100px)",standard:k,hd:l,retina:m,"legacy-large":"(min-width: 1010px)"})}}}),System.register("theatlantic/js/lacroix/components/footer.js",["npm:systemjs-plugin-babel@0.0.25/babel-helpers/toConsumableArray.js","js-cookie","theatlantic/scss/components/footer.scss","../../constants/breakpoints.json!","../../constants/cookie"],function(a,b){"use strict";function c(){window.matchMedia(h.medium).matches||this.classList.toggle("is-open")}function d(){g.set(i,!0,{expires:30})}function e(){g.remove(i)}var f,g,h,i,j,k,l,m;return{setters:[function(a){f=a.default},function(a){g=a.default},function(a){},function(a){h=a.default},function(a){i=a.preferHpUS}],execute:function(){j="atl:footer",performance.mark(j+"_loaded"),k=[].concat(f(document.querySelectorAll(".c-footer__section-title"))),k.map(function(a){return a.addEventListener("click",c)}),l=document.querySelector(".js-prefer-hp--us"),m=document.querySelector(".js-prefer-hp--world"),l&&l.addEventListener("click",d),m&&m.addEventListener("click",e)}}}),System.registerDynamic("theatlantic/templates/hippo/components/input.html",[],!0,function(a,b,c){var d=this||self,e=d.nunjucksPrecompiled=d.nunjucksPrecompiled||{},f=function(){function a(a,b,c,d,e){var f="";try{var g=null;d.contextOrFrameLookup(b,c,"label")&&(f+="\n<label\n  ",d.contextOrFrameLookup(b,c,"hide_label")&&(f+='\n    class="u-element-invisible"\n  '),f+="\n\n  ",d.contextOrFrameLookup(b,c,"id")&&(f+='\n    for="',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"id"),a.opts.autoescape),f+='"\n  '),f+="\n>\n  ",f+=d.suppressValue(d.contextOrFrameLookup(b,c,"label"),a.opts.autoescape),f+="\n\n  ",d.contextOrFrameLookup(b,c,"required")&&(f+="\n    <span>(required)</span>\n  "),f+="\n</label>\n"),f+='\n\n<input\n  class="c-input c-input--',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"type"),a.opts.autoescape),f+=" ",f+=d.suppressValue(d.contextOrFrameLookup(b,c,"modifier_class"),a.opts.autoescape),f+='"\n\n  type="',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"type"),a.opts.autoescape),f+='"\n\n  ',d.contextOrFrameLookup(b,c,"id")&&(f+='\n    id="',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"id"),a.opts.autoescape),f+='"\n  '),f+="\n\n  ",d.contextOrFrameLookup(b,c,"name")&&(f+='\n    name="',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"name"),a.opts.autoescape),f+='"\n  '),f+="\n\n  ",d.contextOrFrameLookup(b,c,"placeholder")&&(f+='\n    placeholder="',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"placeholder"),a.opts.autoescape),f+='"\n  '),f+="\n\n  ",d.contextOrFrameLookup(b,c,"autocomplete")&&(f+='\n    autocomplete="',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"autocomplete"),a.opts.autoescape),f+='"\n  '),f+="\n\n  ",d.contextOrFrameLookup(b,c,"value")&&(f+='\n    value="',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"value"),a.opts.autoescape),f+='"\n  '),f+="\n\n  ",d.contextOrFrameLookup(b,c,"pattern")&&(f+='\n    pattern="',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"pattern"),a.opts.autoescape),f+='"\n  '),f+="\n\n  ",d.contextOrFrameLookup(b,c,"attrs")&&(f+="\n    ",f+=d.suppressValue(d.contextOrFrameLookup(b,c,"attrs"),a.opts.autoescape),f+="\n  "),f+="\n\n  ",d.contextOrFrameLookup(b,c,"helper_text")&&d.contextOrFrameLookup(b,c,"id")&&(f+='\n    aria-describedby="',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"id"),a.opts.autoescape),f+='-helper"\n  '),f+="\n\n  ",d.contextOrFrameLookup(b,c,"required")&&(f+="\n    required\n  "),f+="\n\n  ",d.contextOrFrameLookup(b,c,"title")&&(f+='\n    title="',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"title"),a.opts.autoescape),f+='"\n  '),f+="\n\n  ",d.contextOrFrameLookup(b,c,"tabindex")&&(f+='\n    tabindex="',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"tabindex"),a.opts.autoescape),f+='"\n  '),f+="\n/>\n\n",d.contextOrFrameLookup(b,c,"helper_text")&&(f+='\n  <small class="c-helper-text"',d.contextOrFrameLookup(b,c,"id")&&(f+=' id="',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"id"),a.opts.autoescape),f+='-helper"'),f+=">",f+=d.suppressValue(d.contextOrFrameLookup(b,c,"helper_text"),a.opts.autoescape),f+="</small>\n"),f+="\n\n",d.contextOrFrameLookup(b,c,"valid_text")&&(f+='\n  <small class="c-feedback c-feedback--valid">',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"valid_text"),a.opts.autoescape),f+="</small>\n"),f+="\n\n",d.contextOrFrameLookup(b,c,"invalid_text")&&(f+='\n  <small class="c-feedback c-feedback--invalid">',f+=d.suppressValue(d.contextOrFrameLookup(b,c,"invalid_text"),a.opts.autoescape),f+="</small>\n"),f+="\n\n",d.contextOrFrameLookup(b,c,"dynamic_text")&&(f+='\n  <small class="c-feedback js-feedback"></small>\n'),f+="\n",g?g.rootRenderFunc(a,b,c,d,e):e(null,f)}catch(a){e(d.handleError(a,null,null))}}return{root:a}}();e["hippo/components/input.html"]=f,c.exports=f}),System.registerDynamic("theatlantic/templates/hippo/components/leaflet.html",[],!0,function(a,b,c){var d=this||self,e=d.nunjucksPrecompiled=d.nunjucksPrecompiled||{},f=function(){function a(a,b,c,d,e){var f=null,g=null,h="";try{var i=null;h+='\n<section class="c-leaflets">\n  <div class="c-leaflets__container">\n    <div class="c-leaflet">\n      <div class="c-leaflet__content c-leaflet__content--sign-up">\n          <p class="c-leaflet__title c-leaflet__title--sign-up">Make your inbox more interesting.</p>\n          <p class="c-leaflet__description c-leaflet__description--sign-up">Each weekday evening, get an overview of the days biggest news, along with fascinating ideas, images, and people. <a class="c-leaflet__description c-leaflet__link--newsletters" href="https://www.theatlantic.com/follow-the-atlantic/">See more newsletters</a></p>\n        <form class="l-form l-form--inline c-leaflet__form" id="leaflet-newsletter-form">\n          ',h+=d.suppressValue((f=11,g=20,d.callWrap(d.contextOrFrameLookup(b,c,"component"),"component",b,["hippo/components/input.html",d.makeKeywordArgs({type:"hidden",name:"newsletters",value:"7581216",title:"The Atlantic Daily"})])),a.opts.autoescape),h+="\n          ",h+=d.suppressValue((f=17,g=20,d.callWrap(d.contextOrFrameLookup(b,c,"component"),"component",b,["hippo/components/input.html",d.makeKeywordArgs({placeholder:"Enter your email",type:"email",name:"email",modifier_class:"c-leaflet__input js-form-input",autocomplete:!0,required:!0})])),a.opts.autoescape),h+='\n          <button class="c-btn c-btn--black c-leaflet__btn js-form-submit" type="submit">\n            Sign Up <span class="c-leaflet__submit-loader"></span>\n          </button>\n        </form>\n        <small class="c-feedback c-leaflet__feedback js-email-feedback"></small>\n      </div>\n      <div class="c-leaflet__confirmation js-confirmation">\n        <svg class="c-leaflet__checkmark" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n          <path fill="#038768" fill-rule="evenodd" d="M12 24C5.373 24 0 18.627 0 12S5.373 0 12 0s12 5.373 12 12-5.373 12-12 12zm5.783-16.343L16.73 6.283A.674.674 0 0 0 16.204 6a.674.674 0 0 0-.527.283L10.6 12.919 8.323 9.94a.674.674 0 0 0-.527-.282.674.674 0 0 0-.526.282l-1.053 1.374A1.15 1.15 0 0 0 6 12c0 .253.077.505.217.687l2.802 3.656 1.053 1.374c.14.182.333.283.527.283a.674.674 0 0 0 .526-.283l1.053-1.374 5.605-7.313A1.15 1.15 0 0 0 18 8.343a1.15 1.15 0 0 0-.217-.686z"/>\n        </svg>\n        <p class="c-leaflet__confirmation-title">Thanks for signing up!</p>\n        <div class="js-confirmation-message">\n          ',h+='\n          <br>\n          <a class="c-leaflet__link c-leaflet__link--newsletters" href="/newsletters/sign-up/">See more newsletters</a>\n        </div>\n      </div>\n    </div>\n    <div class="c-leaflet">\n      <div class="c-leaflet__content c-leaflet__content--subscribe">\n          <p class="c-leaflet__title">Ideas that matter. Since 1857.</p>\n          <p class="c-leaflet__description">Subscribe and support 162 years of independent journalism. For less than $1 a week.</p>\n          <p class="c-leaflet__subscribe">\n            <a class="c-leaflet__link c-leaflet__link--subscribe" href="https://www.theatlantic.com/subscribe/footer-beta/">Subscribe</a>\n          </p>\n      </div>\n      <div class="c-leaflet__content c-leaflet__content--image">\n        <figure class="o-media c-leaflet__frame">\n          <img\n            class="c-leaflet__image lazyload"\n            src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="\n            alt="The cover of the current issue of The Atlantic"\n            data-src="https://www.theatlantic.com/magazine/images/current-issue.large.jpg"\n          >\n        </figure>\n      </div>\n    </div>\n  </div>\n</section>\n',i?i.rootRenderFunc(a,b,c,d,e):e(null,h)}catch(a){e(d.handleError(a,f,g))}}return{root:a}}();e["hippo/components/leaflet.html"]=f,c.exports=f}),System.registerDynamic("github:fdintino/plugin-sass@0.7.0.json",[],!0,function(){return{main:"index.js"}}),System.register("theatlantic/scss/components/leaflet.scss",[],function(){return{setters:[],execute:function(){}}}),System.register("theatlantic/js/utils/newsletter.js",["npm:systemjs-plugin-babel@0.0.25/babel-helpers/toConsumableArray.js","pageInfo","../constants/endpoints","./events","./log"],function(a,b){"use strict";function c(a){m("beforeSend"),a.querySelector(".js-form-submit").setAttribute("disabled",!0),a.classList.add("is-submitting")}function d(a,b,c){m("afterSend",a);var d=a.success,e=a.existing_user,g=a.error,h=b.parentNode,i="An unknown error occurred.";if(c.classList.remove("is-submitting"),c.classList.add("was-validated"),d)return b.querySelector(".js-confirmation-message").insertAdjacentHTML("afterbegin",e?"Your newsletter subscription preferences have been updated.":"Please check your email to confirm your subscription."),h.classList.add("is-successful"),void f(c);var j=c.querySelector(".js-form-submit"),k=c.querySelector(".js-form-input");j.removeAttribute("disabled"),k.classList.add("is-invalid"),h.classList.add("is-failure");var l=h.querySelector(".js-email-feedback");l.classList.add("c-feedback--invalid"),l.innerHTML=g||i}function e(a){if(!a)return Promise.reject(new Error("`subscribe` requires a form element"));var b=new FormData(a),c={method:"POST",credentials:"include",body:b};return fetch(i,c).then(function(a){return a.json()}).catch(function(a){return m.error(a),{success:!1,error:"A server error occurred.",user:null}})}function f(a){var b=a.querySelectorAll('[name="newsletters"]'),c=a.querySelector('[name="email"]');[].concat(g(b)).filter(function(a){return!a.disabled}).map(function(b){var d={email:c.value,newsletter:b.value,newsletterName:b.title,id:a.id,pagemodule:a.id+" / "+h+" - sign up for "+b.title};j(window,"newsletter:signup",{detail:d})})}var g,h,i,j,k,l,m;return a("beforeSend",c),a("afterSend",d),a("subscribe",e),a("track",f),{setters:[function(a){g=a.default},function(a){h=a.view},function(a){i=a.newsletterSignUp},function(a){j=a.dataEvent},function(a){k=a.Log}],execute:function(){l="atl:newsletter",m=k(l)}}}),System.register("theatlantic/js/components/leaflet.js",["npm:systemjs-plugin-babel@0.0.25/regenerator-runtime.js","npm:systemjs-plugin-babel@0.0.25/babel-helpers/asyncToGenerator.js","hippo/components/input","hippo/components/leaflet","theatlantic/scss/components/leaflet.scss","../utils/log","../utils/newsletter","../utils/nunjucks"],function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l;return{setters:[function(a){c=a.default},function(a){d=a.default},function(a){},function(a){},function(a){},function(a){e=a.Log},function(a){f=a.beforeSend,g=a.subscribe,h=a.afterSend},function(a){i=a.render}],execute:function(){j="atl:leaflet",k=e(j),performance.mark(j+"_loaded"),a("lazyload",l=function(){var a=d(c.mark(function a(b){var e,l,m,n,o,p=this;return c.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return performance.mark(j+"_lazyloaded"),e=b.target,l={},a.prev=3,a.next=6,i("leaflet",l);case 6:e.innerHTML=a.sent,e.classList.add("is-rendered"),performance.mark(j+"_rendered"),m=e.querySelector("form"),n=m.querySelector(".js-form-submit"),o=e.querySelector(".js-confirmation"),n.addEventListener("click",function(){var a=d(c.mark(function a(b){var d;return c.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return b.preventDefault(),f(m),a.next=4,g(m);case 4:d=a.sent,h(d,o,m);case 6:case"end":return a.stop()}},a,p)}));return function(b){return a.apply(this,arguments)}}()),a.next=19;break;case 15:a.prev=15,a.t0=a.catch(3),k.error(a.t0),e.innerHTML="";case 19:case"end":return a.stop()}},a,this,[[3,15]])}));return function(b){return a.apply(this,arguments)}}()),a("lazyload",l)}}}),System.register("theatlantic/js/components/navigation/registration.js",["npm:systemjs-plugin-babel@0.0.25/babel-helpers/toConsumableArray.js","../../utils/user"],function(a,b){"use strict";function c(){var a=f(),b=g(),c="none",e="inline";if(a){var h=document.querySelector(".captureProfileLink");h&&(h.textContent=b+"s Account"),c="inline",e="none"}j.map(function(a){return a.style.display=c}),k.map(function(a){return a.style.display=e}),l.map(function(a){return a.style.display="none"}),m&&d(a)}function d(){var a=f(),b=[].concat(e(document.querySelectorAll(".c-nav__title"))),c=i();a?-1!==c.indexOf("paymeter_access")?(b.map(function(a){a.innerText="Give a Gift"}),o(n.subscribed,!0)):o(n.notSubscribed):o(n.notSignedIn)}var e,f,g,h,i,j,k,l,m,n,o,p;return{setters:[function(a){e=a.default},function(a){f=a.isLoggedIn,g=a.getFirstName,h=a.signOut,i=a.getEntitlementsList}],execute:function(){j=[].concat(e(document.querySelectorAll(".signed-in-utils"))),k=[].concat(e(document.querySelectorAll(".signed-out-utils"))),l=[].concat(e(document.querySelectorAll(".signed-inoutloading-utils"))),m=document.getElementsByClassName("js-subscribe-button"),m=Array.from(m),n={notSignedIn:"https://www.theatlantic.com/locator/nav-new-sub/",notSubscribed:"https://www.theatlantic.com/locator/nav-new-sub/",subscribed:"https://www.theatlantic.com/locator/nav-subscriber-gift/"},o=function(a,b){m.map(function(c){c.href=a,b&&c.setAttribute("data-name","nav:give-a-gift-button")})},p=document.querySelector(".captureSignOutLink"),p&&p.addEventListener("click",function(a){a.stopPropagation(),h().then(c)}),a("handleUserState",c)}}}),System.register("theatlantic/js/utils/helpers.js",[],function(a,b){"use strict";function c(a,b,c){var d=function b(d){return a.removeEventListener(d.type,b),c.call(a,d)};a&&a.addEventListener(b,d)}var d;return a("once",c),{setters:[],execute:function(){d="atl:helpers",performance.mark(d+"_loaded")}}}),System.register("theatlantic/js/components/navigation/search.js",["npm:systemjs-plugin-babel@0.0.25/babel-helpers/toConsumableArray.js","../../utils/helpers","./accessibility"],function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;return{setters:[function(a){c=a.default},function(a){d=a.once},function(a){e=a.toggleAccessibility}],execute:function(){f=document.querySelector(".js-close"),g=[].concat(c(document.querySelectorAll(".js-nav-item"))),h=document.querySelector(".js-overlay"),i=document.querySelector(".js-search"),j=document.querySelector(".js-search-button"),k=document.querySelector(".js-search-container"),l=function(){h.classList.remove("is-hidden"),i.removeAttribute("disabled"),i.focus(),d(k,"transitionend",function(){k.classList.add("is-overflowing"),k.addEventListener("keydown",m),e(k.querySelector(".c-menu")),f.setAttribute("tabIndex",0),d(f,"click",q),document.body.addEventListener("click",n)}),k.classList.add("is-open")},m=function(a){27===a.which&&q()},n=function(a){a.target.closest(".js-search-container")||q()},o=function(){i.removeAttribute("disabled"),i.blur(),g.forEach(function(a){return a.classList.remove("is-hidden")}),d(g[0],"transitionend",function(){d(j,"click",p),j.focus()})},a("openSearch",p=function(){g.forEach(function(a){return a.classList.add("is-hidden")}),d(g[0],"transitionend",l)}),a("closeSearch",q=function(){h.classList.add("is-hidden"),f.setAttribute("tabIndex",-1),k.classList.remove("is-overflowing"),k.classList.remove("is-open"),d(k,"transitionend",o),k.removeEventListener("keydown",m),e(k.querySelector(".c-menu")),document.body.removeEventListener("click",n)}),a("openSearch",p),a("closeSearch",q)}}}),System.register("theatlantic/js/components/navigation/menu.js",["npm:systemjs-plugin-babel@0.0.25/babel-helpers/toConsumableArray.js","./accessibility"],function(a,b){"use strict";function c(a){if(a){a.classList.add(i),document.body.classList.add(h),g(a);for(var b=a.querySelectorAll("a"),c=0;c<b.length;c++)if("none"!==getComputedStyle(b[c]).getPropertyValue("display")){b[c].focus();break}}}function d(a){a&&(a.classList.remove(i),document.body.classList.remove(h),g(a))}function e(){var a=document.querySelectorAll(".c-menu--expandable."+i);[].concat(f(a)).forEach(function(a){a.classList.remove(i),g(a)}),document.body.classList.remove(h)}var f,g,h,i;return a("openMenu",c),a("closeMenu",d),a("closeAllMenus",e),{setters:[function(a){f=a.default},function(a){g=a.toggleAccessibility}],execute:function(){a("menuOpenBodyClass",h="nav-open"),a("menuOpenBodyClass",h),a("menuOpenClass",i="is-open"),a("menuOpenClass",i)}}}),System.register("theatlantic/js/components/navigation/accessibility.js",["npm:systemjs-plugin-babel@0.0.25/babel-helpers/toConsumableArray.js","./menu"],function(a,b){"use strict";function c(a){var b=!1,c=0,d=!0;"true"===a.dataset.isAccessible&&(b=!0,c=-1,d=!1),a.dataset.isAccessible=d;var e=a.querySelectorAll(".c-menu__list, .c-menu__section--tertiary");[].concat(k(e)).forEach(function(a){a.setAttribute("aria-hidden",b),[].concat(k(a.querySelectorAll("a"))).forEach(function(a){a.setAttribute("tabIndex",c)})})}function d(a){function b(){n(),l(e.nextElementSibling),a.preventDefault()}function c(){var b=e.parentNode.previousElementSibling;if(!b)return!1;b.querySelector(".c-nav__link").focus(),a.preventDefault()}function d(){var b=e.parentNode.nextElementSibling;if(!b)return!1;b.querySelector(".c-nav__link").focus(),a.preventDefault()}var e=a.currentTarget,f={32:b,40:b,37:c,39:d,default:function(){return!1}};return(f[a.which]||f.default)()}function e(a){var b=a.target,c=b.closest(".c-menu__section"),d=!b.parentNode.previousElementSibling;if(c.previousElementSibling&&c.previousElementSibling.matches(".c-menu__section")||!d)if(d){var e=[].concat(k(c.previousElementSibling.querySelectorAll("a"))),f=e.filter(function(a){return null!==a.offsetParent});f.length&&f.pop().focus()}else{var g=[].concat(k(b.parentNode.previousElementSibling.querySelectorAll("a"))),h=g.filter(function(a){return null!==a.offsetParent});h.length&&h.shift().focus()}else{m(b.closest(".c-menu--expandable"));var i=b.closest(".js-nav-item");i&&i.querySelector(".js-expandable-menu").focus()}a.preventDefault()}function f(a){var b=a.target,c=b.closest(".c-menu__section"),d=!c.nextElementSibling,e=!b.parentNode.nextElementSibling,f=[];if(d&&e)return!1;f=[].concat(e?k(c.nextElementSibling.querySelectorAll("a")):k(b.parentNode.nextElementSibling.querySelectorAll("a")));var g=f.filter(function(a){return null!==a.offsetParent});g.length&&g.shift().focus(),a.preventDefault()}function g(a){var b=a.target.closest(".c-menu--expandable");b&&(m(b),b.previousElementSibling.focus(),a.preventDefault())}function h(a){window.location=a.target.getAttribute("href"),a.preventDefault()}function i(a){var b=a.key,c=a.target,d=c.closest(".c-menu--expandable");(d?[].concat(k(d.querySelectorAll(".c-menu__link"))):[]).forEach(function(a){if(a.textContent.substring(0,1).toLowerCase()===b.toLowerCase())return a.focus(),!1})}function j(a){var b={38:e,40:f,27:g,37:g,39:g,32:h,default:i};return(b[a.which]||b.default)(a)}var k,l,m,n;return a("toggleAccessibility",c),a("handleNavLinksKeydown",d),a("handleMenuLinksKeydown",j),{setters:[function(a){k=a.default},function(a){l=a.openMenu,m=a.closeMenu,n=a.closeAllMenus}],execute:function(){}}}),System.register("theatlantic/js/components/navigation.js",["npm:systemjs-plugin-babel@0.0.25/babel-helpers/toConsumableArray.js","../utils/log","../utils/helpers","./navigation/menu","./navigation/registration","./navigation/search","./navigation/accessibility"],function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;return{setters:[function(a){c=a.default},function(a){d=a.Log},function(a){e=a.once},function(a){f=a.openMenu,g=a.closeAllMenus,h=a.menuOpenClass},function(a){i=a.handleUserState},function(a){j=a.openSearch},function(a){k=a.handleNavLinksKeydown,l=a.handleMenuLinksKeydown}],execute:function(){m="atl:navigation",n=d(m),performance.mark(m+"_loaded"),o=[].concat(c(document.querySelectorAll(".js-expandable-menu"))),p=[].concat(c(document.querySelectorAll(".c-menu a"))),q=[].concat(c(document.querySelectorAll(".c-nav__link"))),r=document.querySelector(".js-search-button"),s=document.querySelector(".js-search--mobile"),t=function(){n("bindListeners"),document.body.addEventListener("click",u),e(r,"click",j),o.forEach(function(a){a.addEventListener("click",v)}),q.forEach(function(a){a.addEventListener("keydown",k)}),p.forEach(function(a){a.addEventListener("keydown",l)}),w()},u=function(a){n("handleBodyClick"),a.currentTarget.closest(".c-menu__section")||g()},v=function(a){n("handleMenuClick");var b=a.currentTarget.nextElementSibling,c=b.classList.contains(h);g(),c||f(b),a.stopPropagation()},w=function(){s&&s.addEventListener("click",function(a){a.stopPropagation()})},t(),i()}}}),System.register("npm:systemjs-plugin-babel@0.0.25/babel-helpers/classCallCheck.js",[],function(a,b){"use strict";return{setters:[],execute:function(){a("default",function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")})}}}),System.register("npm:systemjs-plugin-babel@0.0.25/babel-helpers/createClass.js",[],function(a,b){"use strict";return{setters:[],execute:function(){a("default",function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}())}}}),System.registerDynamic("npm:js-cookie@2.1.4.json",[],!0,function(){return{main:"src/js.cookie.js",format:"cjs",meta:{"*":{globals:{process:"process"}},"*.json":{format:"json"}}}}),System.registerDynamic("npm:js-cookie@2.1.4/src/js.cookie.js",["process"],!0,function(a,b,c){a("process"),this||self;!function(a){var d=!1;if("object"==typeof b&&(c.exports=a(),d=!0),!d){var e=window.Cookies,f=window.Cookies=a();f.noConflict=function(){return window.Cookies=e,f}}}(function(){function a(){for(var a=0,b={};a<arguments.length;a++){var c=arguments[a];for(var d in c)b[d]=c[d]}return b}function b(c){function d(b,e,f){var g;if("undefined"!=typeof document){if(arguments.length>1){if(f=a({path:"/"},d.defaults,f),"number"==typeof f.expires){var h=new Date;h.setMilliseconds(h.getMilliseconds()+864e5*f.expires),f.expires=h}f.expires=f.expires?f.expires.toUTCString():"";try{g=JSON.stringify(e),/^[\{\[]/.test(g)&&(e=g)}catch(a){}e=c.write?c.write(e,b):encodeURIComponent(String(e)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),b=encodeURIComponent(String(b)),b=b.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),b=b.replace(/[\(\)]/g,escape);var i="";for(var j in f)f[j]&&(i+="; "+j,!0!==f[j]&&(i+="="+f[j]));return document.cookie=b+"="+e+i}b||(g={});for(var k=document.cookie?document.cookie.split("; "):[],l=/(%[0-9A-Z]{2})+/g,m=0;m<k.length;m++){var n=k[m].split("="),o=n.slice(1).join("=");'"'===o.charAt(0)&&(o=o.slice(1,-1));try{var p=n[0].replace(l,decodeURIComponent);if(o=c.read?c.read(o,p):c(o,p)||o.replace(l,decodeURIComponent),this.json)try{o=JSON.parse(o)}catch(a){}if(b===p){g=o;break}b||(g[p]=o)}catch(a){}}return g}}return d.set=d,d.get=function(a){return d.call(d,a)},d.getJSON=function(){return d.apply({json:!0},[].slice.call(arguments))},d.defaults={},d.remove=function(b,c){d(b,"",a(c,{expires:-1}))},d.withConverter=b,d}return b(function(){})})}),System.registerDynamic("npm:jwt-decode@2.2.0/lib/atob.js",[],!0,function(a,b,c){function d(a){this.message=a}function e(a){var b=String(a).replace(/=+$/,"");if(b.length%4==1)throw new d("'atob' failed: The string to be decoded is not correctly encoded.");for(var c,e,g=0,h=0,i="";e=b.charAt(h++);~e&&(c=g%4?64*c+e:e,g++%4)?i+=String.fromCharCode(255&c>>(-2*g&6)):0)e=f.indexOf(e);return i}var f=(this||self,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=");d.prototype=new Error,d.prototype.name="InvalidCharacterError",c.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||e}),System.registerDynamic("npm:jwt-decode@2.2.0/lib/base64_url_decode.js",["./atob"],!0,function(a,b,c){function d(a){return decodeURIComponent(e(a).replace(/(.)/g,function(a,b){var c=b.charCodeAt(0).toString(16).toUpperCase();return c.length<2&&(c="0"+c),"%"+c}))}var e=(this||self,a("./atob"));c.exports=function(a){var b=a.replace(/-/g,"+").replace(/_/g,"/");switch(b.length%4){case 0:break;case 2:b+="==";break;case 3:b+="=";break;default:throw"Illegal base64url string!"}try{return d(b)}catch(a){return e(b)}}}),System.registerDynamic("npm:jwt-decode@2.2.0.json",[],!0,function(){return{main:"lib/index.js",format:"cjs",meta:{"*.json":{format:"json"},"build/jwt-decode.js":{cjsRequireDetection:!1}},map:{"./lib":"./lib/index.js","./package":"./package.json"}}}),System.registerDynamic("npm:jwt-decode@2.2.0/lib/index.js",["./base64_url_decode"],!0,function(a,b,c){"use strict";function d(a){this.message=a}var e=(this||self,a("./base64_url_decode"));d.prototype=new Error,d.prototype.name="InvalidTokenError",c.exports=function(a,b){if("string"!=typeof a)throw new d("Invalid token specified");b=b||{};var c=!0===b.header?0:1;try{return JSON.parse(e(a.split(".")[c]))}catch(a){throw new d("Invalid token specified: "+a.message)}},c.exports.InvalidTokenError=d}),System.registerDynamic("npm:ms@2.0.0.json",[],!0,function(){return{main:"index.js",format:"cjs",meta:{"*.json":{format:"json"}}}}),System.registerDynamic("npm:ms@2.0.0/index.js",[],!0,function(a,b,c){function d(a){if(a=String(a),!(a.length>100)){var b=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(a);if(b){var c=parseFloat(b[1]);switch((b[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*l;case"days":case"day":case"d":return c*k;case"hours":case"hour":case"hrs":case"hr":case"h":return c*j;case"minutes":case"minute":case"mins":case"min":case"m":return c*i;case"seconds":case"second":case"secs":case"sec":case"s":return c*h;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}}}function e(a){return a>=k?Math.round(a/k)+"d":a>=j?Math.round(a/j)+"h":a>=i?Math.round(a/i)+"m":a>=h?Math.round(a/h)+"s":a+"ms"}function f(a){return g(a,k,"day")||g(a,j,"hour")||g(a,i,"minute")||g(a,h,"second")||a+" ms"}function g(a,b,c){if(!(a<b))return a<1.5*b?Math.floor(a/b)+" "+c:Math.ceil(a/b)+" "+c+"s"}var h=(this||self,1e3),i=60*h,j=60*i,k=24*j,l=365.25*k;c.exports=function(a,b){b=b||{};var c=typeof a;if("string"===c&&a.length>0)return d(a);if("number"===c&&!1===isNaN(a))return b.long?f(a):e(a);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))}}),System.registerDynamic("npm:debug@2.6.9/src/debug.js",["ms"],!0,function(a,b,c){function d(a){var c,d=0;for(c in a)d=(d<<5)-d+a.charCodeAt(c),d|=0;return b.colors[Math.abs(d)%b.colors.length]}function e(a){function c(){if(c.enabled){var a=c,d=+new Date,e=d-(j||d);a.diff=e,a.prev=j,a.curr=d,j=d;for(var f=new Array(arguments.length),g=0;g<f.length;g++)f[g]=arguments[g];f[0]=b.coerce(f[0]),"string"!=typeof f[0]&&f.unshift("%O");var h=0;f[0]=f[0].replace(/%([a-zA-Z%])/g,function(c,d){if("%%"===c)return c;h++;var e=b.formatters[d];if("function"==typeof e){var g=f[h];c=e.call(a,g),f.splice(h,1),h--}return c}),b.formatArgs.call(a,f);(c.log||b.log||console.log.bind(console)).apply(a,f)}}return c.namespace=a,c.enabled=b.enabled(a),c.useColors=b.useColors(),c.color=d(a),"function"==typeof b.init&&b.init(c),c}function f(a){b.save(a),b.names=[],b.skips=[];for(var c=("string"==typeof a?a:"").split(/[\s,]+/),d=c.length,e=0;e<d;e++)c[e]&&(a=c[e].replace(/\*/g,".*?"),"-"===a[0]?b.skips.push(new RegExp("^"+a.substr(1)+"$")):b.names.push(new RegExp("^"+a+"$")))}function g(){b.enable("")}function h(a){var c,d;for(c=0,d=b.skips.length;c<d;c++)if(b.skips[c].test(a))return!1;for(c=0,d=b.names.length;c<d;c++)if(b.names[c].test(a))return!0;return!1}function i(a){return a instanceof Error?a.stack||a.message:a}this||self;b=c.exports=e.debug=e.default=e,b.coerce=i,b.disable=g,b.enable=f,b.enabled=h,b.humanize=a("ms"),b.names=[],b.skips=[],b.formatters={};var j}),System.registerDynamic("npm:debug@2.6.9.json",[],!0,function(){return{main:"src/browser.js",format:"cjs",map:{"./node.js":{browser:"./src/browser.js"}}}}),System.registerDynamic("npm:debug@2.6.9/src/browser.js",["./debug"],!0,function(a,b,c){function d(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function e(a){var c=this.useColors;if(a[0]=(c?"%c":"")+this.namespace+(c?" %c":" ")+a[0]+(c?"%c ":" ")+"+"+b.humanize(this.diff),c){var d="color: "+this.color;a.splice(1,0,d,"color: inherit");var e=0,f=0;a[0].replace(/%[a-zA-Z%]/g,function(a){"%%"!==a&&(e++,"%c"===a&&(f=e))}),a.splice(f,0,d)}}function f(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function g(a){try{null==a?b.storage.removeItem("debug"):b.storage.debug=a}catch(a){}}function h(){var a;try{a=b.storage.debug}catch(a){}return!a&&"undefined"!=typeof process&&"env"in process&&(a=process.env.DEBUG),a}function i(){try{return window.localStorage}catch(a){}}this||self;b=c.exports=a("./debug"),b.log=f,b.formatArgs=e,b.save=g,b.load=h,b.useColors=d,b.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:i(),b.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],b.formatters.j=function(a){try{return JSON.stringify(a)}catch(a){return"[UnexpectedJSONParseError]: "+a.message}},b.enable(h())}),System.register("theatlantic/js/utils/log.js",["debug"],function(a,b){"use strict";function c(a){var b=d(a);b.color="crimson",b.log=console.error.bind(console);var c=d(a);c.color="goldenrod",c.log=console.warn.bind(console);var e=d(a);return e.error=b,e.warn=c,e}var d;return a("Log",c),{setters:[function(a){d=a.default}],execute:function(){}}}),System.register("theatlantic/js/constants/cookie.js",[],function(a,b){"use strict";var c,d,e,f,g,h,i,j;return{setters:[],execute:function(){a("accountData",c="acctdata"),a("accountData",c),a("accountOk",d="accttok"),a("accountOk",d),a("accountMember",e="atlmbr"),a("accountMember",e),a("geolocation",f="geolocation"),a("geolocation",f),a("scrollSubscriber",g="scroll0"),a("scrollSubscriber",g),a("preferHpUS",h="show_us_hp"),a("preferHpUS",h),a("articleViewsCookie",i="dev_articleviews"),a("articleViewsCookie",i),a("jwtCookie",j="atljwt"),a("jwtCookie",j)}}}),System.register("theatlantic/js/constants/endpoints.js",["pageInfo"],function(a,b){"use strict";var c,d,e,f,g,h,i;return{setters:[function(a){c=a.article_id}],execute:function(){d="api/2.0/articles",a("relatedArticles",e="/"+d+"/"+c+"/related-articles/"),a("relatedArticles",e),a("mostPopular",f="/"+d+"/?section=most-popular"),a("mostPopular",f),a("video",g="/"+d+"/?section=video"),a("video",g),a("userCountry",h="/api/user_country/"),a("userCountry",h),a("newsletterSignUp",i="/newsletters/api/sign-up/"),a("newsletterSignUp",i)}}}),System.register("theatlantic/js/utils/user.js",["npm:systemjs-plugin-babel@0.0.25/babel-helpers/classCallCheck.js","npm:systemjs-plugin-babel@0.0.25/babel-helpers/createClass.js","npm:systemjs-plugin-babel@0.0.25/regenerator-runtime.js","npm:systemjs-plugin-babel@0.0.25/babel-helpers/asyncToGenerator.js","npm:systemjs-plugin-babel@0.0.25/babel-helpers/toConsumableArray.js","js-cookie","jwt-decode","./log","../constants/cookie","../constants/endpoints"],function(a,b){"use strict";function c(){var a=y.get(B);return a?JSON.parse(decodeURIComponent(a)):{}}function d(){var a=y.get(F);return a?z(a):{}}function e(){return-1!==l().indexOf("masthead")}function f(){return!!c().staff}function g(){return!!y.get(E)}function h(){return-1!==l().indexOf("adfree")}function i(){return h()||g()}function j(){return d().paymeter_access}function k(){return c().uuid}function l(){return c().entitlements||[]}function m(){return[].concat(x(r()?["account"]:""),x(f()?["staff"]:""),x(d().paymeter_access?["paymeter_access"]:"")).concat(l())}function n(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];document.documentElement.classList.toggle("user-signed-in",a)}function o(){var a=y.get(D);return a?Promise.resolve(JSON.parse(a)):fetch(G).then(function(a){return a.json()}).catch(function(a){return K.error(a)})}function p(){var a={domain:".theatlantic.com",path:"/"};y.remove(B,a),y.remove(C,a)}function q(){return c().fn}function r(){return!!y.get(B)&&!!c()||!!y.get(F)}function s(){var a={credentials:"include"};return fetch(H,a).then(function(){p(),n(!1)}).catch(function(a){return K(a)})}var t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L;return a("isScrollSubscriber",g),a("hasPaymeterAccess",j),a("getProductList",l),a("getEntitlementsList",m),a("signOut",s),{setters:[function(a){t=a.default},function(a){u=a.default},function(a){v=a.default},function(a){w=a.default},function(a){x=a.default},function(a){y=a.default},function(a){z=a.default},function(a){A=a.Log},function(a){B=a.accountData,C=a.accountOk,D=a.geolocation,E=a.scrollSubscriber,F=a.jwtCookie},function(a){G=a.userCountry,H=a.sessionEnd}],execute:function(){a("isAdFree",i),a("refresh",n),a("getGeoLocation",o),a("clear",p),a("getFirstName",q),a("isLoggedIn",r),I=function(){var a=w(v.mark(function a(){var b;return v.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:b=r(),n(b);case 2:case"end":return a.stop()}},a,this)}));return function(){return a.apply(this,arguments)}}(),J="atl:user",K=A(J),a("User",L=function(){function a(){t(this,a),I()}return u(a,[{key:"getJanrainUUID",value:function(){return k()}},{key:"isAdFree",value:function(){return i()}},{key:"isLoggedIn",value:function(){return r()}},{key:"getGeoLocation",value:function(a){o().then(function(b){y.set(D,b,{expires:30}),a(b)})}},{key:"getFirstName",value:function(){return q()}},{key:"refresh",value:function(){return n(r())}},{key:"clear",value:function(){return p()}},{key:"hasMembership",get:function(){return e()}},{key:"entitlements",get:function(){return m()}}]),a}()),a("User",L)}}}),System.register("theatlantic/js/components/circ-promo.js",["../utils/user"],function(a,b){"use strict";var c,d,e;return{setters:[function(a){c=a.isLoggedIn,d=a.getEntitlementsList}],execute:function(){e=document.querySelector(".circ-promo"),c()&&-1!==d().indexOf("paymeter_access")&&e&&e.parentNode.removeChild(e)}}}),System.register("theatlantic/js/utils/sticky-support.js",[],function(a,b){"use strict";function c(){var a=document.createElement("div"),b=a.style;return b.cssText="position:sticky;position:-webkit-sticky;position:-ms-sticky;",-1!==b.position.indexOf("sticky")}return a("positionStickySupport",c),{setters:[],execute:function(){}}}),System.register("npm:systemjs-plugin-babel@0.0.25/regenerator-runtime.js",[],function(a,b){"use strict";return{setters:[],execute:function(){a("default",function(a){return function(b){function c(a,b,c,d){var f=b&&b.prototype instanceof e?b:e,g=Object.create(f.prototype),h=new m(d||[]);return g._invoke=j(a,c,h),g}function d(a,b,c){try{return{type:"normal",arg:a.call(b,c)}}catch(a){return{type:"throw",arg:a}}}function e(){}function f(){}function g(){}function h(a){["next","throw","return"].forEach(function(b){a[b]=function(a){return this._invoke(b,a)}})}function i(a){function b(c,e,f,g){var h=d(a[c],a,e);if("throw"!==h.type){var i=h.arg,j=i.value;return j&&"object"==typeof j&&r.call(j,"__await")?Promise.resolve(j.__await).then(function(a){b("next",a,f,g)},function(a){b("throw",a,f,g)}):Promise.resolve(j).then(function(a){i.value=a,f(i)},g)}g(h.arg)}function c(a,c){function d(){return new Promise(function(d,e){b(a,c,d,e)})}return e=e?e.then(d,d):d()}"object"==typeof process&&process.domain&&(b=process.domain.bind(b));var e;this._invoke=c}function j(a,b,c){var e=x;return function(f,g){if(e===z)throw new Error("Generator is already running");if(e===A){if("throw"===f)throw g;return o()}for(;;){var h=c.delegate;if(h){if("return"===f||"throw"===f&&h.iterator[f]===p){c.delegate=null;var i=h.iterator.return;if(i){var j=d(i,h.iterator,g);if("throw"===j.type){f="throw",g=j.arg;continue}}if("return"===f)continue}var j=d(h.iterator[f],h.iterator,g);if("throw"===j.type){c.delegate=null,f="throw",g=j.arg;continue}f="next",g=p;var k=j.arg;if(!k.done)return e=y,k;c[h.resultName]=k.value,c.next=h.nextLoc,c.delegate=null}if("next"===f)c.sent=c._sent=g;else if("throw"===f){if(e===x)throw e=A,g;c.dispatchException(g)&&(f="next",g=p)}else"return"===f&&c.abrupt("return",g);e=z;var j=d(a,b,c);if("normal"===j.type){e=c.done?A:y;var k={value:j.arg,done:c.done};if(j.arg!==B)return k;c.delegate&&"next"===f&&(g=p)}else"throw"===j.type&&(e=A,f="throw",g=j.arg)}}}function k(a){var b={tryLoc:a[0]};1 in a&&(b.catchLoc=a[1]),2 in a&&(b.finallyLoc=a[2],b.afterLoc=a[3]),this.tryEntries.push(b)}function l(a){var b=a.completion||{};b.type="normal",delete b.arg,a.completion=b}function m(a){this.tryEntries=[{tryLoc:"root"}],a.forEach(k,this),this.reset(!0)}function n(a){if(a){var b=a[t];if(b)return b.call(a);if("function"==typeof a.next)return a;if(!isNaN(a.length)){var c=-1,d=function b(){for(;++c<a.length;)if(r.call(a,c))return b.value=a[c],b.done=!1,b;return b.value=p,b.done=!0,b};return d.next=d}}return{next:o}}function o(){return{value:p,done:!0}}var p,q=Object.prototype,r=q.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},t=s.iterator||"@@iterator",u=s.toStringTag||"@@toStringTag",v="object"==typeof a,w=b.regeneratorRuntime;if(w)return void(v&&(a.exports=w));w=b.regeneratorRuntime=v?a.exports:{},w.wrap=c;var x="suspendedStart",y="suspendedYield",z="executing",A="completed",B={},C={};C[t]=function(){return this};var D=Object.getPrototypeOf,E=D&&D(D(n([])));E&&E!==q&&r.call(E,t)&&(C=E);var F=g.prototype=e.prototype=Object.create(C);f.prototype=F.constructor=g,g.constructor=f,g[u]=f.displayName="GeneratorFunction",w.isGeneratorFunction=function(a){var b="function"==typeof a&&a.constructor;return!!b&&(b===f||"GeneratorFunction"===(b.displayName||b.name))},w.mark=function(a){return Object.setPrototypeOf?Object.setPrototypeOf(a,g):(a.__proto__=g,u in a||(a[u]="GeneratorFunction")),a.prototype=Object.create(F),a},w.awrap=function(a){return{__await:a}},h(i.prototype),w.AsyncIterator=i,w.async=function(a,b,d,e){var f=new i(c(a,b,d,e));return w.isGeneratorFunction(b)?f:f.next().then(function(a){return a.done?a.value:f.next()})},h(F),F[u]="Generator",F.toString=function(){return"[object Generator]"},w.keys=function(a){var b=[];for(var c in a)b.push(c);return b.reverse(),function c(){for(;b.length;){var d=b.pop();if(d in a)return c.value=d,c.done=!1,c}return c.done=!0,c}},w.values=n,m.prototype={constructor:m,reset:function(a){if(this.prev=0,this.next=0,this.sent=this._sent=p,this.done=!1,this.delegate=null,this.tryEntries.forEach(l),!a)for(var b in this)"t"===b.charAt(0)&&r.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=p)},stop:function(){this.done=!0;var a=this.tryEntries[0],b=a.completion;if("throw"===b.type)throw b.arg;return this.rval},dispatchException:function(a){function b(b,d){return f.type="throw",f.arg=a,c.next=b,!!d}if(this.done)throw a;for(var c=this,d=this.tryEntries.length-1;d>=0;--d){var e=this.tryEntries[d],f=e.completion;if("root"===e.tryLoc)return b("end");if(e.tryLoc<=this.prev){var g=r.call(e,"catchLoc"),h=r.call(e,"finallyLoc");if(g&&h){if(this.prev<e.catchLoc)return b(e.catchLoc,!0);if(this.prev<e.finallyLoc)return b(e.finallyLoc)}else if(g){if(this.prev<e.catchLoc)return b(e.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<e.finallyLoc)return b(e.finallyLoc)}}}},abrupt:function(a,b){for(var c=this.tryEntries.length-1;c>=0;--c){var d=this.tryEntries[c];if(d.tryLoc<=this.prev&&r.call(d,"finallyLoc")&&this.prev<d.finallyLoc){var e=d;break}}e&&("break"===a||"continue"===a)&&e.tryLoc<=b&&b<=e.finallyLoc&&(e=null);var f=e?e.completion:{};return f.type=a,f.arg=b,e?this.next=e.finallyLoc:this.complete(f),B},complete:function(a,b){if("throw"===a.type)throw a.arg;"break"===a.type||"continue"===a.type?this.next=a.arg:"return"===a.type?(this.rval=a.arg,this.next="end"):"normal"===a.type&&b&&(this.next=b)},finish:function(a){for(var b=this.tryEntries.length-1;b>=0;--b){var c=this.tryEntries[b];if(c.finallyLoc===a)return this.complete(c.completion,c.afterLoc),l(c),B}},catch:function(a){for(var b=this.tryEntries.length-1;b>=0;--b){var c=this.tryEntries[b];if(c.tryLoc===a){var d=c.completion;if("throw"===d.type){var e=d.arg;l(c)}return e}}throw new Error("illegal catch attempt")},delegateYield:function(a,b,c){return this.delegate={iterator:n(a),resultName:b,nextLoc:c},B}}}("object"==typeof global?global:"object"==typeof window?window:"object"==typeof self?self:this),a.exports}({exports:{}}))}}}),System.register("npm:systemjs-plugin-babel@0.0.25/babel-helpers/asyncToGenerator.js",[],function(a,b){"use strict";return{setters:[],execute:function(){a("default",function(a){return function(){var b=a.apply(this,arguments);return new Promise(function(a,c){function d(e,f){try{var g=b[e](f),h=g.value}catch(a){return void c(a)}if(!g.done)return Promise.resolve(h).then(function(a){d("next",a)},function(a){d("throw",a)});a(h)}return d("next")})}})}}}),System.registerDynamic("theatlantic/templates/hippo/components/non-metered-nudge.html",[],!0,function(a,b,c){var d=this||self,e=d.nunjucksPrecompiled=d.nunjucksPrecompiled||{},f=function(){function a(a,b,c,d,e){var f="";try{var g=null;f+='\n<div class="c-non-metered-nudge__container-container">\n  <div class="c-non-metered-nudge__container">\n    <a\n      href="https://accounts.theatlantic.com/products/?source=nonmetered_nudge"\n      class="js-non-metered-nudge-link"\n    >\n      <div class="c-non-metered-nudge__text-container">\n        ',d.contextOrFrameLookup(b,c,"coronaCoverage")?f+='\n        <div>\n          <p class="c-non-metered-nudge__text c-non-metered-nudge__text--main">\n            Youre reading The Atlantics free coronavirus coverage.\n          </p>\n          <p class="c-non-metered-nudge__text c-non-metered-nudge__text--main">\n            To support this vital reporting, subscribe today.\n          </p>\n        </div>\n        ':f+='\n        <p class="c-non-metered-nudge__text c-non-metered-nudge__text--main">\n          Enjoy unlimited access to The Atlantic for less than $1 per week.\n        </p>\n        ',f+='\n        <p class="c-non-metered-nudge__text c-non-metered-nudge__text--subscribe">\n          ',d.contextOrFrameLookup(b,c,"coronaCoverage")?f+="See Plans":f+="Subscribe Now",f+='\n        </p>\n      </div>\n      <p class="c-non-metered-nudge__text c-non-metered-nudge__text--mobile">\n        ',d.contextOrFrameLookup(b,c,"coronaCoverage")?f+=" Subscribe to support our reporting ":f+=" Subscribe for less\n        than $1 per week ",f+='\n      </p>\n    </a>\n  </div>\n  <button class="c-non-metered-nudge__close-icon-button js-non-metered-nudge-close">\n    <svg class="c-non-metered-nudge__close-icon "><use xlink:href="#icon-nav-close"></use></svg>\n  </button>\n</div>\n',g?g.rootRenderFunc(a,b,c,d,e):e(null,f)}catch(a){e(d.handleError(a,null,null))}}return{root:a}}();e["hippo/components/non-metered-nudge.html"]=f,c.exports=f}),System.registerDynamic("npm:nunjucks@3.1.7.json",[],!0,function(){return{main:"index.js",map:{chokidar:"@empty"},format:"cjs",meta:{"*":{globals:{process:"process"}},"*.json":{format:"json"}}}}),System.registerDynamic("npm:nunjucks@3.1.7/browser/nunjucks-slim.js",["process"],!0,function(a,b,c){var d=a("process");this||self;!function(a,d){"object"==typeof b&&"object"==typeof c?c.exports=d():"object"==typeof b?b.nunjucks=d():a.nunjucks=d()}("undefined"!=typeof self?self:b,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s=6)}([function(a,b){},function(a,b,c){"use strict";function d(a,b){return B.hasOwnProperty.call(a,b)}function e(a){return C[a]}function f(a,c,d){if(d.Update||(d=new b.TemplateError(d)),d.Update(a),!c){var e=d;d=new Error(e.message),d.name=e.name}return d}function g(a,b,c){var d,e;a instanceof Error&&(e=a,a=e.name+": "+e.message),Object.setPrototypeOf?(d=new Error(a),Object.setPrototypeOf(d,g.prototype)):(d=this,Object.defineProperty(d,"message",{enumerable:!1,writable:!0,value:a})),Object.defineProperty(d,"name",{value:"Template render error"}),Error.captureStackTrace&&Error.captureStackTrace(d,this.constructor);var f;if(e){var h=Object.getOwnPropertyDescriptor(e,"stack");f=h&&(h.get||function(){return h.value}),f||(f=function(){return e.stack})}else{var i=new Error(a).stack;f=function(){return i}}return Object.defineProperty(d,"stack",{get:function(){return f.call(d)}}),Object.defineProperty(d,"cause",{value:e}),d.lineno=b,d.colno=c,d.firstUpdate=!0,d.Update=function(a){var b="("+(a||"unknown path")+")";return this.firstUpdate&&(this.lineno&&this.colno?b+=" [Line "+this.lineno+", Column "+this.colno+"]":this.lineno&&(b+=" [Line "+this.lineno+"]")),b+="\n ",this.firstUpdate&&(b+=" "),this.message=b+(this.message||""),this.firstUpdate=!1,this},d}function h(a){return a.replace(D,e)}function i(a){return"[object Function]"===B.toString.call(a)}function j(a){return"[object Array]"===B.toString.call(a)}function k(a){return"[object String]"===B.toString.call(a)}function l(a){return"[object Object]"===B.toString.call(a)}function m(a,b){for(var c={},d=i(b)?b:function(a){return a[b]},e=0;e<a.length;e++){var f=a[e],g=d(f,e);(c[g]||(c[g]=[])).push(f)}return c}function n(a){return Array.prototype.slice.call(a)}function o(a){var b=[];if(!a)return b;for(var c=a.length,d=n(arguments).slice(1),e=-1;++e<c;)-1===u(d,a[e])&&b.push(a[e]);return b}function p(a,b){for(var c="",d=0;d<b;d++)c+=a;return c}function q(a,b,c){if(null!=a)if(A.forEach&&a.forEach===A.forEach)a.forEach(b,c);else if(a.length===+a.length)for(var d=0,e=a.length;d<e;d++)b.call(c,a[d],d,a)}function r(a,b){var c=[];if(null==a)return c;if(A.map&&a.map===A.map)return a.map(b);for(var d=0;d<a.length;d++)c[c.length]=b(a[d],d);return a.length===+a.length&&(c.length=a.length),c}function s(a,b,c){function d(){e++,e<a.length?b(a[e],e,d,c):c()}var e=-1;d()}function t(a,b,c){function d(){g++;var h=e[g];g<f?b(h,a[h],g,f,d):c()}var e=v(a||{}),f=e.length,g=-1;d()}function u(a,b,c){return Array.prototype.indexOf.call(a||[],b,c)}function v(a){var b=[];for(var c in a)d(a,c)&&b.push(c);return b}function w(a){return v(a).map(function(b){return[b,a[b]]})}function x(a){return v(a).map(function(b){return a[b]})}function y(a,b){return a=a||{},v(b).forEach(function(c){a[c]=b[c]}),a}function z(a,b){if(j(b)||k(b))return-1!==b.indexOf(a);if(l(b))return a in b;throw new Error('Cannot use "in" operator to search for "'+a+'" in unexpected types.')}var A=Array.prototype,B=Object.prototype,C={"&":"&amp;",'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;"},D=/[&"'<>]/g,b=a.exports={};b.hasOwnProp=d,b._prettifyError=f,Object.setPrototypeOf?Object.setPrototypeOf(g.prototype,Error.prototype):g.prototype=Object.create(Error.prototype,{constructor:{value:g}}),b.TemplateError=g,b.escape=h,b.isFunction=i,b.isArray=j,b.isString=k,b.isObject=l,b.groupBy=m,b.toArray=n,b.without=o,b.repeat=p,b.each=q,b.map=r,b.asyncIter=s,b.asyncFor=t,b.indexOf=u,b.keys=v,b._entries=w,b._values=x,b._assign=b.extend=y,b.inOperator=z},function(a,b,c){"use strict";function d(a,b,c){var d=this;return function(){for(var e=arguments.length,f=new Array(e),i=0;i<e;i++)f[i]=arguments[i];var j,k=h(f),l=g(f);if(k>a.length)j=f.slice(0,a.length),f.slice(j.length,k).forEach(function(a,c){c<b.length&&(l[b[c]]=a)}),j.push(l);else if(k<a.length){j=f.slice(0,k);for(var m=k;m<a.length;m++){var n=a[m];j.push(l[n]),delete l[n]}j.push(l)}else j=f;return c.apply(d,j)}}function e(a){return a.__keywords=!0,a}function f(a){return a&&Object.prototype.hasOwnProperty.call(a,"__keywords")}function g(a){var b=a.length;if(b){var c=a[b-1];if(f(c))return c}return{}}function h(a){var b=a.length;return 0===b?0:f(a[b-1])?b-1:b}function i(a){if("string"!=typeof a)return a;this.val=a,this.length=a.length}function j(a,b){return a instanceof i?new i(b):b.toString()}function k(a){var b=typeof a;return"string"===b?new i(a):"function"!==b?a:function(b){var c=a.apply(this,arguments);return"string"==typeof c?new i(c):c}}function l(a,b){return a=void 0!==a&&null!==a?a:"",!b||a instanceof i||(a=u.escape(a.toString())),a}function m(a,b,c){if(null===a||void 0===a)throw new u.TemplateError("attempted to output null or undefined value",b+1,c+1);return a}function n(a,b){if(void 0!==a&&null!==a)return"function"==typeof a[b]?function(){for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return a[b].apply(a,d)}:a[b]}function o(a,b,c,d){if(!a)throw new Error("Unable to call `"+b+"`, which is undefined or falsey");if("function"!=typeof a)throw new Error("Unable to call `"+b+"`, which is not a function");return a.apply(c,d)}function p(a,b,c){var d=b.lookup(c);return void 0!==d?d:a.lookup(c)}function q(a,b,c){return a.lineno?a:new u.TemplateError(a,b,c)}function r(a,b,c,d){if(u.isArray(a)){var e=a.length;u.asyncIter(a,function(a,d,f){switch(b){case 1:c(a,d,e,f);break;case 2:c(a[0],a[1],d,e,f);break;case 3:c(a[0],a[1],a[2],d,e,f);break;default:a.push(d,e,f),c.apply(this,a)}},d)}else u.asyncFor(a,function(a,b,d,e,f){c(a,b,d,e,f)},d)}function s(a,b,c,d){function e(a,b){h++,g[a]=b,h===f&&d(null,g.join(""))}var f,g,h=0;if(u.isArray(a))if(f=a.length,g=new Array(f),0===f)d(null,"");else for(var i=0;i<a.length;i++){var j=a[i];switch(b){case 1:c(j,i,f,e);break;case 2:c(j[0],j[1],i,f,e);break;case 3:c(j[0],j[1],j[2],i,f,e);break;default:j.push(i,f,e),c.apply(this,j)}}else{var k=u.keys(a||{});if(f=k.length,g=new Array(f),0===f)d(null,"");else for(var l=0;l<k.length;l++){var m=k[l];c(m,a[m],l,f,e)}}}function t(a){return"object"!=typeof a||null===a||u.isArray(a)?a:w&&Symbol.iterator in a?v(a):a}var u=c(1),v=Array.from,w="function"==typeof Symbol&&Symbol.iterator&&"function"==typeof v,x=function(){function a(a,b){this.variables={},this.parent=a,this.topLevel=!1,this.isolateWrites=b}var b=a.prototype;return b.set=function(a,b,c){var d=a.split("."),e=this.variables,f=this;if(c&&(f=this.resolve(d[0],!0)))return void f.set(a,b);for(var g=0;g<d.length-1;g++){var h=d[g];e[h]||(e[h]={}),e=e[h]}e[d[d.length-1]]=b},b.get=function(a){var b=this.variables[a];return void 0!==b?b:null},b.lookup=function(a){var b=this.parent,c=this.variables[a];return void 0!==c?c:b&&b.lookup(a)},b.resolve=function(a,b){var c=b&&this.isolateWrites?void 0:this.parent;return void 0!==this.variables[a]?this:c&&c.resolve(a)},b.push=function(b){return new a(this,b)},b.pop=function(){return this.parent},a}();i.prototype=Object.create(String.prototype,{length:{writable:!0,configurable:!0,value:0}}),i.prototype.valueOf=function(){return this.val},i.prototype.toString=function(){return this.val},a.exports={Frame:x,makeMacro:d,makeKeywordArgs:e,numArgs:h,suppressValue:l,ensureDefined:m,memberLookup:n,contextOrFrameLookup:p,callWrap:o,handleError:q,isArray:u.isArray,keys:u.keys,SafeString:i,copySafeness:j,markSafe:k,asyncEach:r,asyncAll:s,inOperator:u.inOperator,fromIterator:t}},function(a,b,c){"use strict";function d(a,b){a.prototype=Object.create(b.prototype),a.prototype.constructor=a,a.__proto__=b}var e=c(4),f=function(a){function b(b){var c;return c=a.call(this)||this,c.precompiled=b||{},c}return d(b,a),b.prototype.getSource=function(a){return this.precompiled[a]?{src:{type:"code",obj:this.precompiled[a]},path:a}:null},b}(e);a.exports={PrecompiledLoader:f}},function(a,b,c){"use strict";function d(a,b){a.prototype=Object.create(b.prototype),a.prototype.constructor=a,a.__proto__=b}var e=c(0),f=c(5);a.exports=function(a){function b(){return a.apply(this,arguments)||this}d(b,a);var c=b.prototype;return c.on=function(a,b){this.listeners=this.listeners||{},this.listeners[a]=this.listeners[a]||[],this.listeners[a].push(b)},c.emit=function(a){for(var b=arguments.length,c=new Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];this.listeners&&this.listeners[a]&&this.listeners[a].forEach(function(a){a.apply(void 0,c)})},c.resolve=function(a,b){return e.resolve(e.dirname(a),b)},c.isRelative=function(a){return 0===a.indexOf("./")||0===a.indexOf("../")},b}(f)},function(a,b,c){"use strict";function d(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function e(a,b,c){return b&&d(a.prototype,b),c&&d(a,c),a}function f(a,b){a.prototype=Object.create(b.prototype),a.prototype.constructor=a,a.__proto__=b}function g(a,b){return"function"!=typeof a||"function"!=typeof b?b:function(){var c=this.parent;this.parent=a;var d=b.apply(this,arguments);return this.parent=c,d}}function h(a,b,c){c=c||{},i.keys(c).forEach(function(b){c[b]=g(a.prototype[b],c[b])});var d=function(a){function c(){return a.apply(this,arguments)||this}return f(c,a),e(c,[{key:"typename",get:function(){return b}}]),c}(a);return i._assign(d.prototype,c),d}var i=c(1),j=function(){function a(){this.init.apply(this,arguments)}return a.prototype.init=function(){},a.extend=function(a,b){return"object"==typeof a&&(b=a,a="anonymous"),h(this,a,b)},e(a,[{key:"typename",get:function(){return this.constructor.name}}]),a}();a.exports=j},function(a,b,c){"use strict";function d(a,b){b=b||{},f.isObject(a)&&(b=a,a=null);var c;return k.FileSystemLoader?c=new k.FileSystemLoader(a,{watch:b.watch,noCache:b.noCache}):k.WebLoader&&(c=new k.WebLoader(a,{useCache:b.web&&b.web.useCache,async:b.web&&b.web.async})),e=new h(c,b),b&&b.express&&e.express(b.express),e}var e,f=c(1),g=c(7),h=g.Environment,i=g.Template,j=c(4),k=c(3),l=c(0),m=c(0),n=c(0),o=c(0),p=c(2),q=c(0),r=c(16);a.exports={Environment:h,Template:i,Loader:j,FileSystemLoader:k.FileSystemLoader,PrecompiledLoader:k.PrecompiledLoader,WebLoader:k.WebLoader,compiler:m,parser:n,lexer:o,runtime:p,lib:f,nodes:q,installJinjaCompat:r,configure:d,reset:function(){e=void 0},compile:function(a,b,c,f){return e||d(),new i(a,b,c,f)},render:function(a,b,c){return e||d(),e.render(a,b,c)},renderString:function(a,b,c){return e||d(),e.renderString(a,b,c)},precompile:l?l.precompile:void 0,precompileString:l?l.precompileString:void 0}},function(a,b,c){"use strict";function d(a,b){a.prototype=Object.create(b.prototype),a.prototype.constructor=a,a.__proto__=b}function e(a,b,c){f(function(){a(b,c)})}var f=c(8),g=c(11),h=c(1),i=c(0),j=c(12),k=c(3),l=k.FileSystemLoader,m=k.WebLoader,n=k.PrecompiledLoader,o=c(13),p=c(14),q=c(5),r=c(2),s=r.handleError,t=r.Frame,u=c(15),v={type:"code",obj:{root:function(a,b,c,d,e){try{e(null,"")}catch(a){e(s(a,null,null))}}}},w=function(a){function b(){return a.apply(this,arguments)||this}d(b,a);var c=b.prototype;return c.init=function(a,b){var c=this;b=this.opts=b||{},this.opts.dev=!!b.dev,this.opts.autoescape=null==b.autoescape||b.autoescape,this.opts.throwOnUndefined=!!b.throwOnUndefined,this.opts.trimBlocks=!!b.trimBlocks,this.opts.lstripBlocks=!!b.lstripBlocks,this.loaders=[],a?this.loaders=h.isArray(a)?a:[a]:l?this.loaders=[new l("views")]:m&&(this.loaders=[new m("/views")]),"undefined"!=typeof window&&window.nunjucksPrecompiled&&this.loaders.unshift(new n(window.nunjucksPrecompiled)),this.initCache(),this.globals=p(),this.filters={},this.tests={},this.asyncFilters=[],this.extensions={},this.extensionsList=[],h._entries(j).forEach(function(a){var b=a[0],d=a[1];return c.addFilter(b,d)}),h._entries(o).forEach(function(a){var b=a[0],d=a[1];return c.addTest(b,d)})},c.initCache=function(){this.loaders.forEach(function(a){a.cache={},"function"==typeof a.on&&a.on("update",function(b){a.cache[b]=null})})},c.addExtension=function(a,b){return b.__name=a,this.extensions[a]=b,this.extensionsList.push(b),this},c.removeExtension=function(a){var b=this.getExtension(a);b&&(this.extensionsList=h.without(this.extensionsList,b),delete this.extensions[a])},c.getExtension=function(a){return this.extensions[a]},c.hasExtension=function(a){return!!this.extensions[a]},c.addGlobal=function(a,b){return this.globals[a]=b,this},c.getGlobal=function(a){if(void 0===this.globals[a])throw new Error("global not found: "+a);return this.globals[a]},c.addFilter=function(a,b,c){var d=b;return c&&this.asyncFilters.push(a),this.filters[a]=d,this},c.getFilter=function(a){if(!this.filters[a])throw new Error("filter not found: "+a);return this.filters[a]},c.addTest=function(a,b){return this.tests[a]=b,this},c.getTest=function(a){if(!this.tests[a])throw new Error("test not found: "+a);return this.tests[a]},c.resolveTemplate=function(a,b,c){return!(a.isRelative&&b&&a.isRelative(c)&&a.resolve)?c:a.resolve(b,c)},c.getTemplate=function(a,b,c,d,e){var f=this,g=this,i=null;if(a&&a.raw&&(a=a.raw),h.isFunction(c)&&(e=c,c=null,b=b||!1),h.isFunction(b)&&(e=b,b=!1),a instanceof y)i=a;else{if("string"!=typeof a)throw new Error("template names must be a string: "+a);for(var j=0;j<this.loaders.length;j++){var k=this.loaders[j];if(i=k.cache[this.resolveTemplate(k,c,a)])break}}if(i)return b&&i.compile(),e?void e(null,i):i;var l,m=function(c,g){if(g||c||d||(c=new Error("template not found: "+a)),c){if(e)return void e(c);throw c}var h;g?(h=new y(g.src,f,g.path,b),g.noCache||(g.loader.cache[a]=h)):h=new y(v,f,"",b),e?e(null,h):l=h};return h.asyncIter(this.loaders,function(b,d,e,f){function h(a,c){a?f(a):c?(c.loader=b,f(null,c)):e()}a=g.resolveTemplate(b,c,a),b.async?b.getSource(a,h):h(null,b.getSource(a))},m),l},c.express=function(a){return u(this,a)},c.render=function(a,b,c){h.isFunction(b)&&(c=b,b=null);var d=null;return this.getTemplate(a,function(a,f){if(a&&c)e(c,a);else{if(a)throw a;d=f.render(b,c)}}),d},c.renderString=function(a,b,c,d){return h.isFunction(c)&&(d=c,c={}),c=c||{},new y(a,this,c.path).render(b,d)},c.waterfall=function(a,b,c){return g(a,b,c)},b}(q),x=function(a){function b(){return a.apply(this,arguments)||this}d(b,a);var c=b.prototype;return c.init=function(a,b,c){var d=this;this.env=c||new w,this.ctx=h.extend({},a),this.blocks={},this.exported=[],h.keys(b).forEach(function(a){d.addBlock(a,b[a])})},c.lookup=function(a){return a in this.env.globals&&!(a in this.ctx)?this.env.globals[a]:this.ctx[a]},c.setVariable=function(a,b){this.ctx[a]=b},c.getVariables=function(){return this.ctx},c.addBlock=function(a,b){return this.blocks[a]=this.blocks[a]||[],this.blocks[a].push(b),this},c.getBlock=function(a){if(!this.blocks[a])throw new Error('unknown block "'+a+'"');return this.blocks[a][0]},c.getSuper=function(a,b,c,d,e,f){var g=h.indexOf(this.blocks[b]||[],c),i=this.blocks[b][g+1],j=this;if(-1===g||!i)throw new Error('no super block available for "'+b+'"');i(a,j,d,e,f)},c.addExport=function(a){this.exported.push(a)},c.getExported=function(){var a=this,b={};return this.exported.forEach(function(c){b[c]=a.ctx[c]}),b},b}(q),y=function(a){function b(){return a.apply(this,arguments)||this}d(b,a);var c=b.prototype;return c.init=function(a,b,c,d){if(this.env=b||new w,h.isObject(a))switch(a.type){case"code":this.tmplProps=a.obj;break;case"string":this.tmplStr=a.obj;break;default:throw new Error("Unexpected template object type "+a.type+"; expected 'code', or 'string'")}else{if(!h.isString(a))throw new Error("src must be a string or an object describing the source");this.tmplStr=a}if(this.path=c,d)try{this._compile()}catch(a){throw h._prettifyError(this.path,this.env.opts.dev,a)}else this.compiled=!1},c.render=function(a,b,c){var d=this;"function"==typeof a?(c=a,a={}):"function"==typeof b&&(c=b,b=null);var f=!b;try{this.compile()}catch(a){var g=h._prettifyError(this.path,this.env.opts.dev,a);if(c)return e(c,g);throw g}var i=new x(a||{},this.blocks,this.env),j=b?b.push(!0):new t;j.topLevel=!0;var k=null,l=!1;return this.rootRenderFunc(this.env,i,j,r,function(a,b){if(l){if(c)return;throw a}if(a&&(a=h._prettifyError(d.path,d.env.opts.dev,a),l=!0),c)f?e(c,a,b):c(a,b);else{if(a)throw a;k=b}}),k},c.getExported=function(a,b,c){"function"==typeof a&&(c=a,a={}),"function"==typeof b&&(c=b,b=null);try{this.compile()}catch(a){if(c)return c(a);throw a}var d=b?b.push():new t;d.topLevel=!0;var e=new x(a||{},this.blocks,this.env);this.rootRenderFunc(this.env,e,d,r,function(a){a?c(a,null):c(null,e.getExported())})},c.compile=function(){this.compiled||this._compile()},c._compile=function(){var a;if(this.tmplProps)a=this.tmplProps;else{var b=i.compile(this.tmplStr,this.env.asyncFilters,this.env.extensionsList,this.path,this.env.opts);a=new Function(b)()}this.blocks=this._getBlocks(a),this.rootRenderFunc=a.root,this.compiled=!0},c._getBlocks=function(a){var b={};return h.keys(a).forEach(function(c){"b_"===c.slice(0,2)&&(b[c.slice(2)]=a[c])}),b},b}(q);a.exports={Environment:w,Template:y}},function(a,b,c){"use strict";function d(){if(i.length)throw i.shift()}function e(a){var b;b=h.length?h.pop():new f,b.task=a,g(b)}function f(){this.task=null}var g=c(9),h=[],i=[],j=g.makeRequestCallFromTimer(d);a.exports=e,f.prototype.call=function(){try{this.task.call()}catch(a){e.onerror?e.onerror(a):(i.push(a),j())}finally{this.task=null,h[h.length]=this}}},function(a,b,c){"use strict";(function(b){function c(a){h.length||(g(),i=!0),h[h.length]=a}function d(){for(;j<h.length;){var a=j;if(j+=1,h[a].call(),j>k){for(var b=0,c=h.length-j;b<c;b++)h[b]=h[b+j];h.length-=j,j=0}}h.length=0,j=0,i=!1}function e(a){var b=1,c=new m(a),d=document.createTextNode("");return c.observe(d,{characterData:!0}),function(){b=-b,d.data=b}}function f(a){return function(){function b(){clearTimeout(c),clearInterval(d),a()}var c=setTimeout(b,0),d=setInterval(b,50)}}a.exports=c;var g,h=[],i=!1,j=0,k=1024,l=void 0!==b?b:self,m=l.MutationObserver||l.WebKitMutationObserver;g="function"==typeof m?e(d):f(d),c.requestFlush=g,c.makeRequestCallFromTimer=f}).call(b,c(10))},function(a,b){var c;c=function(){return this}();try{c=c||Function("return this")()||(0,eval)("this")}catch(a){"object"==typeof window&&(c=window)}a.exports=c},function(a,b,c){var e,f;!function(c){"use strict";var g=function(){var a=Array.prototype.slice.call(arguments);"function"==typeof a[0]&&a[0].apply(null,a.splice(1))},h=function(a){"function"==typeof setImmediate?setImmediate(a):void 0!==d&&d.nextTick?d.nextTick(a):setTimeout(a,0)},i=function(a){var b=function(c){var d=function(){return a.length&&a[c].apply(null,arguments),d.next()};return d.next=function(){return c<a.length-1?b(c+1):null},d};return b(0)},j=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},k=function(a,b,c){var d=c?h:g;if(b=b||function(){},!j(a)){var e=new Error("First argument to waterfall must be an array of functions");return b(e)}if(!a.length)return b();var f=function(a){return function(c){if(c)b.apply(null,arguments),b=function(){};else{var e=Array.prototype.slice.call(arguments,1),g=a.next();g?e.push(f(g)):e.push(b),d(function(){a.apply(null,e)})}}};f(i(a))()};e=[],void 0!==(f=function(){return k}.apply(b,e))&&(a.exports=f)}()},function(a,b,c){"use strict";function d(a,b){return null===a||void 0===a||!1===a?b:a}function e(a){return a!==a}function f(a,b,c){var d,e=[],f=[];for(d=0;d<a.length;d++)d%b==0&&f.length&&(e.push(f),f=[]),f.push(a[d]);if(f.length){if(c)for(d=f.length;d<b;d++)f.push(c);e.push(f)}return e}function g(a){a=d(a,"");var b=a.toLowerCase();return R.copySafeness(a,b.charAt(0).toUpperCase()+b.slice(1))}function h(a,b){if(a=d(a,""),b=b||80,a.length>=b)return a;var c=b-a.length,e=Q.repeat(" ",c/2-c%2),f=Q.repeat(" ",c/2);return R.copySafeness(a,e+a+f)}function i(a,b,c){return c?a||b:void 0!==a?a:b}function j(a,b,c){if(!Q.isObject(a))throw new Q.TemplateError("dictsort filter: val must be an object");var d=[];for(var e in a)d.push([e,a[e]]);var f;if(void 0===c||"key"===c)f=0;else{if("value"!==c)throw new Q.TemplateError("dictsort filter: You can only sort by either key or value");f=1}return d.sort(function(a,c){var d=a[f],e=c[f];return b||(Q.isString(d)&&(d=d.toUpperCase()),Q.isString(e)&&(e=e.toUpperCase())),d>e?1:d===e?0:-1}),d}function k(a,b){return JSON.stringify(a,null,b)}function l(a){return a instanceof R.SafeString?a:(a=null===a||void 0===a?"":a,R.markSafe(Q.escape(a.toString())))}function m(a){return a instanceof R.SafeString?a:(a=null===a||void 0===a?"":a,R.markSafe(a.toString()))}function n(a){return a[0]}function o(a){return a=null===a||void 0===a?"":a,R.markSafe(Q.escape(a.toString()))}function p(a,b){return Q.groupBy(a,b)}function q(a,b,c){if(""===(a=d(a,"")))return"";b=b||4;var e=a.split("\n"),f=Q.repeat(" ",b),g=e.map(function(a,b){return 0!==b||c?""+f+a+"\n":a+"\n"}).join("");return R.copySafeness(a,g)}function r(a,b,c){return b=b||"",c&&(a=Q.map(a,function(a){return a[c]})),a.join(b)}function s(a){return a[a.length-1]}function t(a){var b=d(a,"");return void 0!==b?"function"==typeof Map&&b instanceof Map||"function"==typeof Set&&b instanceof Set?b.size:!Q.isObject(b)||b instanceof R.SafeString?b.length:Q.keys(b).length:0}function u(a){if(Q.isString(a))return a.split("");if(Q.isObject(a))return Q._entries(a||{}).map(function(a){return{key:a[0],value:a[1]}});if(Q.isArray(a))return a;throw new Q.TemplateError("list filter: type not iterable")}function v(a){return a=d(a,""),a.toLowerCase()}function w(a){return null===a||void 0===a?"":R.copySafeness(a,a.replace(/\r\n|\n/g,"<br />\n"))}function x(a){return a[Math.floor(Math.random()*a.length)]}function y(a,b){return a.filter(function(a){return!a[b]})}function z(a,b){return a.filter(function(a){return!!a[b]})}function A(a,b,c,d){var e=a;if(b instanceof RegExp)return a.replace(b,c);void 0===d&&(d=-1);var f="";if("number"==typeof b)b=""+b;else if("string"!=typeof b)return a;if("number"==typeof a&&(a=""+a),"string"!=typeof a&&!(a instanceof R.SafeString))return a;if(""===b)return f=c+a.split("").join(c)+c,R.copySafeness(a,f);var g=a.indexOf(b);if(0===d||-1===g)return a;for(var h=0,i=0;g>-1&&(-1===d||i<d);)f+=a.substring(h,g)+c,h=g+b.length,i++,g=a.indexOf(b,h);return h<a.length&&(f+=a.substring(h)),R.copySafeness(e,f)}function B(a){var b;return b=Q.isString(a)?u(a):Q.map(a,function(a){return a}),b.reverse(),Q.isString(a)?R.copySafeness(a,b.join("")):b}function C(a,b,c){b=b||0;var d=Math.pow(10,b);return("ceil"===c?Math.ceil:"floor"===c?Math.floor:Math.round)(a*d)/d}function D(a,b,c){for(var d=Math.floor(a.length/b),e=a.length%b,f=[],g=0,h=0;h<b;h++){var i=g+h*d;h<e&&g++;var j=g+(h+1)*d,k=a.slice(i,j);c&&h>=e&&k.push(c),f.push(k)}return f}function E(a,b,c){return void 0===c&&(c=0),b&&(a=Q.map(a,function(a){return a[b]})),c+a.reduce(function(a,b){return a+b},0)}function F(a){return R.copySafeness(a,a)}function G(a,b){a=d(a,"");var c=/<\/?([a-z][a-z0-9]*)\b[^>]*>|<!--[\s\S]*?-->/gi,e=I(a.replace(c,"")),f="";return f=b?e.replace(/^ +| +$/gm,"").replace(/ +/g," ").replace(/(\r\n)/g,"\n").replace(/\n\n\n+/g,"\n\n"):e.replace(/\s+/gi," "),R.copySafeness(a,f)}function H(a){a=d(a,"");var b=a.split(" ").map(function(a){return g(a)});return R.copySafeness(a,b.join(" "))}function I(a){return R.copySafeness(a,a.replace(/^\s*|\s*$/g,""))}function J(a,b,c,e){var f=a;if(a=d(a,""),b=b||255,a.length<=b)return a;if(c)a=a.substring(0,b);else{var g=a.lastIndexOf(" ",b);-1===g&&(g=b),a=a.substring(0,g)}return a+=void 0!==e&&null!==e?e:"...",R.copySafeness(f,a)}function K(a){return a=d(a,""),a.toUpperCase()}function L(a){var b=encodeURIComponent;return Q.isString(a)?b(a):(Q.isArray(a)?a:Q._entries(a)).map(function(a){var c=a[0],d=a[1];return b(c)+"="+b(d)}).join("&")}function M(a,b,c){e(b)&&(b=1/0);var d=!0===c?' rel="nofollow"':"";return a.split(/(\s+)/).filter(function(a){return a&&a.length}).map(function(a){var c=a.match(S),e=c?c[1]:a,f=e.substr(0,b);return U.test(e)?'<a href="'+e+'"'+d+">"+f+"</a>":V.test(e)?'<a href="http://'+e+'"'+d+">"+f+"</a>":T.test(e)?'<a href="mailto:'+e+'">'+e+"</a>":W.test(e)?'<a href="http://'+e+'"'+d+">"+f+"</a>":a}).join("")}function N(a){a=d(a,"");var b=a?a.match(/\w+/g):null;return b?b.length:null}function O(a,b){var c=parseFloat(a);return e(c)?b:c}function P(a,b){var c=parseInt(a,10);return e(c)?b:c}var Q=c(1),R=c(2),b=a.exports={};b.abs=Math.abs,b.batch=f,b.capitalize=g,b.center=h,b.default=i,b.dictsort=j,b.dump=k,b.escape=l,b.safe=m,b.first=n,b.forceescape=o,b.groupby=p,b.indent=q,b.join=r,b.last=s,b.length=t,b.list=u,b.lower=v,b.nl2br=w,b.random=x,b.rejectattr=y,b.selectattr=z,b.replace=A,b.reverse=B,b.round=C,b.slice=D,b.sum=E,b.sort=R.makeMacro(["value","reverse","case_sensitive","attribute"],[],function(a,b,c,d){var e=Q.map(a,function(a){return a});return e.sort(function(a,e){var f=d?a[d]:a,g=d?e[d]:e;return!c&&Q.isString(f)&&Q.isString(g)&&(f=f.toLowerCase(),g=g.toLowerCase()),f<g?b?1:-1:f>g?b?-1:1:0}),e}),b.string=F,b.striptags=G,b.title=H,b.trim=I,b.truncate=J,b.upper=K,b.urlencode=L;var S=/^(?:\(|<|&lt;)?(.*?)(?:\.|,|\)|\n|&gt;)?$/,T=/^[\w.!#$%&'*+\-\/=?\^`{|}~]+@[a-z\d\-]+(\.[a-z\d\-]+)+$/i,U=/^https?:\/\/.*$/,V=/^www\./,W=/\.(?:org|net|com)(?:\:|\/|$)/;b.urlize=M,b.wordcount=N,b.float=O,b.int=P,b.d=b.default,b.e=b.escape},function(a,b,c){"use strict";function d(a){return"function"==typeof a}function e(a){return void 0!==a}function f(a,b){return a%b==0}function g(a){return a instanceof z}function h(a,b){return a===b}function i(a){return a%2==0}function j(a){return!a}function k(a,b){return a>=b}function l(a,b){return a>b}function m(a,b){return a<=b}function n(a,b){return a<b}function o(a){return a.toLowerCase()===a}function p(a,b){return a!==b}function q(a){return null===a}function r(a){return"number"==typeof a}function s(a){return a%2==1}function t(a){return"string"==typeof a}function u(a){return!!a}function v(a){return void 0===a}function w(a){return a.toUpperCase()===a}function x(a){return"undefined"!=typeof Symbol?!!a[Symbol.iterator]:Array.isArray(a)||"string"==typeof a}function y(a){var b=null!==a&&void 0!==a&&"object"==typeof a&&!Array.isArray(a);return Set?b&&!(a instanceof Set):b}var z=c(2).SafeString;b.callable=d,b.defined=e,b.divisibleby=f,b.escaped=g,b.equalto=h,b.eq=b.equalto,b.sameas=b.equalto,b.even=i,b.falsy=j,b.ge=k,b.greaterthan=l,b.gt=b.greaterthan,b.le=m,b.lessthan=n,b.lt=b.lessthan,b.lower=o,b.ne=p,b.null=q,b.number=r,b.odd=s,b.string=t,b.truthy=u,b.undefined=v,b.upper=w,b.iterable=x,b.mapping=y},function(a,b,c){"use strict";function d(a){var b=-1;return{current:null,reset:function(){b=-1,this.current=null},next:function(){return b++,b>=a.length&&(b=0),this.current=a[b],this.current}}}function e(a){a=a||",";var b=!0;return function(){var c=b?"":a;return b=!1,c}}function f(){return{range:function(a,b,c){void 0===b?(b=a,a=0,c=1):c||(c=1);var d=[];if(c>0)for(var e=a;e<b;e+=c)d.push(e);else for(var f=a;f>b;f+=c)d.push(f);return d},cycler:function(){return d(Array.prototype.slice.call(arguments))},joiner:function(a){return e(a)}}}a.exports=f},function(a,b,c){var d=c(0);a.exports=function(a,b){function c(a,b){if(this.name=a,this.path=a,this.defaultEngine=b.defaultEngine,this.ext=d.extname(a),!this.ext&&!this.defaultEngine)throw new Error("No default engine was specified and no extension was provided.");this.ext||(this.name+=this.ext=("."!==this.defaultEngine[0]?".":"")+this.defaultEngine)}return c.prototype.render=function(b,c){a.render(this.name,b,c)},b.set("view",c),b.set("nunjucksEnv",a),a}},function(a,b,c){function d(){"use strict";function a(){f.contextOrFrameLookup=j,f.memberLookup=k,h&&(h.prototype.assertType=d),i&&(i.prototype.parseAggregate=e)}function b(a,b,c,d){a=a||[],null===b&&(b=d<0?a.length-1:0),null===c?c=d<0?-1:a.length:c<0&&(c+=a.length),b<0&&(b+=a.length);for(var e=[],g=b;!(g<0||g>a.length)&&!(d>0&&g>=c)&&!(d<0&&g<=c);g+=d)e.push(f.memberLookup(a,g));return e}function c(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var d,e,f=this.runtime,g=this.lib,h=this.compiler.Compiler,i=this.parser.Parser,j=(this.nodes,this.lexer,f.contextOrFrameLookup),k=f.memberLookup;h&&(d=h.prototype.assertType),i&&(e=i.prototype.parseAggregate),f.contextOrFrameLookup=function(a,b,c){var d=j.apply(this,arguments);if(void 0!==d)return d;switch(c){case"True":return!0;case"False":return!1;case"None":return null;default:return}};var l={pop:function(a){if(void 0===a)return this.pop();if(a>=this.length||a<0)throw new Error("KeyError");return this.splice(a,1)},append:function(a){return this.push(a)},remove:function(a){for(var b=0;b<this.length;b++)if(this[b]===a)return this.splice(b,1);throw new Error("ValueError")},count:function(a){for(var b=0,c=0;c<this.length;c++)this[c]===a&&b++;return b},index:function(a){var b;if(-1===(b=this.indexOf(a)))throw new Error("ValueError");return b},find:function(a){return this.indexOf(a)},insert:function(a,b){return this.splice(a,0,b)}},m={items:function(){return g._entries(this)},values:function(){return g._values(this)},keys:function(){return g.keys(this)},get:function(a,b){var c=this[a];return void 0===c&&(c=b),c},has_key:function(a){return c(this,a)},pop:function(a,b){var c=this[a];if(void 0===c&&void 0!==b)c=b;else{if(void 0===c)throw new Error("KeyError");delete this[a]}return c},popitem:function(){var a=g.keys(this);if(!a.length)throw new Error("KeyError");var b=a[0],c=this[b];return delete this[b],[b,c]},setdefault:function(a,b){return void 0===b&&(b=null),a in this||(this[a]=b),this[a]},update:function(a){return g._assign(this,a),null}};return m.iteritems=m.items,m.itervalues=m.values,m.iterkeys=m.keys,f.memberLookup=function(a,d,e){return 4===arguments.length?b.apply(this,arguments):(a=a||{},g.isArray(a)&&c(l,d)?l[d].bind(a):g.isObject(a)&&c(m,d)?m[d].bind(a):k.apply(this,arguments))},a}a.exports=d}])})}),System.registerDynamic("github:theatlantic/theatlantic-nunjucks-helpers@1.6.1.json",[],!0,function(){return{main:"index.js"}}),System.registerDynamic("github:theatlantic/theatlantic-nunjucks-helpers@1.6.1/lib/extensions/render.js",[],!0,function(a,b,c){function d(a,b,c){void 0===c&&(c=".html"),this.env=a,this.componentDir=b,this.ext=c,this.tags=["render"],this.parse=function(a,b){var c=a.nextToken(),d=a.parseSignature(null,!0);return a.advanceAfterBlockEnd(c.value),new b.CallExtension(this,"run",d)},this.run=function(a,b,c,d){var e=b.replace(/^@/,""),f=a.ctx,g=c||f;return d&&(g=Object.assign({},f,g)),this.env.render(this.componentDir+"/"+e+this.ext,g)}}this||self;c.exports=d}),System.register("theatlantic/js/utils/nunjucks.js",["nunjucks/browser/nunjucks-slim","../constants/url","accountsConfig","theatlantic-nunjucks-helpers/lib/extensions/render"],function(a,b){"use strict";function c(a,b,c){return c=c||{},c.env=c.env||h,new Promise(function(d,e){var f="hippo/components/"+a+".html";c.env.render(f,b,function(a,b){a&&e(a),d(b)})})}var d,e,f,g,h;return a("render",c),{setters:[function(a){d=a.default},function(a){e=a.debug},function(a){f=a},function(a){g=a.default}],execute:function(){h=new d.Environment(null,{autoescape:!1}),h.addGlobal("component",function(a,b){var c=e;return h.render(a,Object.assign({},this.ctx,b,{debug_components:c}))}),h.addGlobal("accounts_url",f.url),h.addExtension("render",new g(h,"hippo/components"))}}}),System.register("theatlantic/js/globals/dataLayer.js",[],function(a,b){"use strict";return{setters:[],execute:function(){window.dataLayer=window.dataLayer||[],a("default",window.dataLayer)}}}),System.register("theatlantic/js/paywall/non-metered-nudge.js",["npm:systemjs-plugin-babel@0.0.25/regenerator-runtime.js","npm:systemjs-plugin-babel@0.0.25/babel-helpers/asyncToGenerator.js","hippo/components/non-metered-nudge","../utils/nunjucks","../utils/events","../globals/dataLayer","pageInfo"],function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m,n,o,p;return{setters:[function(a){c=a.default},function(a){d=a.default},function(a){},function(a){e=a.render},function(a){f=a.dataEvent},function(a){g=a.default},function(a){h=a}],execute:function(){i=this,j=function(a){var b={action:a,label:"non-metered nudge",value:""};f(window,"nudge:interaction",{detail:b})},k=function(a){a.getElementsByClassName("js-non-metered-nudge-close")[0].addEventListener("click",function(){j("nudge:user_close"),a.remove()})},l=function(a){a.getElementsByClassName("js-non-metered-nudge-link")[0].addEventListener("click",function(){j("nudge:click")})},m=function(){return"homepage"===h.primary_channel&&window.IntersectionObserver},n=function(a){a.classList.add("is-visible");var b={nudgeTemplate:"non-metered nudge",event:"Nudge Template Set"};g.push(b)},a("handleHiddenNonMeteredNudge",o=function(){var a=document.getElementsByClassName("js-non-metered-nudge")[0];a&&!a.classList.contains("is-visible")&&n(a)}),a("handleHiddenNonMeteredNudge",o),a("renderNonMeteredNudge",p=function(){var a=d(c.mark(function a(){var b,d;return c.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return b=h.categories&&-1!==h.categories.indexOf("Coronavirus: COVID-19"),d=document.createElement("div"),d.className="c-non-metered-nudge js-non-metered-nudge",d.tabIndex=-1,m()||n(d),"homepage"!==h.primary_channel&&d.classList.add("c-non-metered-nudge--non-homepage"),b&&d.classList.add("c-non-metered-nudge--article"),a.next=9,e("non-metered-nudge",{coronaCoverage:b});case 9:d.innerHTML=a.sent,document.body.appendChild(d),l(d),k(d);case 13:case"end":return a.stop()}},a,i)}));return function(){return a.apply(this,arguments)}}()),a("renderNonMeteredNudge",p)}}}),System.register("theatlantic/js/lacroix/components/navigation.js",["../../utils/sticky-support","../../paywall/non-metered-nudge"],function(a,b){"use strict";var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;return{setters:[function(a){c=a.positionStickySupport},function(a){d=a.handleHiddenNonMeteredNudge}],execute:function(){e="u-hidden",f="is-hidden",g="is-active",h="is-expanded",i=document.getElementById("hamburger-menu"),j=document.getElementById("hamburger-icon"),k=document.getElementById("main-navigation--lacroix"),l=document.getElementById("nav-list"),m=document.querySelector(".js-overlay"),n=document.getElementById("expanded-nav"),o=function(a){i.setAttribute("aria-expanded",!0),document.body.classList.add("js-nav-menu-open"),m.classList.remove(f),a.classList.remove(e),k.classList.add(h),l.classList.add(h),j.classList.add(g),document.body.addEventListener("click",p)},p=function(a){a.target.classList.contains("js-overlay")&&q(n)},q=function(a){i.setAttribute("aria-expanded",!1),document.body.classList.remove("js-nav-menu-open"),m.classList.add(f),a.classList.add(e),k.classList.remove(h),l.classList.remove(h),j.classList.remove(g),document.body.removeEventListener("click",p)},i.addEventListener("click",function(){n.classList.contains(e)?o(n):q(n)}),r=c(),s=document.getElementById("big-a"),t=document.getElementById("nav-list"),u=document.querySelector(".c-expanded-nav"),v=document.querySelector(".c-nav__before"),w=document.getElementById("small-a"),x="homepage"===Atlantic.page_info.view||"international_homepage"===Atlantic.page_info.view,r&&k.classList.remove("legacy"),y=function(){v.classList.contains("c-nav__before--cineflex")?v.classList.remove("c-nav__before--cineflex"):v.classList.add("c-nav__before--cineflex")},z=function(){new IntersectionObserver(function(a){a.forEach(function(a){var b=window.innerWidth>=576,c=!1;a.isIntersecting&&b?(c=document.querySelector(".js-cineflex-ad").classList.contains("ad-loaded"),t.classList.remove("c-nav__list--menu--sticky"),u.classList.remove("is-slim"),w.classList.remove("c-nav__item--small-a--displayed"),c&&y()):b&&(c=document.querySelector(".js-cineflex-ad").classList.contains("ad-loaded"),t.classList.add("c-nav__list--menu--sticky"),u.classList.add("is-slim"),w.classList.add("c-nav__item--small-a--displayed"),c&&y()),a.isIntersecting||d()})},{rootMargin:"0px 0px 0px 0px"}).observe(s)},r&&x&&window.IntersectionObserver&&z()}}}),System.registerDynamic("npm:systemjs-plugin-babel@0.0.25.json",[],!0,function(){return{main:"plugin-babel.js",map:{"systemjs-babel-build":{browser:"./systemjs-babel-browser.js",default:"./systemjs-babel-browser.js"}},meta:{"./plugin-babel.js":{format:"cjs"}}}}),System.register("npm:systemjs-plugin-babel@0.0.25/babel-helpers/toConsumableArray.js",[],function(a,b){"use strict";return{setters:[],execute:function(){a("default",function(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)})}}}),System.register("theatlantic/js/lacroix/utils/sticky.js",[],function(a,b){"use strict";var c;return{setters:[],execute:function(){a("stickyElements",c=function(a,b,c){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,f=a.getBoundingClientRect().top+window.pageYOffset-d,g=function(){var d=b.getBoundingClientRect().bottom;window.pageYOffset>f&&d>=e?a.classList.add(c):a.classList.remove(c)};window.addEventListener("scroll",g,{passive:!0})}),a("stickyElements",c)}}}),System.registerDynamic("npm:jspm-nodelibs-process@0.2.1.json",[],!0,function(){return{main:"./process.js"}}),System.registerDynamic("npm:jspm-nodelibs-process@0.2.1/process.js",["@system-env"],!0,function(a,b,c){function d(){l=!1,h.length?k=h.concat(k):m=-1,k.length&&e()}function e(){if(!l){var a=setTimeout(d);l=!0;for(var b=k.length;b;){for(h=k,k=[];++m<b;)h&&h[m].run();m=-1,b=k.length}h=null,l=!1,clearTimeout(a)}}function f(a,b){this.fun=a,this.array=b}function g(){}var h,i=(this||self,a("@system-env").production),j=c.exports={},k=[],l=!1,m=-1;j.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];k.push(new f(a,b)),1!==k.length||l||setTimeout(e,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},j.title="browser",j.browser=!0,j.env={NODE_ENV:i?"production":"development"},j.argv=[],j.version="",j.versions={},j.on=g,j.addListener=g,j.once=g,j.off=g,j.removeListener=g,j.removeAllListeners=g,j.emit=g,j.binding=function(a){throw new Error("process.binding is not supported")},j.cwd=function(){return"/"},j.chdir=function(a){throw new Error("process.chdir is not supported")},j.umask=function(){return 0}}),System.registerDynamic("npm:clipboard@2.0.4.json",[],!0,function(){return{main:"dist/clipboard.js",format:"cjs",meta:{"*":{globals:{process:"process"}},"*.json":{format:"json"},"src/clipboard.js":{format:"esm"},"test/*":{format:"esm"}}}}),System.registerDynamic("npm:clipboard@2.0.4/dist/clipboard.js",["process"],!0,function(a,b,c){a("process"),this||self;!function(a,d){"object"==typeof b&&"object"==typeof c?c.exports=d():"object"==typeof b?b.ClipboardJS=d():a.ClipboardJS=d()}(b,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{enumerable:!0,get:d})},b.r=function(a){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},b.t=function(a,c){if(1&c&&(a=b(a)),8&c)return a;if(4&c&&"object"==typeof a&&a&&a.__esModule)return a;var d=Object.create(null);if(b.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:a}),2&c&&"string"!=typeof a)for(var e in a)b.d(d,e,function(b){return a[b]}.bind(null,e));return d},b.n=function(a){var c=a&&a.__esModule?function(){return a.default}:function(){return a};return b.d(c,"a",c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p="",b(b.s=0)}([function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function g(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function h(a,b){var c="data-clipboard-"+a;if(b.hasAttribute(c))return b.getAttribute(c)}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},j=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),k=c(1),l=d(k),m=c(3),n=d(m),o=c(4),p=d(o),q=function(a){function b(a,c){e(this,b);var d=f(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return d.resolveOptions(c),d.listenClick(a),d}return g(b,a),j(b,[{key:"resolveOptions",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"==typeof a.action?a.action:this.defaultAction,this.target="function"==typeof a.target?a.target:this.defaultTarget,this.text="function"==typeof a.text?a.text:this.defaultText,this.container="object"===i(a.container)?a.container:document.body}},{key:"listenClick",value:function(a){var b=this;this.listener=(0,p.default)(a,"click",function(a){return b.onClick(a)})}},{key:"onClick",value:function(a){var b=a.delegateTarget||a.currentTarget;this.clipboardAction&&(this.clipboardAction=null),this.clipboardAction=new l.default({action:this.action(b),target:this.target(b),text:this.text(b),container:this.container,trigger:b,emitter:this})}},{key:"defaultAction",value:function(a){return h("action",a)}},{key:"defaultTarget",value:function(a){var b=h("target",a);if(b)return document.querySelector(b)}},{key:"defaultText",value:function(a){return h("text",a)}},{key:"destroy",value:function(){this.listener.destroy(),this.clipboardAction&&(this.clipboardAction.destroy(),this.clipboardAction=null)}}],[{key:"isSupported",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],b="string"==typeof a?[a]:a,c=!!document.queryCommandSupported;return b.forEach(function(a){c=c&&!!document.queryCommandSupported(a)}),c}}]),b}(n.default);a.exports=q},function(a,b,c){"use strict";function d(a){return a&&a.__esModule?a:{default:a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},g=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=c(2),i=d(h),j=function(){function a(b){e(this,a),this.resolveOptions(b),this.initSelection()}return g(a,[{key:"resolveOptions",value:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action=a.action,this.container=a.container,this.emitter=a.emitter,this.target=a.target,this.text=a.text,this.trigger=a.trigger,this.selectedText=""}},{key:"initSelection",value:function(){this.text?this.selectFake():this.target&&this.selectTarget()}},{key:"selectFake",value:function(){var a=this,b="rtl"==document.documentElement.getAttribute("dir");this.removeFake(),this.fakeHandlerCallback=function(){return a.removeFake()},this.fakeHandler=this.container.addEventListener("click",this.fakeHandlerCallback)||!0,this.fakeElem=document.createElement("textarea"),this.fakeElem.style.fontSize="12pt",this.fakeElem.style.border="0",this.fakeElem.style.padding="0",this.fakeElem.style.margin="0",this.fakeElem.style.position="absolute",this.fakeElem.style[b?"right":"left"]="-9999px";var c=window.pageYOffset||document.documentElement.scrollTop;this.fakeElem.style.top=c+"px",this.fakeElem.setAttribute("readonly",""),this.fakeElem.value=this.text,this.container.appendChild(this.fakeElem),this.selectedText=(0,i.default)(this.fakeElem),this.copyText()}},{key:"removeFake",value:function(){this.fakeHandler&&(this.container.removeEventListener("click",this.fakeHandlerCallback),this.fakeHandler=null,this.fakeHandlerCallback=null),this.fakeElem&&(this.container.removeChild(this.fakeElem),this.fakeElem=null)}},{key:"selectTarget",value:function(){this.selectedText=(0,i.default)(this.target),this.copyText()}},{key:"copyText",value:function(){var a=void 0;try{a=document.execCommand(this.action)}catch(b){a=!1}this.handleResult(a)}},{key:"handleResult",value:function(a){this.emitter.emit(a?"success":"error",{action:this.action,text:this.selectedText,trigger:this.trigger,clearSelection:this.clearSelection.bind(this)})}},{key:"clearSelection",value:function(){this.trigger&&this.trigger.focus(),window.getSelection().removeAllRanges()}},{key:"destroy",value:function(){this.removeFake()}},{key:"action",set:function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"copy";if(this._action=a,"copy"!==this._action&&"cut"!==this._action)throw new Error('Invalid "action" value, use either "copy" or "cut"')},get:function(){return this._action}},{key:"target",set:function(a){if(void 0!==a){if(!a||"object"!==(void 0===a?"undefined":f(a))||1!==a.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===this.action&&a.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===this.action&&(a.hasAttribute("readonly")||a.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes');this._target=a}},get:function(){return this._target}}]),a}();a.exports=j},function(a,b){function c(a){var b;if("SELECT"===a.nodeName)a.focus(),b=a.value;else if("INPUT"===a.nodeName||"TEXTAREA"===a.nodeName){var c=a.hasAttribute("readonly");c||a.setAttribute("readonly",""),a.select(),a.setSelectionRange(0,a.value.length),c||a.removeAttribute("readonly"),b=a.value}else{a.hasAttribute("contenteditable")&&a.focus();var d=window.getSelection(),e=document.createRange();e.selectNodeContents(a),d.removeAllRanges(),d.addRange(e),b=d.toString()}return b}a.exports=c},function(a,b){function c(){}c.prototype={on:function(a,b,c){var d=this.e||(this.e={});return(d[a]||(d[a]=[])).push({fn:b,ctx:c}),this},once:function(a,b,c){function d(){e.off(a,d),b.apply(c,arguments)}var e=this;return d._=b,this.on(a,d,c)},emit:function(a){var b=[].slice.call(arguments,1),c=((this.e||(this.e={}))[a]||[]).slice(),d=0,e=c.length;for(d;d<e;d++)c[d].fn.apply(c[d].ctx,b);return this},off:function(a,b){var c=this.e||(this.e={}),d=c[a],e=[];if(d&&b)for(var f=0,g=d.length;f<g;f++)d[f].fn!==b&&d[f].fn._!==b&&e.push(d[f]);return e.length?c[a]=e:delete c[a],this}},a.exports=c},function(a,b,c){function d(a,b,c){if(!a&&!b&&!c)throw new Error("Missing required arguments");if(!h.string(b))throw new TypeError("Second argument must be a String");if(!h.fn(c))throw new TypeError("Third argument must be a Function");if(h.node(a))return e(a,b,c);if(h.nodeList(a))return f(a,b,c);if(h.string(a))return g(a,b,c);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function e(a,b,c){return a.addEventListener(b,c),{destroy:function(){a.removeEventListener(b,c)}}}function f(a,b,c){return Array.prototype.forEach.call(a,function(a){a.addEventListener(b,c)}),{destroy:function(){Array.prototype.forEach.call(a,function(a){a.removeEventListener(b,c)})}}}function g(a,b,c){return i(document.body,a,b,c)}var h=c(5),i=c(6);a.exports=d},function(a,b){b.node=function(a){return void 0!==a&&a instanceof HTMLElement&&1===a.nodeType},b.nodeList=function(a){var c=Object.prototype.toString.call(a);return void 0!==a&&("[object NodeList]"===c||"[object HTMLCollection]"===c)&&"length"in a&&(0===a.length||b.node(a[0]))},b.string=function(a){return"string"==typeof a||a instanceof String},b.fn=function(a){return"[object Function]"===Object.prototype.toString.call(a)}},function(a,b,c){function d(a,b,c,d,e){var g=f.apply(this,arguments);return a.addEventListener(c,g,e),{destroy:function(){a.removeEventListener(c,g,e)}}}function e(a,b,c,e,f){return"function"==typeof a.addEventListener?d.apply(null,arguments):"function"==typeof c?d.bind(null,document).apply(null,arguments):("string"==typeof a&&(a=document.querySelectorAll(a)),Array.prototype.map.call(a,function(a){return d(a,b,c,e,f)}))}function f(a,b,c,d){return function(c){c.delegateTarget=g(c.target,b),c.delegateTarget&&d.call(a,c)}}var g=c(7);a.exports=e},function(a,b){function c(a,b){for(;a&&a.nodeType!==d;){if("function"==typeof a.matches&&a.matches(b))return a;a=a.parentNode}}var d=9;if("undefined"!=typeof Element&&!Element.prototype.matches){var e=Element.prototype;e.matches=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector}a.exports=c}])})}),System.register("theatlantic/js/lacroix/utils/copy-link.js",["clipboard"],function(a,b){"use strict";var c,d;return{setters:[function(a){c=a.default}],execute:function(){a("copyLink",d=function(a,b,d){var e=document.querySelector(a);new c(a);var f=function(){b.classList.add(d),window.setTimeout(function(){b.classList.remove(d)},1500)};e.addEventListener("click",f)}),a("copyLink",d)}}}),System.register("theatlantic/js/lacroix/components/share-social.js",["npm:systemjs-plugin-babel@0.0.25/babel-helpers/toConsumableArray.js","../utils/sticky","../utils/copy-link"],function(a,b){"use strict";function c(a){a.preventDefault();var b=a.currentTarget,c=b.dataset,d=c.height,e=void 0===d?600:d,f=c.width,g=void 0===f?400:f,h=window.innerHeight/2-e/2,i=window.innerWidth/2-g/2;window.open(b.href,"shareWindow","height="+e+", width="+g+", top="+h+", left="+i+", resizeable=1")}var d,e,f,g,h,i,j,k,l,m;return{setters:[function(a){d=a.default},function(a){e=a.stickyElements},function(a){f=a.copyLink}],execute:function(){(g=document.getElementsByClassName("js-share-social-sticky")[0])&&(h=document.querySelector(".js-article-container"),i=g.querySelector(".js-copy-link-container"),j=[].concat(d(g.querySelectorAll(".js-share-social__link"))),k=document.querySelector(".js-navigation"),l=window.innerHeight/2-k.getBoundingClientRect().height,m=window.innerHeight/2+g.getBoundingClientRect().height,e(g,h,"c-share-social--sticky",l,m),f(".js-copy-link-btn",i,"c-share-social--success"),j.map(function(a){return a.addEventListener("click",c)}))}}}),System.registerDynamic("npm:jspm-nodelibs-url@0.2.1.json",[],!0,function(){return{main:"./url.js",map:{"./url.js":{browser:"url"}}}}),System.registerDynamic("npm:punycode@1.3.2.json",[],!0,function(){return{main:"punycode.js",format:"cjs",meta:{"*.json":{format:"json"}}}}),System.registerDynamic("npm:punycode@1.3.2/punycode.js",[],!0,function(a,b,c){var d=this||self;!function(a){function e(a){throw RangeError(H[a])}function f(a,b){for(var c=a.length,d=[];c--;)d[c]=b(a[c]);return d}function g(a,b){var c=a.split("@"),d="";return c.length>1&&(d=c[0]+"@",a=c[1]),a=a.replace(G,"."),d+f(a.split("."),b).join(".")}function h(a){for(var b,c,d=[],e=0,f=a.length;e<f;)b=a.charCodeAt(e++),b>=55296&&b<=56319&&e<f?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function i(a){return f(a,function(a){var b="";return a>65535&&(a-=65536,b+=K(a>>>10&1023|55296),a=56320|1023&a),b+=K(a)}).join("")}function j(a){return a-48<10?a-22:a-65<26?a-65:a-97<26?a-97:w}function k(a,b){return a+22+75*(a<26)-((0!=b)<<5)}function l(a,b,c){var d=0;for(a=c?J(a/A):a>>1,a+=J(a/b);a>I*y>>1;d+=w)a=J(a/I);return J(d+(I+1)*a/(a+z))}function m(a){var b,c,d,f,g,h,k,m,n,o,p=[],q=a.length,r=0,s=C,t=B;for(c=a.lastIndexOf(D),c<0&&(c=0),d=0;d<c;++d)a.charCodeAt(d)>=128&&e("not-basic"),p.push(a.charCodeAt(d));for(f=c>0?c+1:0;f<q;){for(g=r,h=1,k=w;f>=q&&e("invalid-input"),m=j(a.charCodeAt(f++)),(m>=w||m>J((v-r)/h))&&e("overflow"),r+=m*h,n=k<=t?x:k>=t+y?y:k-t,!(m<n);k+=w)o=w-n,h>J(v/o)&&e("overflow"),h*=o;b=p.length+1,t=l(r-g,b,0==g),J(r/b)>v-s&&e("overflow"),s+=J(r/b),r%=b,p.splice(r++,0,s)}return i(p)}function n(a){var b,c,d,f,g,i,j,m,n,o,p,q,r,s,t,u=[];for(a=h(a),q=a.length,b=C,c=0,g=B,i=0;i<q;++i)(p=a[i])<128&&u.push(K(p));for(d=f=u.length,f&&u.push(D);d<q;){for(j=v,i=0;i<q;++i)(p=a[i])>=b&&p<j&&(j=p);for(r=d+1,j-b>J((v-c)/r)&&e("overflow"),c+=(j-b)*r,b=j,i=0;i<q;++i)if(p=a[i],p<b&&++c>v&&e("overflow"),p==b){for(m=c,n=w;o=n<=g?x:n>=g+y?y:n-g,!(m<o);n+=w)t=m-o,s=w-o,u.push(K(k(o+t%s,0))),m=J(t/s);u.push(K(k(m,0))),g=l(c,r,d==f),c=0,++d}++c,++b}return u.join("")}function o(a){return g(a,function(a){return E.test(a)?m(a.slice(4).toLowerCase()):a})}function p(a){return g(a,function(a){return F.test(a)?"xn--"+n(a):a})}var q="object"==typeof b&&b&&!b.nodeType&&b,r="object"==typeof c&&c&&!c.nodeType&&c,s="object"==typeof d&&d;s.global!==s&&s.window!==s&&s.self!==s||(a=s);var t,u,v=2147483647,w=36,x=1,y=26,z=38,A=700,B=72,C=128,D="-",E=/^xn--/,F=/[^\x20-\x7E]/,G=/[\x2E\u3002\uFF0E\uFF61]/g,H={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},I=w-x,J=Math.floor,K=String.fromCharCode;if(t={version:"1.3.2",ucs2:{decode:h,encode:i},decode:m,encode:n,toASCII:p,toUnicode:o},q&&r)if(c.exports==q)r.exports=t;else for(u in t)t.hasOwnProperty(u)&&(q[u]=t[u]);else a.punycode=t}(b)}),System.registerDynamic("npm:url@0.11.0/util.js",[],!0,function(a,b,c){"use strict";this||self;c.exports={isString:function(a){return"string"==typeof a},isObject:function(a){return"object"==typeof a&&null!==a},isNull:function(a){return null===a},isNullOrUndefined:function(a){return null==a}}}),System.registerDynamic("npm:querystring@0.2.0/decode.js",[],!0,function(a,b,c){"use strict";function d(a,b){return Object.prototype.hasOwnProperty.call(a,b)}this||self;c.exports=function(a,b,c,e){b=b||"&",c=c||"=";var f={};if("string"!=typeof a||0===a.length)return f;var g=/\+/g;a=a.split(b);var h=1e3;e&&"number"==typeof e.maxKeys&&(h=e.maxKeys);var i=a.length;h>0&&i>h&&(i=h);for(var j=0;j<i;++j){var k,l,m,n,o=a[j].replace(g,"%20"),p=o.indexOf(c);p>=0?(k=o.substr(0,p),l=o.substr(p+1)):(k=o,l=""),m=decodeURIComponent(k),n=decodeURIComponent(l),d(f,m)?Array.isArray(f[m])?f[m].push(n):f[m]=[f[m],n]:f[m]=n}return f}}),System.registerDynamic("npm:querystring@0.2.0/encode.js",[],!0,function(a,b,c){"use strict";var d=(this||self,function(a){switch(typeof a){case"string":return a;case"boolean":return a?"true":"false";case"number":return isFinite(a)?a:"";default:return""}});c.exports=function(a,b,c,e){return b=b||"&",c=c||"=",null===a&&(a=void 0),"object"==typeof a?Object.keys(a).map(function(e){var f=encodeURIComponent(d(e))+c;return Array.isArray(a[e])?a[e].map(function(a){return f+encodeURIComponent(d(a))}).join(b):f+encodeURIComponent(d(a[e]))}).join(b):e?encodeURIComponent(d(e))+c+encodeURIComponent(d(a)):""}}),System.registerDynamic("npm:querystring@0.2.0.json",[],!0,function(){return{main:"index.js",format:"cjs",meta:{"*.json":{format:"json"}},map:{"./test":"./test/index.js"}}}),System.registerDynamic("npm:querystring@0.2.0/index.js",["./decode","./encode"],!0,function(a,b,c){"use strict";this||self;b.decode=b.parse=a("./decode"),b.encode=b.stringify=a("./encode")}),System.registerDynamic("npm:url@0.11.0.json",[],!0,function(){return{main:"url.js",format:"cjs",meta:{"*.json":{format:"json"}}}}),System.registerDynamic("npm:url@0.11.0/url.js",["punycode","./util","querystring"],!0,function(a,b,c){"use strict";function d(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function e(a,b,c){if(a&&j.isObject(a)&&a instanceof d)return a;var e=new d;return e.parse(a,b,c),e}function f(a){return j.isString(a)&&(a=e(a)),a instanceof d?a.format():d.prototype.format.call(a)}function g(a,b){return e(a,!1,!0).resolve(b)}function h(a,b){return a?e(a,!1,!0).resolveObject(b):b}var i=(this||self,a("punycode")),j=a("./util");b.parse=e,b.resolve=g,b.resolveObject=h,b.format=f,b.Url=d;var k=/^([a-z0-9.+-]+:)/i,l=/:[0-9]*$/,m=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,n=["<",">",'"',"`"," ","\r","\n","\t"],o=["{","}","|","\\","^","`"].concat(n),p=["'"].concat(o),q=["%","/","?",";","#"].concat(p),r=["/","?","#"],s=/^[+a-z0-9A-Z_-]{0,63}$/,t=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,u={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},w={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},x=a("querystring");d.prototype.parse=function(a,b,c){if(!j.isString(a))throw new TypeError("Parameter 'url' must be a string, not "+typeof a);var d=a.indexOf("?"),e=-1!==d&&d<a.indexOf("#")?"?":"#",f=a.split(e),g=/\\/g;f[0]=f[0].replace(g,"/"),a=f.join(e);var h=a;if(h=h.trim(),!c&&1===a.split("#").length){var l=m.exec(h);if(l)return this.path=h,this.href=h,this.pathname=l[1],l[2]?(this.search=l[2],this.query=b?x.parse(this.search.substr(1)):this.search.substr(1)):b&&(this.search="",this.query={}),this}var n=k.exec(h);if(n){n=n[0];var o=n.toLowerCase();this.protocol=o,h=h.substr(n.length)}if(c||n||h.match(/^\/\/[^@\/]+@[^@\/]+/)){var y="//"===h.substr(0,2);!y||n&&v[n]||(h=h.substr(2),this.slashes=!0)}if(!v[n]&&(y||n&&!w[n])){for(var z=-1,A=0;A<r.length;A++){var B=h.indexOf(r[A]);-1!==B&&(-1===z||B<z)&&(z=B)}var C,D;D=-1===z?h.lastIndexOf("@"):h.lastIndexOf("@",z),-1!==D&&(C=h.slice(0,D),h=h.slice(D+1),this.auth=decodeURIComponent(C)),z=-1;for(var A=0;A<q.length;A++){var B=h.indexOf(q[A]);-1!==B&&(-1===z||B<z)&&(z=B)}-1===z&&(z=h.length),this.host=h.slice(0,z),h=h.slice(z),this.parseHost(),this.hostname=this.hostname||"";var E="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!E)for(var F=this.hostname.split(/\./),A=0,G=F.length;A<G;A++){var H=F[A];if(H&&!H.match(s)){for(var I="",J=0,K=H.length;J<K;J++)H.charCodeAt(J)>127?I+="x":I+=H[J];if(!I.match(s)){var L=F.slice(0,A),M=F.slice(A+1),N=H.match(t);N&&(L.push(N[1]),M.unshift(N[2])),M.length&&(h="/"+M.join(".")+h),this.hostname=L.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),E||(this.hostname=i.toASCII(this.hostname));var O=this.port?":"+this.port:"",P=this.hostname||"";this.host=P+O,this.href+=this.host,E&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==h[0]&&(h="/"+h))}if(!u[o])for(var A=0,G=p.length;A<G;A++){var Q=p[A];if(-1!==h.indexOf(Q)){var R=encodeURIComponent(Q);R===Q&&(R=escape(Q)),h=h.split(Q).join(R)}}var S=h.indexOf("#");-1!==S&&(this.hash=h.substr(S),h=h.slice(0,S));var T=h.indexOf("?");if(-1!==T?(this.search=h.substr(T),this.query=h.substr(T+1),b&&(this.query=x.parse(this.query)),h=h.slice(0,T)):b&&(this.search="",this.query={}),h&&(this.pathname=h),w[o]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var O=this.pathname||"",U=this.search||"";this.path=O+U}return this.href=this.format(),this},d.prototype.format=function(){var a=this.auth||"";a&&(a=encodeURIComponent(a),a=a.replace(/%3A/i,":"),a+="@");var b=this.protocol||"",c=this.pathname||"",d=this.hash||"",e=!1,f="";this.host?e=a+this.host:this.hostname&&(e=a+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(e+=":"+this.port)),this.query&&j.isObject(this.query)&&Object.keys(this.query).length&&(f=x.stringify(this.query));var g=this.search||f&&"?"+f||"";return b&&":"!==b.substr(-1)&&(b+=":"),this.slashes||(!b||w[b])&&!1!==e?(e="//"+(e||""),c&&"/"!==c.charAt(0)&&(c="/"+c)):e||(e=""),d&&"#"!==d.charAt(0)&&(d="#"+d),g&&"?"!==g.charAt(0)&&(g="?"+g),c=c.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),g=g.replace("#","%23"),b+e+c+g+d},d.prototype.resolve=function(a){return this.resolveObject(e(a,!1,!0)).format()},d.prototype.resolveObject=function(a){if(j.isString(a)){var b=new d;b.parse(a,!1,!0),a=b}for(var c=new d,e=Object.keys(this),f=0;f<e.length;f++){var g=e[f];c[g]=this[g]}if(c.hash=a.hash,""===a.href)return c.href=c.format(),c;if(a.slashes&&!a.protocol){for(var h=Object.keys(a),i=0;i<h.length;i++){var k=h[i];"protocol"!==k&&(c[k]=a[k])}return w[c.protocol]&&c.hostname&&!c.pathname&&(c.path=c.pathname="/"),c.href=c.format(),c}if(a.protocol&&a.protocol!==c.protocol){if(!w[a.protocol]){for(var l=Object.keys(a),m=0;m<l.length;m++){var n=l[m];c[n]=a[n]}return c.href=c.format(),c}if(c.protocol=a.protocol,a.host||v[a.protocol])c.pathname=a.pathname;else{for(var o=(a.pathname||"").split("/");o.length&&!(a.host=o.shift()););a.host||(a.host=""),a.hostname||(a.hostname=""),""!==o[0]&&o.unshift(""),o.length<2&&o.unshift(""),c.pathname=o.join("/")}if(c.search=a.search,c.query=a.query,c.host=a.host||"",c.auth=a.auth,c.hostname=a.hostname||a.host,c.port=a.port,c.pathname||c.search){var p=c.pathname||"",q=c.search||"";c.path=p+q}return c.slashes=c.slashes||a.slashes,c.href=c.format(),c}var r=c.pathname&&"/"===c.pathname.charAt(0),s=a.host||a.pathname&&"/"===a.pathname.charAt(0),t=s||r||c.host&&a.pathname,u=t,x=c.pathname&&c.pathname.split("/")||[],o=a.pathname&&a.pathname.split("/")||[],y=c.protocol&&!w[c.protocol];if(y&&(c.hostname="",c.port=null,c.host&&(""===x[0]?x[0]=c.host:x.unshift(c.host)),c.host="",a.protocol&&(a.hostname=null,a.port=null,a.host&&(""===o[0]?o[0]=a.host:o.unshift(a.host)),a.host=null),t=t&&(""===o[0]||""===x[0])),s)c.host=a.host||""===a.host?a.host:c.host,c.hostname=a.hostname||""===a.hostname?a.hostname:c.hostname,c.search=a.search,c.query=a.query,x=o;else if(o.length)x||(x=[]),x.pop(),x=x.concat(o),c.search=a.search,c.query=a.query;else if(!j.isNullOrUndefined(a.search)){if(y){c.hostname=c.host=x.shift();var z=!!(c.host&&c.host.indexOf("@")>0)&&c.host.split("@");z&&(c.auth=z.shift(),c.host=c.hostname=z.shift())}return c.search=a.search,c.query=a.query,j.isNull(c.pathname)&&j.isNull(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.href=c.format(),c}if(!x.length)return c.pathname=null,c.search?c.path="/"+c.search:c.path=null,c.href=c.format(),c;for(var A=x.slice(-1)[0],B=(c.host||a.host||x.length>1)&&("."===A||".."===A)||""===A,C=0,D=x.length;D>=0;D--)A=x[D],"."===A?x.splice(D,1):".."===A?(x.splice(D,1),C++):C&&(x.splice(D,1),C--);if(!t&&!u)for(;C--;C)x.unshift("..");!t||""===x[0]||x[0]&&"/"===x[0].charAt(0)||x.unshift(""),B&&"/"!==x.join("/").substr(-1)&&x.push("");var E=""===x[0]||x[0]&&"/"===x[0].charAt(0);if(y){c.hostname=c.host=E?"":x.length?x.shift():"";var z=!!(c.host&&c.host.indexOf("@")>0)&&c.host.split("@");z&&(c.auth=z.shift(),c.host=c.hostname=z.shift())}return t=t||c.host&&x.length,t&&!E&&x.unshift(""),x.length?c.pathname=x.join("/"):(c.pathname=null,c.path=null),j.isNull(c.pathname)&&j.isNull(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.auth=a.auth||c.auth,c.slashes=c.slashes||a.slashes,c.href=c.format(),c},d.prototype.parseHost=function(){var a=this.host,b=l.exec(a);b&&(b=b[0],":"!==b&&(this.port=b.substr(1)),a=a.substr(0,a.length-b.length)),a&&(this.hostname=a)}}),System.register("theatlantic/js/constants/url.js",["url"],function(a,b){"use strict";function c(a){return Array.isArray(a)?a:[].concat(a).filter(function(a){return void 0!==a})}var d,e,f,g,h;return{setters:[function(a){d=a.default}],execute:function(){a("parsedUrl",e=d.parse(window.location.href,!0)),a("parsedUrl",e),a("debug",f=c(e.query.debug)),a("debug",f),a("disable",g=c(e.query.disable)),a("disable",g),a("preview",h=c(e.query.preview)),a("preview",h)}}}),System.register("theatlantic/js/utils/events.js",["../constants/url"],function(a,b){"use strict";function c(a,b){a.dispatchEvent(b)}function d(a,b,d){var g=new window.CustomEvent(b,d);if(c(a,g),e.includes("data")){var h=g.type,i=g.detail;console.info("%c "+h,f.event),console.table(i)}}var e,f;return a("dataEvent",d),{setters:[function(a){e=a.debug}],execute:function(){f={event:"color: red; font-size: 18px"}}}}),System.register("theatlantic/js/legacy.js",["usertiming","css","whatwg-fetch","regenerator-runtime/runtime","nunjucks/browser/nunjucks-slim","./utils/polyfills","./utils/log","./utils/endpoints","./utils/user","./utils/namespace","./utils/lazysizes","./utils/ads","./paywall/paywall.js","./paywall/meter","./components/breaking-news","./lacroix/components/footer","./components/leaflet","./components/navigation","./components/circ-promo","./lacroix/components/navigation","./lacroix/components/share-social","./utils/events"],function(a,b){"use strict";var c;return{setters:[function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){},function(a){c=a.dataEvent}],execute:function(){window.Atlantic.Utils=window.Atlantic.Utils||{},window.Atlantic.Utils.customEvent=c}}}),function(a){var b=document.createElement("style");b.type="text/css",b.styleSheet?b.styleSheet.cssText=a:b.appendChild(document.createTextNode(a)),(document.head||document.getElementsByTagName("head")[0]).appendChild(b)}('.c-ad.ad-loaded--standard::before,.c-ad.ad-loaded--responsive::before{font-size:10px;font-family:-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Segoe UI,Arial,sans-serif;display:block;color:#5e6a74;content:\'Advertisement\';font-family:"Graphik",-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Segoe UI,Arial,sans-serif;letter-spacing:.5px;padding-bottom:4px;text-align:center;text-transform:uppercase}.no-js .c-ad.ad-loaded--standard::before,.fonts-loaded .c-ad.ad-loaded--standard::before,.no-js .c-ad.ad-loaded--responsive::before,.fonts-loaded .c-ad.ad-loaded--responsive::before{font-family:"Graphik",-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Segoe UI,Arial,sans-serif}.ad-boxrr-wrapper .c-ad.ad-loaded{margin-bottom:64px;position:relative}.ad-boxrr-wrapper .c-ad.ad-loaded::before{content:none}.c-ad.c-ad--full-width.ad-loaded--standard,.c-ad.c-ad--full-width.ad-loaded--responsive{left:calc(50% + 0px);margin-left:calc(-50vw - 0px);margin-right:calc(-50vw - 0px);position:relative;right:calc(50% + 0px);width:calc(100vw - 0px)}.c-ad.c-ad--full-width.ad-loaded--standard::before,.c-ad.c-ad--full-width.ad-loaded--standard::after,.c-ad.c-ad--full-width.ad-loaded--responsive::before,.c-ad.c-ad--full-width.ad-loaded--responsive::after{border-top:1px solid #d3dce6;margin-left:auto;margin-right:auto;max-width:1280px;width:calc(100% - 32px)}.c-ad.c-ad--full-width.ad-loaded--standard::before,.c-ad.c-ad--full-width.ad-loaded--responsive::before{padding-top:16px}.c-ad.c-ad--full-width.ad-loaded--standard::after,.c-ad.c-ad--full-width.ad-loaded--responsive::after{content:\'\';display:block;height:0;margin-top:16px}.c-ad.c-ad--article-width.ad-loaded--standard,.c-ad.c-ad--article-width.ad-loaded--responsive{left:calc(50% + 0px);margin-left:calc(-50vw - 0px);margin-right:calc(-50vw - 0px);position:relative;right:calc(50% + 0px);width:calc(100vw - 0px);clear:both}@media (min-width: 576px){.c-ad.c-ad--article-width.ad-loaded--standard,.c-ad.c-ad--article-width.ad-loaded--responsive{left:calc(50% + 32px);margin-left:calc(-50vw - 16px);margin-right:calc(-50vw - 16px);position:relative;right:calc(50% + 32px);width:calc(100vw - 32px)}}.c-ad.c-ad--article-width.ad-loaded--standard::before,.c-ad.c-ad--article-width.ad-loaded--standard::after,.c-ad.c-ad--article-width.ad-loaded--responsive::before,.c-ad.c-ad--article-width.ad-loaded--responsive::after{border-top:1px solid #d3dce6;margin-left:auto;margin-right:auto;max-width:1036px;width:calc(100% - 32px)}.c-ad.c-ad--article-width.ad-loaded--standard::before,.c-ad.c-ad--article-width.ad-loaded--responsive::before{padding-top:16px}.c-ad.c-ad--article-width.ad-loaded--standard::after,.c-ad.c-ad--article-width.ad-loaded--responsive::after{content:\'\';display:block;height:0;margin-top:16px}.c-ad.c-ad--house.ad-loaded--house{left:calc(50% + 0px);margin-left:calc(-50vw - 0px);margin-right:calc(-50vw - 0px);position:relative;right:calc(50% + 0px);width:calc(100vw - 0px)}@media (min-width: 576px){.c-ad.c-ad--house.ad-loaded--house{left:auto;margin-left:auto;margin-right:auto;position:static;right:auto;width:auto}}.c-ad.c-ad--unlabeled .ad-loaded::before{content:none}.c-ad--full-width.ad-loaded{margin-bottom:1.77778em;margin-top:1.77778em}\n.c-bottom-persistent-ad{background:#fff;border-top:1px solid #d3dce6;bottom:0;display:-ms-flexbox;display:flex;height:58px;-ms-flex-pack:distribute;justify-content:space-around;left:0;position:fixed;transition:bottom 250ms ease-out;width:100%;z-index:4000000}@media (min-width: 976px){.c-bottom-persistent-ad{height:100px}}.c-bottom-persistent-ad--hidden{bottom:-90px}@media (min-width: 976px){.c-bottom-persistent-ad--hidden{bottom:-100px}}.c-bottom-persistent-ad__button{background:#fff;border-left:1px solid #d3dce6;border-radius:4px 0 0 0;border-top:1px solid #d3dce6;cursor:pointer;height:32px;padding:8px;position:absolute;right:0;text-align:center;top:-32px;width:32px}.c-bottom-persistent-ad__button:hover{fill:#e3e9ef}@media (min-width: 784px){.c-bottom-persistent-ad__button{background:transparent;border:0;height:16px;margin:8px 16px;padding:0;top:0;width:32px}}.c-bottom-persistent-ad__close-icon{display:block;height:16px;width:16px}.c-bottom-persistent-ad gpt-ad{-ms-flex-item-align:center;-ms-grid-row-align:center;align-self:center;max-width:728px;width:100%}\n.c-footer{font-size:16px;font-family:-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Segoe UI,Arial,sans-serif;background-color:#000;color:#fff;font-family:"Graphik",-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Segoe UI,Arial,sans-serif;padding:0 16px 32px}.no-js .c-footer,.fonts-loaded .c-footer{font-family:"Graphik",-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Segoe UI,Arial,sans-serif}.c-footer.lazyloaded{opacity:1}@media (min-width: 784px){.c-footer{font-size:14px;padding:32px 32px 48px}}.c-footer__container{margin:0 auto;max-width:1036px}.c-footer__nav--top{margin-bottom:32px}@media (min-width: 784px){.c-footer__nav--top{border-bottom:1px solid #fff;margin-bottom:16px;padding-bottom:32px}}.c-footer__nav--bottom{font-size:10px;letter-spacing:.25px}.c-footer__section{border-bottom:1px solid #fff}@media (min-width: 784px){.c-footer__section{border-bottom:0}}.c-footer__section-title{font-size:14px;-ms-flex-align:center;align-items:center;cursor:pointer;display:-ms-flexbox;display:flex;font-weight:700;-ms-flex-pack:justify;justify-content:space-between;letter-spacing:.5px;padding:24px 0;text-transform:uppercase}.c-footer__section-title::after{border-color:#fff;border-style:solid;border-width:0 0 1px 1px;content:\'\';height:8px;margin-right:4px;transform:rotateX(0) rotateZ(-45deg);transform-origin:center center;transition:transform 500ms linear;width:8px}@media (min-width: 784px){.c-footer__section-title::after{content:normal}}.no-js .c-footer__section-title::after{transform:rotateX(180deg) rotateZ(-45deg)}@media (min-width: 784px){.c-footer__section-title{font-size:12px;cursor:auto;margin-bottom:16px;padding:0}}.c-footer__section-title.is-open::after{transform:rotateX(180deg) rotateZ(-45deg);transition:transform 250ms linear}.c-footer__section-title.is-open+.c-footer__secondary{max-height:300px;transition:max-height 500ms linear}.c-footer__secondary{max-height:0;overflow:hidden;transition:max-height 250ms linear}@media (min-width: 784px){.c-footer__secondary{max-height:none}}.no-js .c-footer__secondary{max-height:none}.c-footer__list{list-style:none;margin:0;padding:0}@media (min-width: 784px){.c-footer__list--top{display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}}.c-footer__list--secondary{margin:0 16px 24px}@media (min-width: 784px){.c-footer__list--secondary{margin:0}}.c-footer__list--follow{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;height:16px;-ms-flex-pack:justify;justify-content:space-between}.c-footer__list--follow:not(:last-child){margin-bottom:24px}.c-footer__item{line-height:1.25}.c-footer__item--top:not(:last-child){margin-bottom:16px}.c-footer__item--bottom{display:inline-block;margin-bottom:8px;line-height:1.125}.c-footer__item--bottom:not(:last-child){border-right:1px solid #fff;margin-right:8px;padding-right:8px}.c-footer__item--follow:not(:last-child){margin-right:24px}.c-footer__link{color:#fff;fill:#fff}.c-footer__link:hover{color:#5e6a74;fill:#5e6a74}.c-footer__bottom{text-align:center}@media (min-width: 1200px){.c-footer__bottom{-ms-flex-align:center;align-items:center;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-ms-flex-pack:justify;justify-content:space-between;text-align:left}}.c-footer__bottom-info{margin:0 0 32px}@media (min-width: 1200px){.c-footer__bottom-info{margin:0}}.c-footer__copyright{font-size:10px;margin:0}.c-footer__logo{height:32px;margin:0 auto}@media (min-width: 1200px){.c-footer__logo{margin:0}}.c-footer__icon{height:16px;width:16px}.c-nav__atlantic-wordmark--lacroix svg{fill:#fff}.c-footer__logo-image{fill:#fff;width:136px;height:22px}\n@keyframes bounce{0%,100%{transform:scale(0)}50%{transform:scale(1)}}.l-form__group{margin-bottom:16px}.l-form--inline{display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.l-form--inline .l-form__group{display:inline-block;margin-bottom:0;margin-right:16px;vertical-align:top;width:auto}.c-btn{font-size:14px;font-family:-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Segoe UI,Arial,sans-serif;-ms-flex-align:center;align-items:center;background-color:#000;border:1px solid #000;border-radius:4px;color:#fff;display:-ms-inline-flexbox;display:inline-flex;font-weight:400;line-height:1.25;padding:8px 16px 10px;text-decoration:none;transition:all 150ms}.no-js .c-btn,.fonts-loaded .c-btn{font-family:"Graphik",-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Segoe UI,Arial,sans-serif}.c-btn:hover{background-color:#39434b;border-color:#39434b;transition:all 300ms}.c-btn--small{font-size:14px;letter-spacing:-.25px;padding:7px 12px}.c-btn--large{padding:16px 24px}.c-btn--block{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;width:100%}.c-btn--red{background-color:#e7131a;border-color:#e7131a}.c-btn--red:hover{background-color:#cf0e3a;border-color:#cf0e3a}.c-btn--blue{background-color:#0097ac;border-color:#0097ac}.c-btn--blue:hover{background-color:#006A79;border-color:#006A79}.c-btn--limed-spruce{background-color:#39434b;border-color:#39434b}.c-btn--limed-spruce:hover{background-color:#20272c;border-color:#20272c}.c-btn--white{background-color:#fff;border-color:#fff;color:#000}.c-btn--white:hover{background-color:#eff2f7;border-color:#eff2f7}.c-btn--border{border:1px solid #c0ccda}.c-btn--link{background-color:transparent;border-color:transparent;color:#000}.c-btn--link:hover{background-color:transparent;border-color:transparent;text-decoration:underline}.c-btn__icon{fill:#fff;height:16px;margin-right:8px;width:16px}.c-btn__icon--facebook{background-color:#395185}.c-btn__icon--facebook:hover{background-color:#2d4373}.c-btn__icon--google{background-color:#4285f4}.c-btn__icon--google:hover{background-color:#1266f1}.c-input{font-size:14px;font-family:-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Segoe UI,Arial,sans-serif;box-sizing:border-box;background-clip:padding-box;background-color:#fff;border:1px solid #c0ccda;border-radius:4px;color:#000;display:inline-block;line-height:1.25;padding:8px 16px 10px;transition:border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s}.no-js .c-input,.fonts-loaded .c-input{font-family:"Graphik",-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Segoe UI,Arial,sans-serif}.c-input::-webkit-input-placeholder{color:#5e6a74}.c-input::-moz-placeholder{color:#5e6a74}.c-input:-ms-input-placeholder{color:#5e6a74}.c-input:focus{border-color:#31c6cc;box-shadow:0 0 0 3px rgba(49,198,204,0.25);outline:0}.c-input:disabled,.c-input[readonly]{background-color:#e7e7e7;cursor:not-allowed}.was-validated .c-input:valid,.was-validated .c-input.is-valid,.c-input.is-valid{border-color:#038768;box-shadow:none}.was-validated .c-input:valid:focus,.was-validated .c-input.is-valid:focus,.c-input.is-valid:focus{box-shadow:0 0 0 3px rgba(3,135,104,0.25)}.was-validated .c-input:valid ~ .c-feedback--valid,.was-validated .c-input.is-valid ~ .c-feedback--valid,.c-input.is-valid ~ .c-feedback--valid{display:block}.was-validated .c-input:valid ~ .c-helper-text,.was-validated .c-input.is-valid ~ .c-helper-text,.c-input.is-valid ~ .c-helper-text{display:none}.was-validated .c-input:invalid,.was-validated .c-input.is-invalid,.c-input.is-invalid{border-color:#e7131a;box-shadow:none}.was-validated .c-input:invalid:focus,.was-validated .c-input.is-invalid:focus,.c-input.is-invalid:focus{box-shadow:0 0 0 3px rgba(231,19,26,0.25)}.was-validated .c-input:invalid ~ .c-feedback--invalid,.was-validated .c-input.is-invalid ~ .c-feedback--invalid,.c-input.is-invalid ~ .c-feedback--invalid{display:block}.was-validated .c-input:invalid ~ .c-helper-text,.was-validated .c-input.is-invalid ~ .c-helper-text,.c-input.is-invalid ~ .c-helper-text{display:none}.c-input--block{display:block;width:100%}.c-input--small{font-size:14px;padding:7px 12px}.c-input--large{padding:16px}.c-helper-text{font-size:14px;font-family:-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Segoe UI,Arial,sans-serif;color:#5e6a74;display:block;margin-top:4px}.no-js .c-helper-text,.fonts-loaded .c-helper-text{font-family:"Graphik",-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Segoe UI,Arial,sans-serif}.c-feedback{font-size:14px;font-family:-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Segoe UI,Arial,sans-serif;display:none;margin-top:4px}.no-js .c-feedback,.fonts-loaded .c-feedback{font-family:"Graphik",-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Segoe UI,Arial,sans-serif}.c-feedback--valid{color:#038768}.c-feedback--invalid{color:#e7131a}.c-leaflets{background-color:#fff;margin-bottom:0;padding:16px 16px 32px}@media (min-width: 784px){.c-leaflets{background-color:transparent;margin:0 auto;max-width:1036px;padding:0 0 32px}}.l-article-recirc .c-leaflets{padding-left:0;padding-right:0}.video-channel .c-leaflets{padding:16px 16px 32px}@media (min-width: 784px){.video-channel .c-leaflets{padding:0 32px 32px}}.c-leaflet__link{color:#000}.c-leaflets__container{border-top:1px solid #000;overflow:hidden}@media (min-width: 784px){.c-leaflets__container{display:-ms-flexbox;display:flex;padding-top:16px}}.c-leaflet{font-size:16px;font-family:-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Segoe UI,Arial,sans-serif;display:-ms-flexbox;display:flex;font-family:"Graphik",-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Segoe UI,Arial,sans-serif;padding:16px 0 0;position:relative}.no-js .c-leaflet,.fonts-loaded .c-leaflet{font-family:"Graphik",-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Segoe UI,Arial,sans-serif}@media (min-width: 784px){.c-leaflet{padding:0}}.c-leaflet:not(:last-child){border-bottom:1px solid #d3dce6;padding-bottom:16px}@media (min-width: 784px){.c-leaflet:not(:last-child){border-bottom:none;border-right:1px solid #d3dce6;margin-right:16px;padding-bottom:0;padding-right:16px}}@media (min-width: 976px){.c-leaflet:not(:last-child){margin-right:32px;padding-right:32px}}@media (min-width: 976px){.c-leaflet:last-child{-ms-flex-preferred-size:300px;flex-basis:300px;-ms-flex-negative:0;flex-shrink:0;min-width:300px}}.c-leaflet__title{font-size:24px;font-family:-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Segoe UI,Arial,sans-serif;letter-spacing:1px;line-height:1;font-weight:600;margin:0 0 8px}.no-js .c-leaflet__title,.fonts-loaded .c-leaflet__title{font-family:"Graphik",-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Segoe UI,Arial,sans-serif}.c-leaflet__title--sign-up{letter-spacing:.25px}.is-successful .c-leaflet__content--sign-up{opacity:0;transition:opacity 500ms}.c-leaflet__content--subscribe{-ms-flex-positive:1;flex-grow:1}.c-leaflet__content--image{margin-left:16px;min-width:80px}.c-leaflet__frame{background-color:#c0ccda;padding-bottom:107px}.c-leaflet__image{height:100%;left:0;position:absolute;top:0;width:100%;border:1px solid rgba(0,0,0,0.1);display:block;opacity:0;transition:opacity 500ms}.c-leaflet__image.lazyloaded{opacity:1}.c-leaflet__description{color:#39434b;line-height:1.25;margin:0 0 8px}.c-leaflet__description--sign-up{margin-bottom:20px}.c-leaflet__form{-ms-flex-wrap:nowrap;flex-wrap:nowrap}.c-leaflet__subscribe{font-size:10px;font-weight:600;letter-spacing:.25px;line-height:1;margin:0;text-transform:uppercase}.c-leaflet__input{-ms-flex-positive:1;flex-grow:1;font-size:14px;margin-right:16px}.c-leaflet__link--newsletters{text-decoration:underline}.c-leaflet__link--newsletters:hover{transition:color 0.3s;color:#5e6a74}.c-leaflet__link--subscribe{-ms-flex-align:center;align-items:center;border-color:#000;display:-ms-flexbox;display:flex}.c-leaflet__link--subscribe::after{border-style:solid;border-width:0 2px 2px 0;content:\'\';display:inline-block;height:6px;margin-left:4px;transform:rotateZ(-45deg);transform-origin:center center;width:6px}.c-leaflet__link--subscribe:hover{border-color:#5e6a74;color:#5e6a74}.c-leaflet__btn{font-size:14px;position:relative}.c-leaflet__btn:disabled{color:transparent}@media (min-width: 976px){.c-leaflet__btn{padding-left:48px;padding-right:48px}}.c-leaflet__submit-loader{display:block;height:1.5em;margin:0 auto;transform:translate(-50%, -50%);transition:opacity 0.3s ease;width:1.5em;z-index:2;display:none;left:0;position:absolute;right:0;top:50%}.c-leaflet__submit-loader::before,.c-leaflet__submit-loader::after{animation:bounce 2s infinite ease-in-out;background-color:#999;border-radius:50%;content:\'\';height:100%;opacity:0.6;position:absolute;width:100%}.c-leaflet__submit-loader::after{animation-delay:1s}.is-submitting .c-leaflet__submit-loader{display:block}.c-leaflet__checkmark{margin:0 auto 8px}.is-failure .c-leaflet__feedback{display:block}.c-leaflet__confirmation{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;height:100%;-ms-flex-pack:center;justify-content:center;left:50%;line-height:1.25;opacity:0;padding:16px;pointer-events:none;position:absolute;text-align:center;top:50%;transform:translate3d(-50%, -75%, 0);transition:all 0.3s ease;transition-delay:0.35s;width:100%;z-index:1}@media (min-width: 576px){.c-leaflet__confirmation{padding:24px}}.is-successful .c-leaflet__confirmation{background-color:white;opacity:1;pointer-events:auto;transform:translate3d(-50%, -50%, 0);z-index:2}.c-leaflet__confirmation>*{max-width:100%}.c-leaflet__confirmation-title{font-weight:600;letter-spacing:.25px;margin:0}\n');
//# sourceMappingURL=legacy.js.map
;/*! picturefill - v3.0.2 - 2016-02-12
 * https://scottjehl.github.io/picturefill/
 * Copyright (c) 2016 https://github.com/scottjehl/picturefill/blob/master/Authors.txt; Licensed MIT
 */
/*! Gecko-Picture - v1.0
 * https://github.com/scottjehl/picturefill/tree/3.0/src/plugins/gecko-picture
 * Firefox's early picture implementation (prior to FF41) is static and does
 * not react to viewport changes. This tiny module fixes this.
 */
(function(window) {
    /*jshint eqnull:true */
    var ua = navigator.userAgent;

    if ( window.HTMLPictureElement && ((/ecko/).test(ua) && ua.match(/rv\:(\d+)/) && RegExp.$1 < 45) ) {
        addEventListener("resize", (function() {
            var timer;

            var dummySrc = document.createElement("source");

            var fixRespimg = function(img) {
                var source, sizes;
                var picture = img.parentNode;

                if (picture.nodeName.toUpperCase() === "PICTURE") {
                    source = dummySrc.cloneNode();

                    picture.insertBefore(source, picture.firstElementChild);
                    setTimeout(function() {
                        picture.removeChild(source);
                    });
                } else if (!img._pfLastSize || img.offsetWidth > img._pfLastSize) {
                    img._pfLastSize = img.offsetWidth;
                    sizes = img.sizes;
                    img.sizes += ",100vw";
                    setTimeout(function() {
                        img.sizes = sizes;
                    });
                }
            };

            var findPictureImgs = function() {
                var i;
                var imgs = document.querySelectorAll("picture > img, img[srcset][sizes]");
                for (i = 0; i < imgs.length; i++) {
                    fixRespimg(imgs[i]);
                }
            };
            var onResize = function() {
                clearTimeout(timer);
                timer = setTimeout(findPictureImgs, 99);
            };
            var mq = window.matchMedia && matchMedia("(orientation: landscape)");
            var init = function() {
                onResize();

                if (mq && mq.addListener) {
                    mq.addListener(onResize);
                }
            };

            dummySrc.srcset = "data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";

            if (/^[c|i]|d$/.test(document.readyState || "")) {
                init();
            } else {
                document.addEventListener("DOMContentLoaded", init);
            }

            return onResize;
        })());
    }
})(window);

/*! Picturefill - v3.0.2
 * http://scottjehl.github.io/picturefill
 * Copyright (c) 2015 https://github.com/scottjehl/picturefill/blob/master/Authors.txt;
 *  License: MIT
 */

(function( window, document, undefined ) {
    // Enable strict mode
    "use strict";

    // HTML shim|v it for old IE (IE9 will still need the HTML video tag workaround)
    document.createElement( "picture" );

    var warn, eminpx, alwaysCheckWDescriptor, evalId;
    // local object for method references and testing exposure
    var pf = {};
    var isSupportTestReady = false;
    var noop = function() {};
    var image = document.createElement( "img" );
    var getImgAttr = image.getAttribute;
    var setImgAttr = image.setAttribute;
    var removeImgAttr = image.removeAttribute;
    var docElem = document.documentElement;
    var types = {};
    var cfg = {
        //resource selection:
        algorithm: ""
    };
    var srcAttr = "data-pfsrc";
    var srcsetAttr = srcAttr + "set";
    // ua sniffing is done for undetectable img loading features,
    // to do some non crucial perf optimizations
    var ua = navigator.userAgent;
    var supportAbort = (/rident/).test(ua) || ((/ecko/).test(ua) && ua.match(/rv\:(\d+)/) && RegExp.$1 > 35 );
    var curSrcProp = "currentSrc";
    var regWDesc = /\s+\+?\d+(e\d+)?w/;
    var regSize = /(\([^)]+\))?\s*(.+)/;
    var setOptions = window.picturefillCFG;
    /**
     * Shortcut property for https://w3c.github.io/webappsec/specs/mixedcontent/#restricts-mixed-content ( for easy overriding in tests )
     */
    // baseStyle also used by getEmValue (i.e.: width: 1em is important)
    var baseStyle = "position:absolute;left:0;visibility:hidden;display:block;padding:0;border:none;font-size:1em;width:1em;overflow:hidden;clip:rect(0px, 0px, 0px, 0px)";
    var fsCss = "font-size:100%!important;";
    var isVwDirty = true;

    var cssCache = {};
    var sizeLengthCache = {};
    var DPR = window.devicePixelRatio;
    var units = {
        px: 1,
        "in": 96
    };
    var anchor = document.createElement( "a" );
    /**
     * alreadyRun flag used for setOptions. is it true setOptions will reevaluate
     * @type {boolean}
     */
    var alreadyRun = false;

    // Reusable, non-"g" Regexes

    // (Don't use \s, to avoid matching non-breaking space.)
    var regexLeadingSpaces = /^[ \t\n\r\u000c]+/,
        regexLeadingCommasOrSpaces = /^[, \t\n\r\u000c]+/,
        regexLeadingNotSpaces = /^[^ \t\n\r\u000c]+/,
        regexTrailingCommas = /[,]+$/,
        regexNonNegativeInteger = /^\d+$/,

        // ( Positive or negative or unsigned integers or decimals, without or without exponents.
        // Must include at least one digit.
        // According to spec tests any decimal point must be followed by a digit.
        // No leading plus sign is allowed.)
        // https://html.spec.whatwg.org/multipage/infrastructure.html#valid-floating-point-number
        regexFloatingPoint = /^-?(?:[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?$/;

    var on = function(obj, evt, fn, capture) {
        if ( obj.addEventListener ) {
            obj.addEventListener(evt, fn, capture || false);
        } else if ( obj.attachEvent ) {
            obj.attachEvent( "on" + evt, fn);
        }
    };

    /**
     * simple memoize function:
     */

    var memoize = function(fn) {
        var cache = {};
        return function(input) {
            if ( !(input in cache) ) {
                cache[ input ] = fn(input);
            }
            return cache[ input ];
        };
    };

    // UTILITY FUNCTIONS

    // Manual is faster than RegEx
    // http://jsperf.com/whitespace-character/5
    function isSpace(c) {
        return (c === "\u0020" || // space
                c === "\u0009" || // horizontal tab
                c === "\u000A" || // new line
                c === "\u000C" || // form feed
                c === "\u000D");  // carriage return
    }

    /**
     * gets a mediaquery and returns a boolean or gets a css length and returns a number
     * @param css mediaqueries or css length
     * @returns {boolean|number}
     *
     * based on: https://gist.github.com/jonathantneal/db4f77009b155f083738
     */
    var evalCSS = (function() {

        var regLength = /^([\d\.]+)(em|vw|px)$/;
        var replace = function() {
            var args = arguments, index = 0, string = args[0];
            while (++index in args) {
                string = string.replace(args[index], args[++index]);
            }
            return string;
        };

        var buildStr = memoize(function(css) {

            return "return " + replace((css || "").toLowerCase(),
                // interpret `and`
                /\band\b/g, "&&",

                // interpret `,`
                /,/g, "||",

                // interpret `min-` as >=
                /min-([a-z-\s]+):/g, "e.$1>=",

                // interpret `max-` as <=
                /max-([a-z-\s]+):/g, "e.$1<=",

                //calc value
                /calc([^)]+)/g, "($1)",

                // interpret css values
                /(\d+[\.]*[\d]*)([a-z]+)/g, "($1 * e.$2)",
                //make eval less evil
                /^(?!(e.[a-z]|[0-9\.&=|><\+\-\*\(\)\/])).*/ig, ""
            ) + ";";
        });

        return function(css, length) {
            var parsedLength;
            if (!(css in cssCache)) {
                cssCache[css] = false;
                if (length && (parsedLength = css.match( regLength ))) {
                    cssCache[css] = parsedLength[ 1 ] * units[parsedLength[ 2 ]];
                } else {
                    /*jshint evil:true */
                    try{
                        cssCache[css] = new Function("e", buildStr(css))(units);
                    } catch(e) {}
                    /*jshint evil:false */
                }
            }
            return cssCache[css];
        };
    })();

    var setResolution = function( candidate, sizesattr ) {
        if ( candidate.w ) { // h = means height: || descriptor.type === 'h' do not handle yet...
            candidate.cWidth = pf.calcListLength( sizesattr || "100vw" );
            candidate.res = candidate.w / candidate.cWidth ;
        } else {
            candidate.res = candidate.d;
        }
        return candidate;
    };

    /**
     *
     * @param opt
     */
    var picturefill = function( opt ) {

        if (!isSupportTestReady) {return;}

        var elements, i, plen;

        var options = opt || {};

        if ( options.elements && options.elements.nodeType === 1 ) {
            if ( options.elements.nodeName.toUpperCase() === "IMG" ) {
                options.elements =  [ options.elements ];
            } else {
                options.context = options.elements;
                options.elements =  null;
            }
        }

        elements = options.elements || pf.qsa( (options.context || document), ( options.reevaluate || options.reselect ) ? pf.sel : pf.selShort );

        if ( (plen = elements.length) ) {

            pf.setupRun( options );
            alreadyRun = true;

            // Loop through all elements
            for ( i = 0; i < plen; i++ ) {
                pf.fillImg(elements[ i ], options);
            }

            pf.teardownRun( options );
        }
    };

    /**
     * outputs a warning for the developer
     * @param {message}
     * @type {Function}
     */
    warn = ( window.console && console.warn ) ?
        function( message ) {
            console.warn( message );
        } :
        noop
    ;

    if ( !(curSrcProp in image) ) {
        curSrcProp = "src";
    }

    // Add support for standard mime types.
    types[ "image/jpeg" ] = true;
    types[ "image/gif" ] = true;
    types[ "image/png" ] = true;

    function detectTypeSupport( type, typeUri ) {
        // based on Modernizr's lossless img-webp test
        // note: asynchronous
        var image = new window.Image();
        image.onerror = function() {
            types[ type ] = false;
            picturefill();
        };
        image.onload = function() {
            types[ type ] = image.width === 1;
            picturefill();
        };
        image.src = typeUri;
        return "pending";
    }

    // test svg support
    types[ "image/svg+xml" ] = document.implementation.hasFeature( "http://www.w3.org/TR/SVG11/feature#Image", "1.1" );

    /**
     * updates the internal vW property with the current viewport width in px
     */
    function updateMetrics() {

        isVwDirty = false;
        DPR = window.devicePixelRatio;
        cssCache = {};
        sizeLengthCache = {};

        pf.DPR = DPR || 1;

        units.width = Math.max(window.innerWidth || 0, docElem.clientWidth);
        units.height = Math.max(window.innerHeight || 0, docElem.clientHeight);

        units.vw = units.width / 100;
        units.vh = units.height / 100;

        evalId = [ units.height, units.width, DPR ].join("-");

        units.em = pf.getEmValue();
        units.rem = units.em;
    }

    function chooseLowRes( lowerValue, higherValue, dprValue, isCached ) {
        var bonusFactor, tooMuch, bonus, meanDensity;

        //experimental
        if (cfg.algorithm === "saveData" ){
            if ( lowerValue > 2.7 ) {
                meanDensity = dprValue + 1;
            } else {
                tooMuch = higherValue - dprValue;
                bonusFactor = Math.pow(lowerValue - 0.6, 1.5);

                bonus = tooMuch * bonusFactor;

                if (isCached) {
                    bonus += 0.1 * bonusFactor;
                }

                meanDensity = lowerValue + bonus;
            }
        } else {
            meanDensity = (dprValue > 1) ?
                Math.sqrt(lowerValue * higherValue) :
                lowerValue;
        }

        return meanDensity > dprValue;
    }

    function applyBestCandidate( img ) {
        var srcSetCandidates;
        var matchingSet = pf.getSet( img );
        var evaluated = false;
        if ( matchingSet !== "pending" ) {
            evaluated = evalId;
            if ( matchingSet ) {
                srcSetCandidates = pf.setRes( matchingSet );
                pf.applySetCandidate( srcSetCandidates, img );
            }
        }
        img[ pf.ns ].evaled = evaluated;
    }

    function ascendingSort( a, b ) {
        return a.res - b.res;
    }

    function setSrcToCur( img, src, set ) {
        var candidate;
        if ( !set && src ) {
            set = img[ pf.ns ].sets;
            set = set && set[set.length - 1];
        }

        candidate = getCandidateForSrc(src, set);

        if ( candidate ) {
            src = pf.makeUrl(src);
            img[ pf.ns ].curSrc = src;
            img[ pf.ns ].curCan = candidate;

            if ( !candidate.res ) {
                setResolution( candidate, candidate.set.sizes );
            }
        }
        return candidate;
    }

    function getCandidateForSrc( src, set ) {
        var i, candidate, candidates;
        if ( src && set ) {
            candidates = pf.parseSet( set );
            src = pf.makeUrl(src);
            for ( i = 0; i < candidates.length; i++ ) {
                if ( src === pf.makeUrl(candidates[ i ].url) ) {
                    candidate = candidates[ i ];
                    break;
                }
            }
        }
        return candidate;
    }

    function getAllSourceElements( picture, candidates ) {
        var i, len, source, srcset;

        // SPEC mismatch intended for size and perf:
        // actually only source elements preceding the img should be used
        // also note: don't use qsa here, because IE8 sometimes doesn't like source as the key part in a selector
        var sources = picture.getElementsByTagName( "source" );

        for ( i = 0, len = sources.length; i < len; i++ ) {
            source = sources[ i ];
            source[ pf.ns ] = true;
            srcset = source.getAttribute( "srcset" );

            // if source does not have a srcset attribute, skip
            if ( srcset ) {
                candidates.push( {
                    srcset: srcset,
                    media: source.getAttribute( "media" ),
                    type: source.getAttribute( "type" ),
                    sizes: source.getAttribute( "sizes" )
                } );
            }
        }
    }

    /**
     * Srcset Parser
     * By Alex Bell |  MIT License
     *
     * @returns Array [{url: _, d: _, w: _, h:_, set:_(????)}, ...]
     *
     * Based super duper closely on the reference algorithm at:
     * https://html.spec.whatwg.org/multipage/embedded-content.html#parse-a-srcset-attribute
     */

    // 1. Let input be the value passed to this algorithm.
    // (TO-DO : Explain what "set" argument is here. Maybe choose a more
    // descriptive & more searchable name.  Since passing the "set" in really has
    // nothing to do with parsing proper, I would prefer this assignment eventually
    // go in an external fn.)
    function parseSrcset(input, set) {

        function collectCharacters(regEx) {
            var chars,
                match = regEx.exec(input.substring(pos));
            if (match) {
                chars = match[ 0 ];
                pos += chars.length;
                return chars;
            }
        }

        var inputLength = input.length,
            url,
            descriptors,
            currentDescriptor,
            state,
            c,

            // 2. Let position be a pointer into input, initially pointing at the start
            //    of the string.
            pos = 0,

            // 3. Let candidates be an initially empty source set.
            candidates = [];

        /**
        * Adds descriptor properties to a candidate, pushes to the candidates array
        * @return undefined
        */
        // (Declared outside of the while loop so that it's only created once.
        // (This fn is defined before it is used, in order to pass JSHINT.
        // Unfortunately this breaks the sequencing of the spec comments. :/ )
        function parseDescriptors() {

            // 9. Descriptor parser: Let error be no.
            var pError = false,

            // 10. Let width be absent.
            // 11. Let density be absent.
            // 12. Let future-compat-h be absent. (We're implementing it now as h)
                w, d, h, i,
                candidate = {},
                desc, lastChar, value, intVal, floatVal;

            // 13. For each descriptor in descriptors, run the appropriate set of steps
            // from the following list:
            for (i = 0 ; i < descriptors.length; i++) {
                desc = descriptors[ i ];

                lastChar = desc[ desc.length - 1 ];
                value = desc.substring(0, desc.length - 1);
                intVal = parseInt(value, 10);
                floatVal = parseFloat(value);

                // If the descriptor consists of a valid non-negative integer followed by
                // a U+0077 LATIN SMALL LETTER W character
                if (regexNonNegativeInteger.test(value) && (lastChar === "w")) {

                    // If width and density are not both absent, then let error be yes.
                    if (w || d) {pError = true;}

                    // Apply the rules for parsing non-negative integers to the descriptor.
                    // If the result is zero, let error be yes.
                    // Otherwise, let width be the result.
                    if (intVal === 0) {pError = true;} else {w = intVal;}

                // If the descriptor consists of a valid floating-point number followed by
                // a U+0078 LATIN SMALL LETTER X character
                } else if (regexFloatingPoint.test(value) && (lastChar === "x")) {

                    // If width, density and future-compat-h are not all absent, then let error
                    // be yes.
                    if (w || d || h) {pError = true;}

                    // Apply the rules for parsing floating-point number values to the descriptor.
                    // If the result is less than zero, let error be yes. Otherwise, let density
                    // be the result.
                    if (floatVal < 0) {pError = true;} else {d = floatVal;}

                // If the descriptor consists of a valid non-negative integer followed by
                // a U+0068 LATIN SMALL LETTER H character
                } else if (regexNonNegativeInteger.test(value) && (lastChar === "h")) {

                    // If height and density are not both absent, then let error be yes.
                    if (h || d) {pError = true;}

                    // Apply the rules for parsing non-negative integers to the descriptor.
                    // If the result is zero, let error be yes. Otherwise, let future-compat-h
                    // be the result.
                    if (intVal === 0) {pError = true;} else {h = intVal;}

                // Anything else, Let error be yes.
                } else {pError = true;}
            } // (close step 13 for loop)

            // 15. If error is still no, then append a new image source to candidates whose
            // URL is url, associated with a width width if not absent and a pixel
            // density density if not absent. Otherwise, there is a parse error.
            if (!pError) {
                candidate.url = url;

                if (w) { candidate.w = w;}
                if (d) { candidate.d = d;}
                if (h) { candidate.h = h;}
                if (!h && !d && !w) {candidate.d = 1;}
                if (candidate.d === 1) {set.has1x = true;}
                candidate.set = set;

                candidates.push(candidate);
            }
        } // (close parseDescriptors fn)

        /**
        * Tokenizes descriptor properties prior to parsing
        * Returns undefined.
        * (Again, this fn is defined before it is used, in order to pass JSHINT.
        * Unfortunately this breaks the logical sequencing of the spec comments. :/ )
        */
        function tokenize() {

            // 8.1. Descriptor tokeniser: Skip whitespace
            collectCharacters(regexLeadingSpaces);

            // 8.2. Let current descriptor be the empty string.
            currentDescriptor = "";

            // 8.3. Let state be in descriptor.
            state = "in descriptor";

            while (true) {

                // 8.4. Let c be the character at position.
                c = input.charAt(pos);

                //  Do the following depending on the value of state.
                //  For the purpose of this step, "EOF" is a special character representing
                //  that position is past the end of input.

                // In descriptor
                if (state === "in descriptor") {
                    // Do the following, depending on the value of c:

                  // Space character
                  // If current descriptor is not empty, append current descriptor to
                  // descriptors and let current descriptor be the empty string.
                  // Set state to after descriptor.
                    if (isSpace(c)) {
                        if (currentDescriptor) {
                            descriptors.push(currentDescriptor);
                            currentDescriptor = "";
                            state = "after descriptor";
                        }

                    // U+002C COMMA (,)
                    // Advance position to the next character in input. If current descriptor
                    // is not empty, append current descriptor to descriptors. Jump to the step
                    // labeled descriptor parser.
                    } else if (c === ",") {
                        pos += 1;
                        if (currentDescriptor) {
                            descriptors.push(currentDescriptor);
                        }
                        parseDescriptors();
                        return;

                    // U+0028 LEFT PARENTHESIS (()
                    // Append c to current descriptor. Set state to in parens.
                    } else if (c === "\u0028") {
                        currentDescriptor = currentDescriptor + c;
                        state = "in parens";

                    // EOF
                    // If current descriptor is not empty, append current descriptor to
                    // descriptors. Jump to the step labeled descriptor parser.
                    } else if (c === "") {
                        if (currentDescriptor) {
                            descriptors.push(currentDescriptor);
                        }
                        parseDescriptors();
                        return;

                    // Anything else
                    // Append c to current descriptor.
                    } else {
                        currentDescriptor = currentDescriptor + c;
                    }
                // (end "in descriptor"

                // In parens
                } else if (state === "in parens") {

                    // U+0029 RIGHT PARENTHESIS ())
                    // Append c to current descriptor. Set state to in descriptor.
                    if (c === ")") {
                        currentDescriptor = currentDescriptor + c;
                        state = "in descriptor";

                    // EOF
                    // Append current descriptor to descriptors. Jump to the step labeled
                    // descriptor parser.
                    } else if (c === "") {
                        descriptors.push(currentDescriptor);
                        parseDescriptors();
                        return;

                    // Anything else
                    // Append c to current descriptor.
                    } else {
                        currentDescriptor = currentDescriptor + c;
                    }

                // After descriptor
                } else if (state === "after descriptor") {

                    // Do the following, depending on the value of c:
                    // Space character: Stay in this state.
                    if (isSpace(c)) {

                    // EOF: Jump to the step labeled descriptor parser.
                    } else if (c === "") {
                        parseDescriptors();
                        return;

                    // Anything else
                    // Set state to in descriptor. Set position to the previous character in input.
                    } else {
                        state = "in descriptor";
                        pos -= 1;

                    }
                }

                // Advance position to the next character in input.
                pos += 1;

            // Repeat this step.
            } // (close while true loop)
        }

        // 4. Splitting loop: Collect a sequence of characters that are space
        //    characters or U+002C COMMA characters. If any U+002C COMMA characters
        //    were collected, that is a parse error.
        while (true) {
            collectCharacters(regexLeadingCommasOrSpaces);

            // 5. If position is past the end of input, return candidates and abort these steps.
            if (pos >= inputLength) {
                return candidates; // (we're done, this is the sole return path)
            }

            // 6. Collect a sequence of characters that are not space characters,
            //    and let that be url.
            url = collectCharacters(regexLeadingNotSpaces);

            // 7. Let descriptors be a new empty list.
            descriptors = [];

            // 8. If url ends with a U+002C COMMA character (,), follow these substeps:
            //      (1). Remove all trailing U+002C COMMA characters from url. If this removed
            //         more than one character, that is a parse error.
            if (url.slice(-1) === ",") {
                url = url.replace(regexTrailingCommas, "");
                // (Jump ahead to step 9 to skip tokenization and just push the candidate).
                parseDescriptors();

            //  Otherwise, follow these substeps:
            } else {
                tokenize();
            } // (close else of step 8)

        // 16. Return to the step labeled splitting loop.
        } // (Close of big while loop.)
    }

    /*
     * Sizes Parser
     *
     * By Alex Bell |  MIT License
     *
     * Non-strict but accurate and lightweight JS Parser for the string value <img sizes="here">
     *
     * Reference algorithm at:
     * https://html.spec.whatwg.org/multipage/embedded-content.html#parse-a-sizes-attribute
     *
     * Most comments are copied in directly from the spec
     * (except for comments in parens).
     *
     * Grammar is:
     * <source-size-list> = <source-size># [ , <source-size-value> ]? | <source-size-value>
     * <source-size> = <media-condition> <source-size-value>
     * <source-size-value> = <length>
     * http://www.w3.org/html/wg/drafts/html/master/embedded-content.html#attr-img-sizes
     *
     * E.g. "(max-width: 30em) 100vw, (max-width: 50em) 70vw, 100vw"
     * or "(min-width: 30em), calc(30vw - 15px)" or just "30vw"
     *
     * Returns the first valid <css-length> with a media condition that evaluates to true,
     * or "100vw" if all valid media conditions evaluate to false.
     *
     */

    function parseSizes(strValue) {

        // (Percentage CSS lengths are not allowed in this case, to avoid confusion:
        // https://html.spec.whatwg.org/multipage/embedded-content.html#valid-source-size-list
        // CSS allows a single optional plus or minus sign:
        // http://www.w3.org/TR/CSS2/syndata.html#numbers
        // CSS is ASCII case-insensitive:
        // http://www.w3.org/TR/CSS2/syndata.html#characters )
        // Spec allows exponential notation for <number> type:
        // http://dev.w3.org/csswg/css-values/#numbers
        var regexCssLengthWithUnits = /^(?:[+-]?[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?(?:ch|cm|em|ex|in|mm|pc|pt|px|rem|vh|vmin|vmax|vw)$/i;

        // (This is a quick and lenient test. Because of optional unlimited-depth internal
        // grouping parens and strict spacing rules, this could get very complicated.)
        var regexCssCalc = /^calc\((?:[0-9a-z \.\+\-\*\/\(\)]+)\)$/i;

        var i;
        var unparsedSizesList;
        var unparsedSizesListLength;
        var unparsedSize;
        var lastComponentValue;
        var size;

        // UTILITY FUNCTIONS

        //  (Toy CSS parser. The goals here are:
        //  1) expansive test coverage without the weight of a full CSS parser.
        //  2) Avoiding regex wherever convenient.
        //  Quick tests: http://jsfiddle.net/gtntL4gr/3/
        //  Returns an array of arrays.)
        function parseComponentValues(str) {
            var chrctr;
            var component = "";
            var componentArray = [];
            var listArray = [];
            var parenDepth = 0;
            var pos = 0;
            var inComment = false;

            function pushComponent() {
                if (component) {
                    componentArray.push(component);
                    component = "";
                }
            }

            function pushComponentArray() {
                if (componentArray[0]) {
                    listArray.push(componentArray);
                    componentArray = [];
                }
            }

            // (Loop forwards from the beginning of the string.)
            while (true) {
                chrctr = str.charAt(pos);

                if (chrctr === "") { // ( End of string reached.)
                    pushComponent();
                    pushComponentArray();
                    return listArray;
                } else if (inComment) {
                    if ((chrctr === "*") && (str[pos + 1] === "/")) { // (At end of a comment.)
                        inComment = false;
                        pos += 2;
                        pushComponent();
                        continue;
                    } else {
                        pos += 1; // (Skip all characters inside comments.)
                        continue;
                    }
                } else if (isSpace(chrctr)) {
                    // (If previous character in loop was also a space, or if
                    // at the beginning of the string, do not add space char to
                    // component.)
                    if ( (str.charAt(pos - 1) && isSpace( str.charAt(pos - 1) ) ) || !component ) {
                        pos += 1;
                        continue;
                    } else if (parenDepth === 0) {
                        pushComponent();
                        pos +=1;
                        continue;
                    } else {
                        // (Replace any space character with a plain space for legibility.)
                        chrctr = " ";
                    }
                } else if (chrctr === "(") {
                    parenDepth += 1;
                } else if (chrctr === ")") {
                    parenDepth -= 1;
                } else if (chrctr === ",") {
                    pushComponent();
                    pushComponentArray();
                    pos += 1;
                    continue;
                } else if ( (chrctr === "/") && (str.charAt(pos + 1) === "*") ) {
                    inComment = true;
                    pos += 2;
                    continue;
                }

                component = component + chrctr;
                pos += 1;
            }
        }

        function isValidNonNegativeSourceSizeValue(s) {
            if (regexCssLengthWithUnits.test(s) && (parseFloat(s) >= 0)) {return true;}
            if (regexCssCalc.test(s)) {return true;}
            // ( http://www.w3.org/TR/CSS2/syndata.html#numbers says:
            // "-0 is equivalent to 0 and is not a negative number." which means that
            // unitless zero and unitless negative zero must be accepted as special cases.)
            if ((s === "0") || (s === "-0") || (s === "+0")) {return true;}
            return false;
        }

        // When asked to parse a sizes attribute from an element, parse a
        // comma-separated list of component values from the value of the element's
        // sizes attribute (or the empty string, if the attribute is absent), and let
        // unparsed sizes list be the result.
        // http://dev.w3.org/csswg/css-syntax/#parse-comma-separated-list-of-component-values

        unparsedSizesList = parseComponentValues(strValue);
        unparsedSizesListLength = unparsedSizesList.length;

        // For each unparsed size in unparsed sizes list:
        for (i = 0; i < unparsedSizesListLength; i++) {
            unparsedSize = unparsedSizesList[i];

            // 1. Remove all consecutive <whitespace-token>s from the end of unparsed size.
            // ( parseComponentValues() already omits spaces outside of parens. )

            // If unparsed size is now empty, that is a parse error; continue to the next
            // iteration of this algorithm.
            // ( parseComponentValues() won't push an empty array. )

            // 2. If the last component value in unparsed size is a valid non-negative
            // <source-size-value>, let size be its value and remove the component value
            // from unparsed size. Any CSS function other than the calc() function is
            // invalid. Otherwise, there is a parse error; continue to the next iteration
            // of this algorithm.
            // http://dev.w3.org/csswg/css-syntax/#parse-component-value
            lastComponentValue = unparsedSize[unparsedSize.length - 1];

            if (isValidNonNegativeSourceSizeValue(lastComponentValue)) {
                size = lastComponentValue;
                unparsedSize.pop();
            } else {
                continue;
            }

            // 3. Remove all consecutive <whitespace-token>s from the end of unparsed
            // size. If unparsed size is now empty, return size and exit this algorithm.
            // If this was not the last item in unparsed sizes list, that is a parse error.
            if (unparsedSize.length === 0) {
                return size;
            }

            // 4. Parse the remaining component values in unparsed size as a
            // <media-condition>. If it does not parse correctly, or it does parse
            // correctly but the <media-condition> evaluates to false, continue to the
            // next iteration of this algorithm.
            // (Parsing all possible compound media conditions in JS is heavy, complicated,
            // and the payoff is unclear. Is there ever an situation where the
            // media condition parses incorrectly but still somehow evaluates to true?
            // Can we just rely on the browser/polyfill to do it?)
            unparsedSize = unparsedSize.join(" ");
            if (!(pf.matchesMedia( unparsedSize ) ) ) {
                continue;
            }

            // 5. Return size and exit this algorithm.
            return size;
        }

        // If the above algorithm exhausts unparsed sizes list without returning a
        // size value, return 100vw.
        return "100vw";
    }

    // namespace
    pf.ns = ("pf" + new Date().getTime()).substr(0, 9);

    // srcset support test
    pf.supSrcset = "srcset" in image;
    pf.supSizes = "sizes" in image;
    pf.supPicture = !!window.HTMLPictureElement;

    // UC browser does claim to support srcset and picture, but not sizes,
    // this extended test reveals the browser does support nothing
    if (pf.supSrcset && pf.supPicture && !pf.supSizes) {
        (function(image2) {
            image.srcset = "data:,a";
            image2.src = "data:,a";
            pf.supSrcset = image.complete === image2.complete;
            pf.supPicture = pf.supSrcset && pf.supPicture;
        })(document.createElement("img"));
    }

    // Safari9 has basic support for sizes, but does't expose the `sizes` idl attribute
    if (pf.supSrcset && !pf.supSizes) {

        (function() {
            var width2 = "data:image/gif;base64,R0lGODlhAgABAPAAAP///wAAACH5BAAAAAAALAAAAAACAAEAAAICBAoAOw==";
            var width1 = "data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";
            var img = document.createElement("img");
            var test = function() {
                var width = img.width;

                if (width === 2) {
                    pf.supSizes = true;
                }

                alwaysCheckWDescriptor = pf.supSrcset && !pf.supSizes;

                isSupportTestReady = true;
                // force async
                setTimeout(picturefill);
            };

            img.onload = test;
            img.onerror = test;
            img.setAttribute("sizes", "9px");

            img.srcset = width1 + " 1w," + width2 + " 9w";
            img.src = width1;
        })();

    } else {
        isSupportTestReady = true;
    }

    // using pf.qsa instead of dom traversing does scale much better,
    // especially on sites mixing responsive and non-responsive images
    pf.selShort = "picture>img,img[srcset]";
    pf.sel = pf.selShort;
    pf.cfg = cfg;

    /**
     * Shortcut property for `devicePixelRatio` ( for easy overriding in tests )
     */
    pf.DPR = (DPR  || 1 );
    pf.u = units;

    // container of supported mime types that one might need to qualify before using
    pf.types =  types;

    pf.setSize = noop;

    /**
     * Gets a string and returns the absolute URL
     * @param src
     * @returns {String} absolute URL
     */

    pf.makeUrl = memoize(function(src) {
        anchor.href = src;
        return anchor.href;
    });

    /**
     * Gets a DOM element or document and a selctor and returns the found matches
     * Can be extended with jQuery/Sizzle for IE7 support
     * @param context
     * @param sel
     * @returns {NodeList|Array}
     */
    pf.qsa = function(context, sel) {
        return ( "querySelector" in context ) ? context.querySelectorAll(sel) : [];
    };

    /**
     * Shortcut method for matchMedia ( for easy overriding in tests )
     * wether native or pf.mMQ is used will be decided lazy on first call
     * @returns {boolean}
     */
    pf.matchesMedia = function() {
        if ( window.matchMedia && (matchMedia( "(min-width: 0.1em)" ) || {}).matches ) {
            pf.matchesMedia = function( media ) {
                return !media || ( matchMedia( media ).matches );
            };
        } else {
            pf.matchesMedia = pf.mMQ;
        }

        return pf.matchesMedia.apply( this, arguments );
    };

    /**
     * A simplified matchMedia implementation for IE8 and IE9
     * handles only min-width/max-width with px or em values
     * @param media
     * @returns {boolean}
     */
    pf.mMQ = function( media ) {
        return media ? evalCSS(media) : true;
    };

    /**
     * Returns the calculated length in css pixel from the given sourceSizeValue
     * http://dev.w3.org/csswg/css-values-3/#length-value
     * intended Spec mismatches:
     * * Does not check for invalid use of CSS functions
     * * Does handle a computed length of 0 the same as a negative and therefore invalid value
     * @param sourceSizeValue
     * @returns {Number}
     */
    pf.calcLength = function( sourceSizeValue ) {

        var value = evalCSS(sourceSizeValue, true) || false;
        if (value < 0) {
            value = false;
        }

        return value;
    };

    /**
     * Takes a type string and checks if its supported
     */

    pf.supportsType = function( type ) {
        return ( type ) ? types[ type ] : true;
    };

    /**
     * Parses a sourceSize into mediaCondition (media) and sourceSizeValue (length)
     * @param sourceSizeStr
     * @returns {*}
     */
    pf.parseSize = memoize(function( sourceSizeStr ) {
        var match = ( sourceSizeStr || "" ).match(regSize);
        return {
            media: match && match[1],
            length: match && match[2]
        };
    });

    pf.parseSet = function( set ) {
        if ( !set.cands ) {
            set.cands = parseSrcset(set.srcset, set);
        }
        return set.cands;
    };

    /**
     * returns 1em in css px for html/body default size
     * function taken from respondjs
     * @returns {*|number}
     */
    pf.getEmValue = function() {
        var body;
        if ( !eminpx && (body = document.body) ) {
            var div = document.createElement( "div" ),
                originalHTMLCSS = docElem.style.cssText,
                originalBodyCSS = body.style.cssText;

            div.style.cssText = baseStyle;

            // 1em in a media query is the value of the default font size of the browser
            // reset docElem and body to ensure the correct value is returned
            docElem.style.cssText = fsCss;
            body.style.cssText = fsCss;

            body.appendChild( div );
            eminpx = div.offsetWidth;
            body.removeChild( div );

            //also update eminpx before returning
            eminpx = parseFloat( eminpx, 10 );

            // restore the original values
            docElem.style.cssText = originalHTMLCSS;
            body.style.cssText = originalBodyCSS;

        }
        return eminpx || 16;
    };

    /**
     * Takes a string of sizes and returns the width in pixels as a number
     */
    pf.calcListLength = function( sourceSizeListStr ) {
        // Split up source size list, ie ( max-width: 30em ) 100%, ( max-width: 50em ) 50%, 33%
        //
        //                           or (min-width:30em) calc(30% - 15px)
        if ( !(sourceSizeListStr in sizeLengthCache) || cfg.uT ) {
            var winningLength = pf.calcLength( parseSizes( sourceSizeListStr ) );

            sizeLengthCache[ sourceSizeListStr ] = !winningLength ? units.width : winningLength;
        }

        return sizeLengthCache[ sourceSizeListStr ];
    };

    /**
     * Takes a candidate object with a srcset property in the form of url/
     * ex. "images/pic-medium.png 1x, images/pic-medium-2x.png 2x" or
     *     "images/pic-medium.png 400w, images/pic-medium-2x.png 800w" or
     *     "images/pic-small.png"
     * Get an array of image candidates in the form of
     *      {url: "/foo/bar.png", resolution: 1}
     * where resolution is http://dev.w3.org/csswg/css-values-3/#resolution-value
     * If sizes is specified, res is calculated
     */
    pf.setRes = function( set ) {
        var candidates;
        if ( set ) {

            candidates = pf.parseSet( set );

            for ( var i = 0, len = candidates.length; i < len; i++ ) {
                setResolution( candidates[ i ], set.sizes );
            }
        }
        return candidates;
    };

    pf.setRes.res = setResolution;

    pf.applySetCandidate = function( candidates, img ) {
        if ( !candidates.length ) {return;}
        var candidate,
            i,
            j,
            length,
            bestCandidate,
            curSrc,
            curCan,
            candidateSrc,
            abortCurSrc;

        var imageData = img[ pf.ns ];
        var dpr = pf.DPR;

        curSrc = imageData.curSrc || img[curSrcProp];

        curCan = imageData.curCan || setSrcToCur(img, curSrc, candidates[0].set);

        // if we have a current source, we might either become lazy or give this source some advantage
        if ( curCan && curCan.set === candidates[ 0 ].set ) {

            // if browser can abort image request and the image has a higher pixel density than needed
            // and this image isn't downloaded yet, we skip next part and try to save bandwidth
            abortCurSrc = (supportAbort && !img.complete && curCan.res - 0.1 > dpr);

            if ( !abortCurSrc ) {
                curCan.cached = true;

                // if current candidate is "best", "better" or "okay",
                // set it to bestCandidate
                if ( curCan.res >= dpr ) {
                    bestCandidate = curCan;
                }
            }
        }

        if ( !bestCandidate ) {

            candidates.sort( ascendingSort );

            length = candidates.length;
            bestCandidate = candidates[ length - 1 ];

            for ( i = 0; i < length; i++ ) {
                candidate = candidates[ i ];
                if ( candidate.res >= dpr ) {
                    j = i - 1;

                    // we have found the perfect candidate,
                    // but let's improve this a little bit with some assumptions ;-)
                    if (candidates[ j ] &&
                        (abortCurSrc || curSrc !== pf.makeUrl( candidate.url )) &&
                        chooseLowRes(candidates[ j ].res, candidate.res, dpr, candidates[ j ].cached)) {

                        bestCandidate = candidates[ j ];

                    } else {
                        bestCandidate = candidate;
                    }
                    break;
                }
            }
        }

        if ( bestCandidate ) {

            candidateSrc = pf.makeUrl( bestCandidate.url );

            imageData.curSrc = candidateSrc;
            imageData.curCan = bestCandidate;

            if ( candidateSrc !== curSrc ) {
                pf.setSrc( img, bestCandidate );
            }
            pf.setSize( img );
        }
    };

    pf.setSrc = function( img, bestCandidate ) {
        var origWidth;
        img.src = bestCandidate.url;

        // although this is a specific Safari issue, we don't want to take too much different code paths
        if ( bestCandidate.set.type === "image/svg+xml" ) {
            origWidth = img.style.width;
            img.style.width = (img.offsetWidth + 1) + "px";

            // next line only should trigger a repaint
            // if... is only done to trick dead code removal
            if ( img.offsetWidth + 1 ) {
                img.style.width = origWidth;
            }
        }
    };

    pf.getSet = function( img ) {
        var i, set, supportsType;
        var match = false;
        var sets = img [ pf.ns ].sets;

        for ( i = 0; i < sets.length && !match; i++ ) {
            set = sets[i];

            if ( !set.srcset || !pf.matchesMedia( set.media ) || !(supportsType = pf.supportsType( set.type )) ) {
                continue;
            }

            if ( supportsType === "pending" ) {
                set = supportsType;
            }

            match = set;
            break;
        }

        return match;
    };

    pf.parseSets = function( element, parent, options ) {
        var srcsetAttribute, imageSet, isWDescripor, srcsetParsed;

        var hasPicture = parent && parent.nodeName.toUpperCase() === "PICTURE";
        var imageData = element[ pf.ns ];

        if ( imageData.src === undefined || options.src ) {
            imageData.src = getImgAttr.call( element, "src" );
            if ( imageData.src ) {
                setImgAttr.call( element, srcAttr, imageData.src );
            } else {
                removeImgAttr.call( element, srcAttr );
            }
        }

        if ( imageData.srcset === undefined || options.srcset || !pf.supSrcset || element.srcset ) {
            srcsetAttribute = getImgAttr.call( element, "srcset" );
            imageData.srcset = srcsetAttribute;
            srcsetParsed = true;
        }

        imageData.sets = [];

        if ( hasPicture ) {
            imageData.pic = true;
            getAllSourceElements( parent, imageData.sets );
        }

        if ( imageData.srcset ) {
            imageSet = {
                srcset: imageData.srcset,
                sizes: getImgAttr.call( element, "sizes" )
            };

            imageData.sets.push( imageSet );

            isWDescripor = (alwaysCheckWDescriptor || imageData.src) && regWDesc.test(imageData.srcset || "");

            // add normal src as candidate, if source has no w descriptor
            if ( !isWDescripor && imageData.src && !getCandidateForSrc(imageData.src, imageSet) && !imageSet.has1x ) {
                imageSet.srcset += ", " + imageData.src;
                imageSet.cands.push({
                    url: imageData.src,
                    d: 1,
                    set: imageSet
                });
            }

        } else if ( imageData.src ) {
            imageData.sets.push( {
                srcset: imageData.src,
                sizes: null
            } );
        }

        imageData.curCan = null;
        imageData.curSrc = undefined;

        // if img has picture or the srcset was removed or has a srcset and does not support srcset at all
        // or has a w descriptor (and does not support sizes) set support to false to evaluate
        imageData.supported = !( hasPicture || ( imageSet && !pf.supSrcset ) || (isWDescripor && !pf.supSizes) );

        if ( srcsetParsed && pf.supSrcset && !imageData.supported ) {
            if ( srcsetAttribute ) {
                setImgAttr.call( element, srcsetAttr, srcsetAttribute );
                element.srcset = "";
            } else {
                removeImgAttr.call( element, srcsetAttr );
            }
        }

        if (imageData.supported && !imageData.srcset && ((!imageData.src && element.src) ||  element.src !== pf.makeUrl(imageData.src))) {
            if (imageData.src === null) {
                element.removeAttribute("src");
            } else {
                element.src = imageData.src;
            }
        }

        imageData.parsed = true;
    };

    pf.fillImg = function(element, options) {
        var imageData;
        var extreme = options.reselect || options.reevaluate;

        // expando for caching data on the img
        if ( !element[ pf.ns ] ) {
            element[ pf.ns ] = {};
        }

        imageData = element[ pf.ns ];

        // if the element has already been evaluated, skip it
        // unless `options.reevaluate` is set to true ( this, for example,
        // is set to true when running `picturefill` on `resize` ).
        if ( !extreme && imageData.evaled === evalId ) {
            return;
        }

        if ( !imageData.parsed || options.reevaluate ) {
            pf.parseSets( element, element.parentNode, options );
        }

        if ( !imageData.supported ) {
            applyBestCandidate( element );
        } else {
            imageData.evaled = evalId;
        }
    };

    pf.setupRun = function() {
        if ( !alreadyRun || isVwDirty || (DPR !== window.devicePixelRatio) ) {
            updateMetrics();
        }
    };

    // If picture is supported, well, that's awesome.
    if ( pf.supPicture ) {
        picturefill = noop;
        pf.fillImg = noop;
    } else {

         // Set up picture polyfill by polling the document
        (function() {
            var isDomReady;
            var regReady = window.attachEvent ? /d$|^c/ : /d$|^c|^i/;

            var run = function() {
                var readyState = document.readyState || "";

                timerId = setTimeout(run, readyState === "loading" ? 200 :  999);
                if ( document.body ) {
                    pf.fillImgs();
                    isDomReady = isDomReady || regReady.test(readyState);
                    if ( isDomReady ) {
                        clearTimeout( timerId );
                    }

                }
            };

            var timerId = setTimeout(run, document.body ? 9 : 99);

            // Also attach picturefill on resize and readystatechange
            // http://modernjavascript.blogspot.com/2013/08/building-better-debounce.html
            var debounce = function(func, wait) {
                var timeout, timestamp;
                var later = function() {
                    var last = (new Date()) - timestamp;

                    if (last < wait) {
                        timeout = setTimeout(later, wait - last);
                    } else {
                        timeout = null;
                        func();
                    }
                };

                return function() {
                    timestamp = new Date();

                    if (!timeout) {
                        timeout = setTimeout(later, wait);
                    }
                };
            };
            var lastClientWidth = docElem.clientHeight;
            var onResize = function() {
                isVwDirty = Math.max(window.innerWidth || 0, docElem.clientWidth) !== units.width || docElem.clientHeight !== lastClientWidth;
                lastClientWidth = docElem.clientHeight;
                if ( isVwDirty ) {
                    pf.fillImgs();
                }
            };

            on( window, "resize", debounce(onResize, 99 ) );
            on( document, "readystatechange", run );
        })();
    }

    pf.picturefill = picturefill;
    //use this internally for easy monkey patching/performance testing
    pf.fillImgs = picturefill;
    pf.teardownRun = noop;

    /* expose methods for testing */
    picturefill._ = pf;

    window.picturefillCFG = {
        pf: pf,
        push: function(args) {
            var name = args.shift();
            if (typeof pf[name] === "function") {
                pf[name].apply(pf, args);
            } else {
                cfg[name] = args[0];
                if (alreadyRun) {
                    pf.fillImgs( { reselect: true } );
                }
            }
        }
    };

    while (setOptions && setOptions.length) {
        window.picturefillCFG.push(setOptions.shift());
    }

    /* expose picturefill */
    window.picturefill = picturefill;

    /* expose picturefill */
    if ( typeof module === "object" && typeof module.exports === "object" ) {
        // CommonJS, just export
        module.exports = picturefill;
    } else if ( typeof define === "function" && define.amd ) {
        // AMD support
        define( "picturefill", function() { return picturefill; } );
    }

    // IE8 evals this sync, so it must be the last thing we do
    if ( !pf.supPicture ) {
        types[ "image/webp" ] = detectTypeSupport("image/webp", "data:image/webp;base64,UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAABBxAR/Q9ERP8DAABWUDggGAAAADABAJ0BKgEAAQADADQlpAADcAD++/1QAA==" );
    }

} )( window, document );

;//     Underscore.js 1.5.1
//     http://underscorejs.org
//     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.
!function(){var n=this,t=n._,r={},e=Array.prototype,u=Object.prototype,i=Function.prototype,a=e.push,o=e.slice,c=e.concat,l=u.toString,f=u.hasOwnProperty,s=e.forEach,p=e.map,v=e.reduce,h=e.reduceRight,d=e.filter,g=e.every,m=e.some,y=e.indexOf,b=e.lastIndexOf,x=Array.isArray,_=Object.keys,w=i.bind,j=function(n){return n instanceof j?n:this instanceof j?(this._wrapped=n,void 0):new j(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=j),exports._=j):n._=j,j.VERSION="1.5.1";var A=j.each=j.forEach=function(n,t,e){if(null!=n)if(s&&n.forEach===s)n.forEach(t,e);else if(n.length===+n.length){for(var u=0,i=n.length;i>u;u++)if(t.call(e,n[u],u,n)===r)return}else for(var a in n)if(j.has(n,a)&&t.call(e,n[a],a,n)===r)return};j.map=j.collect=function(n,t,r){var e=[];return null==n?e:p&&n.map===p?n.map(t,r):(A(n,function(n,u,i){e.push(t.call(r,n,u,i))}),e)};var E="Reduce of empty array with no initial value";j.reduce=j.foldl=j.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),v&&n.reduce===v)return e&&(t=j.bind(t,e)),u?n.reduce(t,r):n.reduce(t);if(A(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u)throw new TypeError(E);return r},j.reduceRight=j.foldr=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),h&&n.reduceRight===h)return e&&(t=j.bind(t,e)),u?n.reduceRight(t,r):n.reduceRight(t);var i=n.length;if(i!==+i){var a=j.keys(n);i=a.length}if(A(n,function(o,c,l){c=a?a[--i]:--i,u?r=t.call(e,r,n[c],c,l):(r=n[c],u=!0)}),!u)throw new TypeError(E);return r},j.find=j.detect=function(n,t,r){var e;return O(n,function(n,u,i){return t.call(r,n,u,i)?(e=n,!0):void 0}),e},j.filter=j.select=function(n,t,r){var e=[];return null==n?e:d&&n.filter===d?n.filter(t,r):(A(n,function(n,u,i){t.call(r,n,u,i)&&e.push(n)}),e)},j.reject=function(n,t,r){return j.filter(n,function(n,e,u){return!t.call(r,n,e,u)},r)},j.every=j.all=function(n,t,e){t||(t=j.identity);var u=!0;return null==n?u:g&&n.every===g?n.every(t,e):(A(n,function(n,i,a){return(u=u&&t.call(e,n,i,a))?void 0:r}),!!u)};var O=j.some=j.any=function(n,t,e){t||(t=j.identity);var u=!1;return null==n?u:m&&n.some===m?n.some(t,e):(A(n,function(n,i,a){return u||(u=t.call(e,n,i,a))?r:void 0}),!!u)};j.contains=j.include=function(n,t){return null==n?!1:y&&n.indexOf===y?n.indexOf(t)!=-1:O(n,function(n){return n===t})},j.invoke=function(n,t){var r=o.call(arguments,2),e=j.isFunction(t);return j.map(n,function(n){return(e?t:n[t]).apply(n,r)})},j.pluck=function(n,t){return j.map(n,function(n){return n[t]})},j.where=function(n,t,r){return j.isEmpty(t)?r?void 0:[]:j[r?"find":"filter"](n,function(n){for(var r in t)if(t[r]!==n[r])return!1;return!0})},j.findWhere=function(n,t){return j.where(n,t,!0)},j.max=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.max.apply(Math,n);if(!t&&j.isEmpty(n))return-1/0;var e={computed:-1/0,value:-1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a>e.computed&&(e={value:n,computed:a})}),e.value},j.min=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535)return Math.min.apply(Math,n);if(!t&&j.isEmpty(n))return 1/0;var e={computed:1/0,value:1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a<e.computed&&(e={value:n,computed:a})}),e.value},j.shuffle=function(n){var t,r=0,e=[];return A(n,function(n){t=j.random(r++),e[r-1]=e[t],e[t]=n}),e};var F=function(n){return j.isFunction(n)?n:function(t){return t[n]}};j.sortBy=function(n,t,r){var e=F(t);return j.pluck(j.map(n,function(n,t,u){return{value:n,index:t,criteria:e.call(r,n,t,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||r===void 0)return 1;if(e>r||e===void 0)return-1}return n.index<t.index?-1:1}),"value")};var k=function(n,t,r,e){var u={},i=F(null==t?j.identity:t);return A(n,function(t,a){var o=i.call(r,t,a,n);e(u,o,t)}),u};j.groupBy=function(n,t,r){return k(n,t,r,function(n,t,r){(j.has(n,t)?n[t]:n[t]=[]).push(r)})},j.countBy=function(n,t,r){return k(n,t,r,function(n,t){j.has(n,t)||(n[t]=0),n[t]++})},j.sortedIndex=function(n,t,r,e){r=null==r?j.identity:F(r);for(var u=r.call(e,t),i=0,a=n.length;a>i;){var o=i+a>>>1;r.call(e,n[o])<u?i=o+1:a=o}return i},j.toArray=function(n){return n?j.isArray(n)?o.call(n):n.length===+n.length?j.map(n,j.identity):j.values(n):[]},j.size=function(n){return null==n?0:n.length===+n.length?n.length:j.keys(n).length},j.first=j.head=j.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:o.call(n,0,t)},j.initial=function(n,t,r){return o.call(n,0,n.length-(null==t||r?1:t))},j.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:o.call(n,Math.max(n.length-t,0))},j.rest=j.tail=j.drop=function(n,t,r){return o.call(n,null==t||r?1:t)},j.compact=function(n){return j.filter(n,j.identity)};var R=function(n,t,r){return t&&j.every(n,j.isArray)?c.apply(r,n):(A(n,function(n){j.isArray(n)||j.isArguments(n)?t?a.apply(r,n):R(n,t,r):r.push(n)}),r)};j.flatten=function(n,t){return R(n,t,[])},j.without=function(n){return j.difference(n,o.call(arguments,1))},j.uniq=j.unique=function(n,t,r,e){j.isFunction(t)&&(e=r,r=t,t=!1);var u=r?j.map(n,r,e):n,i=[],a=[];return A(u,function(r,e){(t?e&&a[a.length-1]===r:j.contains(a,r))||(a.push(r),i.push(n[e]))}),i},j.union=function(){return j.uniq(j.flatten(arguments,!0))},j.intersection=function(n){var t=o.call(arguments,1);return j.filter(j.uniq(n),function(n){return j.every(t,function(t){return j.indexOf(t,n)>=0})})},j.difference=function(n){var t=c.apply(e,o.call(arguments,1));return j.filter(n,function(n){return!j.contains(t,n)})},j.zip=function(){for(var n=j.max(j.pluck(arguments,"length").concat(0)),t=new Array(n),r=0;n>r;r++)t[r]=j.pluck(arguments,""+r);return t},j.object=function(n,t){if(null==n)return{};for(var r={},e=0,u=n.length;u>e;e++)t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1];return r},j.indexOf=function(n,t,r){if(null==n)return-1;var e=0,u=n.length;if(r){if("number"!=typeof r)return e=j.sortedIndex(n,t),n[e]===t?e:-1;e=0>r?Math.max(0,u+r):r}if(y&&n.indexOf===y)return n.indexOf(t,r);for(;u>e;e++)if(n[e]===t)return e;return-1},j.lastIndexOf=function(n,t,r){if(null==n)return-1;var e=null!=r;if(b&&n.lastIndexOf===b)return e?n.lastIndexOf(t,r):n.lastIndexOf(t);for(var u=e?r:n.length;u--;)if(n[u]===t)return u;return-1},j.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=new Array(e);e>u;)i[u++]=n,n+=r;return i};var M=function(){};j.bind=function(n,t){var r,e;if(w&&n.bind===w)return w.apply(n,o.call(arguments,1));if(!j.isFunction(n))throw new TypeError;return r=o.call(arguments,2),e=function(){if(!(this instanceof e))return n.apply(t,r.concat(o.call(arguments)));M.prototype=n.prototype;var u=new M;M.prototype=null;var i=n.apply(u,r.concat(o.call(arguments)));return Object(i)===i?i:u}},j.partial=function(n){var t=o.call(arguments,1);return function(){return n.apply(this,t.concat(o.call(arguments)))}},j.bindAll=function(n){var t=o.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return A(t,function(t){n[t]=j.bind(n[t],n)}),n},j.memoize=function(n,t){var r={};return t||(t=j.identity),function(){var e=t.apply(this,arguments);return j.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}},j.delay=function(n,t){var r=o.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},j.defer=function(n){return j.delay.apply(j,[n,1].concat(o.call(arguments,1)))},j.throttle=function(n,t,r){var e,u,i,a=null,o=0;r||(r={});var c=function(){o=r.leading===!1?0:new Date,a=null,i=n.apply(e,u)};return function(){var l=new Date;o||r.leading!==!1||(o=l);var f=t-(l-o);return e=this,u=arguments,0>=f?(clearTimeout(a),a=null,o=l,i=n.apply(e,u)):a||r.trailing===!1||(a=setTimeout(c,f)),i}},j.debounce=function(n,t,r){var e,u=null;return function(){var i=this,a=arguments,o=function(){u=null,r||(e=n.apply(i,a))},c=r&&!u;return clearTimeout(u),u=setTimeout(o,t),c&&(e=n.apply(i,a)),e}},j.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}},j.wrap=function(n,t){return function(){var r=[n];return a.apply(r,arguments),t.apply(this,r)}},j.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--)t=[n[r].apply(this,t)];return t[0]}},j.after=function(n,t){return function(){return--n<1?t.apply(this,arguments):void 0}},j.keys=_||function(n){if(n!==Object(n))throw new TypeError("Invalid object");var t=[];for(var r in n)j.has(n,r)&&t.push(r);return t},j.values=function(n){var t=[];for(var r in n)j.has(n,r)&&t.push(n[r]);return t},j.pairs=function(n){var t=[];for(var r in n)j.has(n,r)&&t.push([r,n[r]]);return t},j.invert=function(n){var t={};for(var r in n)j.has(n,r)&&(t[n[r]]=r);return t},j.functions=j.methods=function(n){var t=[];for(var r in n)j.isFunction(n[r])&&t.push(r);return t.sort()},j.extend=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]=t[r]}),n},j.pick=function(n){var t={},r=c.apply(e,o.call(arguments,1));return A(r,function(r){r in n&&(t[r]=n[r])}),t},j.omit=function(n){var t={},r=c.apply(e,o.call(arguments,1));for(var u in n)j.contains(r,u)||(t[u]=n[u]);return t},j.defaults=function(n){return A(o.call(arguments,1),function(t){if(t)for(var r in t)n[r]===void 0&&(n[r]=t[r])}),n},j.clone=function(n){return j.isObject(n)?j.isArray(n)?n.slice():j.extend({},n):n},j.tap=function(n,t){return t(n),n};var S=function(n,t,r,e){if(n===t)return 0!==n||1/n==1/t;if(null==n||null==t)return n===t;n instanceof j&&(n=n._wrapped),t instanceof j&&(t=t._wrapped);var u=l.call(n);if(u!=l.call(t))return!1;switch(u){case"[object String]":return n==String(t);case"[object Number]":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case"[object Date]":case"[object Boolean]":return+n==+t;case"[object RegExp]":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if("object"!=typeof n||"object"!=typeof t)return!1;for(var i=r.length;i--;)if(r[i]==n)return e[i]==t;var a=n.constructor,o=t.constructor;if(a!==o&&!(j.isFunction(a)&&a instanceof a&&j.isFunction(o)&&o instanceof o))return!1;r.push(n),e.push(t);var c=0,f=!0;if("[object Array]"==u){if(c=n.length,f=c==t.length)for(;c--&&(f=S(n[c],t[c],r,e)););}else{for(var s in n)if(j.has(n,s)&&(c++,!(f=j.has(t,s)&&S(n[s],t[s],r,e))))break;if(f){for(s in t)if(j.has(t,s)&&!c--)break;f=!c}}return r.pop(),e.pop(),f};j.isEqual=function(n,t){return S(n,t,[],[])},j.isEmpty=function(n){if(null==n)return!0;if(j.isArray(n)||j.isString(n))return 0===n.length;for(var t in n)if(j.has(n,t))return!1;return!0},j.isElement=function(n){return!(!n||1!==n.nodeType)},j.isArray=x||function(n){return"[object Array]"==l.call(n)},j.isObject=function(n){return n===Object(n)},A(["Arguments","Function","String","Number","Date","RegExp"],function(n){j["is"+n]=function(t){return l.call(t)=="[object "+n+"]"}}),j.isArguments(arguments)||(j.isArguments=function(n){return!(!n||!j.has(n,"callee"))}),"function"!=typeof/./&&(j.isFunction=function(n){return"function"==typeof n}),j.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},j.isNaN=function(n){return j.isNumber(n)&&n!=+n},j.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==l.call(n)},j.isNull=function(n){return null===n},j.isUndefined=function(n){return n===void 0},j.has=function(n,t){return f.call(n,t)},j.noConflict=function(){return n._=t,this},j.identity=function(n){return n},j.times=function(n,t,r){for(var e=Array(Math.max(0,n)),u=0;n>u;u++)e[u]=t.call(r,u);return e},j.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};I.unescape=j.invert(I.escape);var T={escape:new RegExp("["+j.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+j.keys(I.unescape).join("|")+")","g")};j.each(["escape","unescape"],function(n){j[n]=function(t){return null==t?"":(""+t).replace(T[n],function(t){return I[n][t]})}}),j.result=function(n,t){if(null==n)return void 0;var r=n[t];return j.isFunction(r)?r.call(n):r},j.mixin=function(n){A(j.functions(n),function(t){var r=j[t]=n[t];j.prototype[t]=function(){var n=[this._wrapped];return a.apply(n,arguments),z.call(this,r.apply(j,n))}})};var N=0;j.uniqueId=function(n){var t=++N+"";return n?n+t:t},j.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\t|\u2028|\u2029/g;j.template=function(n,t,r){var e;r=j.defaults({},r,j.templateSettings);var u=new RegExp([(r.escape||q).source,(r.interpolate||q).source,(r.evaluate||q).source].join("|")+"|$","g"),i=0,a="__p+='";n.replace(u,function(t,r,e,u,o){return a+=n.slice(i,o).replace(D,function(n){return"\\"+B[n]}),r&&(a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),e&&(a+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),u&&(a+="';\n"+u+"\n__p+='"),i=o+t.length,t}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,"+"print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=new Function(r.variable||"obj","_",a)}catch(o){throw o.source=a,o}if(t)return e(t,j);var c=function(n){return e.call(this,n,j)};return c.source="function("+(r.variable||"obj")+"){\n"+a+"}",c},j.chain=function(n){return j(n).chain()};var z=function(n){return this._chain?j(n).chain():n};j.mixin(j),A(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=e[n];j.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!=n&&"splice"!=n||0!==r.length||delete r[0],z.call(this,r)}}),A(["concat","join","slice"],function(n){var t=e[n];j.prototype[n]=function(){return z.call(this,t.apply(this._wrapped,arguments))}}),j.extend(j.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this);

;/**
 * Generic `Utils` module
 */
(function () {
    Atlantic.Utils = Atlantic.Utils || {};

    /**
     * Parse a URL and return an object
     * @param  {String} url The URL to parse
     * @return {Object}     The parsed URL
     */
    Atlantic.Utils.parseUrl = function (url) {
        url = url || window.location.href;

        // hate this method but `URL` isn't fully supported on ie
        var parser = document.createElement('a');
        parser.href = url;

        return {
            protocol: parser.protocol.replace(':', ''),
            host: parser.hostname,
            port: parser.port,
            query: parser.search,
            params: this.parseParams(parser.search),
            file: (parser.pathname.match(/\/([^\/?#]+)$/i) || [,''])[1],
            hash: parser.hash.replace('#', ''),
            path: parser.pathname.replace(/^([^\/])/,'/$1'),
            relative: (parser.href.match(/tps?:\/\/[^\/]+(.+)/) || [,''])[1],
            segments: parser.pathname.replace(/^\//, '').split('/')
        };
    };

    /**
     * Parse the query string of a URL
     * @param  {String} search The search string of the URL
     * @return {Object}        The parsed search string
     */
    Atlantic.Utils.parseParams = function(search) {
        var ret = {};
        var seg = search.replace(/^\?/, '').split('&');
        var len = seg.length;
        var s;

        for (var i = 0; i<len; i++) {
            if (!seg[i]) {
                continue;
            }
            s = seg[i].split('=');
            ret[s[0]] = s[1];
        }
        return ret;
    };
} ());

;Atlantic = window.Atlantic || {};

if (typeof Atlantic.Utils !== 'object') {
    Atlantic.Utils = {};
}

/**
 * We need to set the cookie methods in case they aren't set.
 */
if (typeof Atlantic.Utils.createCookie === "undefined") {
    Atlantic.Utils.createCookie = function(name, value, days, path) {
        var date, expires;
        if (days) {
            date = new Date();
            date.setTime(date.getTime() + (days*24*60*60*1000));
            expires = "; expires=" + date.toGMTString();
        }
        else {
            expires = "";
        }
        if (!path) { path = "/"; }
        document.cookie = name+"=" + value + expires + "; path=" + path;
    };
}

if (typeof Atlantic.Utils.readCookie === "undefined") {
    Atlantic.Utils.readCookie = function(name) {
        var nameEq = name + "=";
        var ca = document.cookie.split(';');
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0) == ' ') {
                c = c.substring(1, c.length);
            }
            if (c.indexOf(nameEq) === 0) {
                return c.substring(nameEq.length, c.length);
            }
        }
        return null;
    };
}

if (typeof Atlantic.Utils.eraseCookie === "undefined") {
    Atlantic.Utils.eraseCookie = function(name) {
        Atlantic.Utils.createCookie(name, "", -1);
    };
}


;/*! https://mths.be/utf8js v2.1.1 by @mathias */
;(function(root) {

    // Detect free variables `exports`
    var freeExports = typeof exports == 'object' && exports;

    // Detect free variable `module`
    var freeModule = typeof module == 'object' && module &&
        module.exports == freeExports && module;

    // Detect free variable `global`, from Node.js or Browserified code,
    // and use it as `root`
    var freeGlobal = typeof global == 'object' && global;
    if (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal) {
        root = freeGlobal;
    }

    /*--------------------------------------------------------------------------*/

    var stringFromCharCode = String.fromCharCode;

    // Taken from https://mths.be/punycode
    function ucs2decode(string) {
        var output = [];
        var counter = 0;
        var length = string.length;
        var value;
        var extra;
        while (counter < length) {
            value = string.charCodeAt(counter++);
            if (value >= 0xD800 && value <= 0xDBFF && counter < length) {
                // high surrogate, and there is a next character
                extra = string.charCodeAt(counter++);
                if ((extra & 0xFC00) == 0xDC00) { // low surrogate
                    output.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);
                } else {
                    // unmatched surrogate; only append this code unit, in case the next
                    // code unit is the high surrogate of a surrogate pair
                    output.push(value);
                    counter--;
                }
            } else {
                output.push(value);
            }
        }
        return output;
    }

    // Taken from https://mths.be/punycode
    function ucs2encode(array) {
        var length = array.length;
        var index = -1;
        var value;
        var output = '';
        while (++index < length) {
            value = array[index];
            if (value > 0xFFFF) {
                value -= 0x10000;
                output += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);
                value = 0xDC00 | value & 0x3FF;
            }
            output += stringFromCharCode(value);
        }
        return output;
    }

    function checkScalarValue(codePoint) {
        if (codePoint >= 0xD800 && codePoint <= 0xDFFF) {
            throw Error(
                'Lone surrogate U+' + codePoint.toString(16).toUpperCase() +
                ' is not a scalar value'
            );
        }
    }
    /*--------------------------------------------------------------------------*/

    function createByte(codePoint, shift) {
        return stringFromCharCode(((codePoint >> shift) & 0x3F) | 0x80);
    }

    function encodeCodePoint(codePoint) {
        if ((codePoint & 0xFFFFFF80) == 0) { // 1-byte sequence
            return stringFromCharCode(codePoint);
        }
        var symbol = '';
        if ((codePoint & 0xFFFFF800) == 0) { // 2-byte sequence
            symbol = stringFromCharCode(((codePoint >> 6) & 0x1F) | 0xC0);
        }
        else if ((codePoint & 0xFFFF0000) == 0) { // 3-byte sequence
            checkScalarValue(codePoint);
            symbol = stringFromCharCode(((codePoint >> 12) & 0x0F) | 0xE0);
            symbol += createByte(codePoint, 6);
        }
        else if ((codePoint & 0xFFE00000) == 0) { // 4-byte sequence
            symbol = stringFromCharCode(((codePoint >> 18) & 0x07) | 0xF0);
            symbol += createByte(codePoint, 12);
            symbol += createByte(codePoint, 6);
        }
        symbol += stringFromCharCode((codePoint & 0x3F) | 0x80);
        return symbol;
    }

    function utf8encode(string) {
        var codePoints = ucs2decode(string);
        var length = codePoints.length;
        var index = -1;
        var codePoint;
        var byteString = '';
        while (++index < length) {
            codePoint = codePoints[index];
            byteString += encodeCodePoint(codePoint);
        }
        return byteString;
    }

    /*--------------------------------------------------------------------------*/

    function readContinuationByte() {
        if (byteIndex >= byteCount) {
            throw Error('Invalid byte index');
        }

        var continuationByte = byteArray[byteIndex] & 0xFF;
        byteIndex++;

        if ((continuationByte & 0xC0) == 0x80) {
            return continuationByte & 0x3F;
        }

        // If we end up here, its not a continuation byte
        throw Error('Invalid continuation byte');
    }

    function decodeSymbol() {
        var byte1;
        var byte2;
        var byte3;
        var byte4;
        var codePoint;

        if (byteIndex > byteCount) {
            throw Error('Invalid byte index');
        }

        if (byteIndex == byteCount) {
            return false;
        }

        // Read first byte
        byte1 = byteArray[byteIndex] & 0xFF;
        byteIndex++;

        // 1-byte sequence (no continuation bytes)
        if ((byte1 & 0x80) == 0) {
            return byte1;
        }

        // 2-byte sequence
        if ((byte1 & 0xE0) == 0xC0) {
            var byte2 = readContinuationByte();
            codePoint = ((byte1 & 0x1F) << 6) | byte2;
            if (codePoint >= 0x80) {
                return codePoint;
            } else {
                throw Error('Invalid continuation byte');
            }
        }

        // 3-byte sequence (may include unpaired surrogates)
        if ((byte1 & 0xF0) == 0xE0) {
            byte2 = readContinuationByte();
            byte3 = readContinuationByte();
            codePoint = ((byte1 & 0x0F) << 12) | (byte2 << 6) | byte3;
            if (codePoint >= 0x0800) {
                checkScalarValue(codePoint);
                return codePoint;
            } else {
                throw Error('Invalid continuation byte');
            }
        }

        // 4-byte sequence
        if ((byte1 & 0xF8) == 0xF0) {
            byte2 = readContinuationByte();
            byte3 = readContinuationByte();
            byte4 = readContinuationByte();
            codePoint = ((byte1 & 0x0F) << 0x12) | (byte2 << 0x0C) |
                (byte3 << 0x06) | byte4;
            if (codePoint >= 0x010000 && codePoint <= 0x10FFFF) {
                return codePoint;
            }
        }

        throw Error('Invalid UTF-8 detected');
    }

    var byteArray;
    var byteCount;
    var byteIndex;
    function utf8decode(byteString) {
        byteArray = ucs2decode(byteString);
        byteCount = byteArray.length;
        byteIndex = 0;
        var codePoints = [];
        var tmp;
        while ((tmp = decodeSymbol()) !== false) {
            codePoints.push(tmp);
        }
        return ucs2encode(codePoints);
    }

    /*--------------------------------------------------------------------------*/

    var utf8 = {
        'version': '2.1.1',
        'encode': utf8encode,
        'decode': utf8decode
    };

    // Some AMD build optimizers, like r.js, check for specific condition patterns
    // like the following:
    if (
        typeof define == 'function' &&
        typeof define.amd == 'object' &&
        define.amd
    ) {
        define(function() {
            return utf8;
        });
    }   else if (freeExports && !freeExports.nodeType) {
        if (freeModule) { // in Node.js or RingoJS v0.8.0+
            freeModule.exports = utf8;
        } else { // in Narwhal or RingoJS v0.7.0-
            var object = {};
            var hasOwnProperty = object.hasOwnProperty;
            for (var key in utf8) {
                hasOwnProperty.call(utf8, key) && (freeExports[key] = utf8[key]);
            }
        }
    } else { // in Rhino or a web browser
        root.utf8 = utf8;
    }

}(this));

;/*!
loadCSS: load a CSS file asynchronously.
[c]2014 @scottjehl, Filament Group, Inc.
Licensed MIT
*/

/* exported loadCSS */
function loadCSS( href, before, media, callback ){
	"use strict";
	// Arguments explained:
	// `href` is the URL for your CSS file.
	// `before` optionally defines the element we'll use as a reference for injecting our <link>
	// By default, `before` uses the first <script> element in the page.
	// However, since the order in which stylesheets are referenced matters, you might need a more specific location in your document.
	// If so, pass a different reference element to the `before` argument and it'll insert before that instead
	// note: `insertBefore` is used instead of `appendChild`, for safety re: http://www.paulirish.com/2011/surefire-dom-element-insertion/
	var ss = window.document.createElement( "link" );
	var ref = before || window.document.getElementsByTagName( "script" )[ 0 ];
	var sheets = window.document.styleSheets;
	ss.rel = "stylesheet";
	ss.href = href;
	// temporarily, set media to something non-matching to ensure it'll fetch without blocking render
	ss.media = "only x";
	// DEPRECATED
	if( callback ) {
		ss.onload = callback;
	}

	// inject link
	ref.parentNode.insertBefore( ss, ref );
	// This function sets the link's media back to `all` so that the stylesheet applies once it loads
	// It is designed to poll until document.styleSheets includes the new sheet.
	ss.onloadcssdefined = function( cb ){
		var defined;
		for( var i = 0; i < sheets.length; i++ ){
			if( sheets[ i ].href && sheets[ i ].href.indexOf( href ) > -1 ){
				defined = true;
			}
		}
		if( defined ){
			cb();
		} else {
			setTimeout(function() {
				ss.onloadcssdefined( cb );
			});
		}
	};
	ss.onloadcssdefined(function() {
		ss.media = media || "all";
	});
	return ss;
}

;(function() {
    /**
     * Responsive sites rely heavily on resize events.
     * Hover, if a browser is resized while the user is in a different tab, there's no event.
     * Capture and retrigger these events as needed.
     */

    function getSize() {
        var $win = $(window);
        return [$win.width(), $win.height()];
    }

    function handleExit() {
        window._bg_resize_params = getSize();
    }

    function handleReentry() {
        if (window._bg_resize_params.join(":") !== getSize().join(":")) {
            $(window).trigger('resize');
        }
    }

    window._bg_resize_params = getSize();

    $(window).on("blur", handleExit);
    $(window).on("focus", handleReentry);

})();

;/**
 * Loads Disqus when you reach deep enough into of the page.
 */
(function($) {

    if (window.disqus_shortname === undefined) {
        return false;
    }

    var $disqusThread = $('#disqus_thread');
    if (!$disqusThread.length) {
        return false;
    }

    var loadComments = function() {
        if (!window.DISQUS) {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);    
        }
    };


    var hasButton = $("#disqus_thread a[href='#disqus_thread']").css("display") === "block";

    if (window.location.hash === "#disqus_thread" || window.location.hash.indexOf("#comment-") === 0) {
        // Check the hash, and possibly load comments immediately
        loadComments();
    } else if ($(window).width() > 640 || !hasButton) {
        // Lazy load on non-mobile devices, or pages that
        // don't have a load button on the container
        $(window).on("scroll.lazy_comments", _.debounce(function() {
            var yOffset = window.pageYOffset || document.documentElement.scrollTop;
            var limit = window.screen.height + yOffset;
            if ($disqusThread.offset().top < limit) {
                $(window).off(".lazy_comments");
                loadComments();
            }
        }, 100));   
    }

    // Comments activate on click
    $("body").on("click tap", "a[href='#disqus_thread']", function(e){
        loadComments();

        // Don't jump if the button is where the thread loads
        if ($(this).closest("#disqus_thread").length) {
            e.preventDefault();
            e.stopPropagation();
        }
    });

})(jQuery);


;/**
 * Open share popups on links with data-share attribute.
 */

window.Atlantic = window.Atlantic || {};
window.Atlantic.page_info = window.Atlantic.page_info || {};
Atlantic.SimpleShare = Atlantic.SimpleShare || {};

Atlantic.SimpleShare.utmParams = {
    "facebook": "utm_source=facebook&utm_medium=social&utm_campaign=share",
    "twitter": "utm_source=twitter&utm_medium=social&utm_campaign=share",
}

/**
 * Appends a utm_source to the url if a source is
 * passed and not already present on the link.
 */
Atlantic.SimpleShare.setUtmParams = function(url, utm_params) {
    if (utm_params && !url.match(/(\?|\&)utm_(\w+)=/)) {
        var hasGetParam = (url.indexOf("?") > -1);
        var param = (hasGetParam ? "&" : "?") + utm_params;
        url = url + param;
    }
    return url;
};

/**
 * There are two ways that networks can be referenced.
 *
 *  - As an object. This will create a popup window based on an underscore
 *    template. This object should contain the following keys:
 *      * `url` -- an underscore template of the share network
 *      * `width`/`height` -- each corresponding the size of the popup window
 *
 *  - As a function. This is a callback that receives a data object.
 */
Atlantic.SimpleShare.networks = {
    "facebook": function (data) {
        // Fallback to sharer.php if FB isn't available.
        if (typeof FB === "undefined") {
            Atlantic.SimpleShare.openWindow({
                "url": _.template("https://www.facebook.com/sharer/sharer.php?u=<%= url %>"),
                "width": 626,
                "height": 436
            }, data);
            return;
        }

        var params = {
            method: "feed",
            display: "popup",
            link: decodeURIComponent(data.url)
        };

        var fbMappings = {title: "name", dek: "description", image: "picture"};
        for (var key in fbMappings) {
            if (data[key]) {
                params[fbMappings[key]] = data[key];
            }
        }

        FB.ui(params);
    },
    "twitter": {
        "url": _.template("https://twitter.com/share?text=<%= text %>&url=<%= url %><% if (via) { %>&via=<%= via %><% } %><% if (hashtag) { %>&hashtags=<%= hashtag %><% } %>"),
        "width": 600,
        "height": 250
    },
    "googleplus": {
        "url": _.template("https://plus.google.com/share?url=<%= url %>"),
        "width": 500,
        "height": 600
    },
    "linkedin": {
        "url": _.template("http://www.linkedin.com/shareArticle?mini=true&url=<%= url %>"),
        "width": 520,
        "height": 570
    },
    "reddit": {
        "url": _.template("https://www.reddit.com/submit?url=<%= url %>"),
        "width": 900,
        "height": 600
    },
    "pinterest": {
        "url": _.template("https://www.pinterest.com/pin/create/button/?url=<%= url %>&description=<%= dek %><% if (image) { %>&media=<%= image %><% } %>"),
        "width": 700,
        "height": 300
    },
    "instapaper": {
        "sameWindow": true,
        "url": _.template("http://www.instapaper.com/hello2?url=<%= url %>"),
        "width": 900,
        "height": 600
    },
    "pocket": {
        "url": _.template("https://getpocket.com/edit.php?url=<%= url %>"),
        "width": 900,
        "height": 600
    },
    "tumblr": {
        "url": _.template("https://www.tumblr.com/share/link?url=<%= url %><% if (text) { %>&name=<%= text %><% } %>"),
        "width": 900,
        "height": 600
    },
    "whatsapp": {
        "sameWindow": true,
        "url": _.template("whatsapp://send?text=<%= url %>")
    },
    "sms": function (data) {
        var ua = window.navigator.userAgent.toLowerCase();
        // iPhone 8+: &body=
        if (   (ua.indexOf('ipad') !== -1) || (ua.indexOf('iphone') !== -1)) {
            window.open("sms:&body=" + data['url'] + encodeURIComponent(' ') + data['text'] );
        // Android 5+ & the new standard for other phone types: ?body=
        } else {
            window.open("sms:?body=" + data['url'] + encodeURIComponent(' ') + data['text'] );
        }
    },
    "print": function(data) { window.print(); }
};

Atlantic.SimpleShare.openWindow = function (network, data) {
    var url = network.url(data);

    if (network.sameWindow){
        window.location.href = url;
    }else{
        window.open(url, "share", "width=" + network.width + ",height=" + network.height + ",top=100,left=100");
    }
};

(function(){

    function forceAbsoluteUrl(url) {
        if (!url) {
            return;
        } else if (url.slice(0,2) === "//") {
            // Protocol relative url
            url = "http:" + url
        } else if (/^https?:\/\//.test(url) === false) {
            // Relative url
            url = window.location.protocol + "//" + window.location.host + url;
        }
        return url;
    }

    function decodeSpecialChars(text) {
        return encodeURIComponent($("<div />").html(text).text());
    }

    Atlantic.SimpleShare.share = function(network_name, data) {
        var network = Atlantic.SimpleShare.networks[network_name];
        var defaults = {
            'url': window.location.href,
            'text': Atlantic.page_info.share_text || $("meta[property='og:title']").attr("content") || document.title,
            'dek': $("meta[property='og:description']").attr("content"),
            'image': $("meta[property='og:image']").attr("content"),
            'title': Atlantic.page_info.share_title || Atlantic.page_info.title || $("meta[property='og:title']").attr("content"),
            'via': undefined,
            'hashtag': undefined
        }

        data = $.extend(defaults, data);

        // Append utm_source to url if available
        data.url = Atlantic.SimpleShare.setUtmParams(data.url,
            Atlantic.SimpleShare.utmParams[network_name])

        // Clean data
        data.url = encodeURIComponent(forceAbsoluteUrl(data.url));
        data.text = decodeSpecialChars(data.text);
        data.image = forceAbsoluteUrl(data.image);

        if (typeof network === "function") {
            network(data);
        } else if (typeof network === "object") {
            Atlantic.SimpleShare.openWindow(network, data);
        }
    }

    $(document).on('click tap', '[data-share]', function(e) {
        e.preventDefault();
        var $this = $(this);
        var network_name = $this.data("share");
        var network = Atlantic.SimpleShare.networks[network_name];

        Atlantic.SimpleShare.share(network_name, {
            'url': $this.data('shareUrl'),
            'text': $this.data('shareText'),
            'title': $this.data('shareTitle'),
            'via': $this.data('shareVia'),
            'hashtag': $this.data('shareHashtag'),
            'dek': $this.data('shareDescription'),
            'image': $this.data('shareImage')
        });
    });

})();


;/*
 * File: iframeResizer.js
 * Desc: Force iframes to size to content.
 * Requires: iframeResizer.contentWindow.js to be loaded into the target frame.
 * Doc: https://github.com/davidjbradshaw/iframe-resizer
 * Author: David J. Bradshaw - dave@bradshaw.net
 * Contributor: Jure Mav - jure.mav@gmail.com
 * Contributor: Reed Dadoune - reed@dadoune.com
 */


;(function(window) {
	'use strict';

	var
		count                 = 0,
		logEnabled            = false,
		hiddenCheckEnabled    = false,
		msgHeader             = 'message',
		msgHeaderLen          = msgHeader.length,
		msgId                 = '[iFrameSizer]', //Must match iframe msg ID
		msgIdLen              = msgId.length,
		pagePosition          = null,
		requestAnimationFrame = window.requestAnimationFrame,
		resetRequiredMethods  = {max:1,scroll:1,bodyScroll:1,documentElementScroll:1},
		settings              = {},
		timer                 = null,
		logId                 = 'Host Page',

		defaults              = {
			autoResize                : true,
			bodyBackground            : null,
			bodyMargin                : null,
			bodyMarginV1              : 8,
			bodyPadding               : null,
			checkOrigin               : true,
			inPageLinks               : false,
			enablePublicMethods       : true,
			heightCalculationMethod   : 'bodyOffset',
			id                        : 'iFrameResizer',
			interval                  : 32,
			log                       : false,
			maxHeight                 : Infinity,
			maxWidth                  : Infinity,
			minHeight                 : 0,
			minWidth                  : 0,
			resizeFrom                : 'parent',
			scrolling                 : false,
			sizeHeight                : true,
			sizeWidth                 : false,
			tolerance                 : 0,
			widthCalculationMethod    : 'scroll',
			closedCallback            : function(){},
			initCallback              : function(){},
			messageCallback           : function(){warn('MessageCallback function not defined');},
			resizedCallback           : function(){},
			scrollCallback            : function(){return true;}
		};

	function addEventListener(obj,evt,func){
		/* istanbul ignore else */ // Not testable in PhantonJS
		if ('attachEvent' in window){//IE
			obj.attachEvent('on'+evt,func);
		} else if ('addEventListener' in window){
			obj.addEventListener(evt,func, false);
		}
	}

	function removeEventListener(el,evt,func){
		/* istanbul ignore else */ // Not testable in phantonJS
		if ('detachEvent' in window){ //IE
			el.detachEvent('on'+evt,func);
		} else if ('removeEventListener' in window){
			el.removeEventListener(evt,func, false);
		}
	}

	function setupRequestAnimationFrame(){
		var
			vendors = ['moz', 'webkit', 'o', 'ms'],
			x;

		// Remove vendor prefixing if prefixed and break early if not
		for (x = 0; x < vendors.length && !requestAnimationFrame; x += 1) {
			requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];
		}

		if (!(requestAnimationFrame)){
			log('setup','RequestAnimationFrame not supported');
		}
	}

	function getMyID(iframeId){
		var retStr = 'Host page: '+iframeId;

		if (window.top!==window.self){
			if (window.parentIFrame && window.parentIFrame.getId){
				retStr = window.parentIFrame.getId()+': '+iframeId;
			} else {
				retStr = 'Nested host page: '+iframeId;
			}
		}

		return retStr;
	}

	function formatLogHeader(iframeId){
		return msgId + '[' + getMyID(iframeId) + ']';
	}

	function isLogEnabled(iframeId){
		return settings[iframeId] ? settings[iframeId].log : logEnabled;
	}

	function log(iframeId,msg){
		output('log',iframeId,msg,isLogEnabled(iframeId));
	}

	function info(iframeId,msg){
		output('info',iframeId,msg,isLogEnabled(iframeId));
	}

	function warn(iframeId,msg){
		output('warn',iframeId,msg,true);
	}

	function output(type,iframeId,msg,enabled){
		if (true === enabled && 'object' === typeof window.console){
			console[type](formatLogHeader(iframeId),msg);
		}
	}

	function iFrameListener(event){
		function resizeIFrame(){
			function resize(){
				setSize(messageData);
				setPagePosition(iframeId);
			}

			ensureInRange('Height');
			ensureInRange('Width');

			syncResize(resize,messageData,'init');
		}

		function processMsg(){
			var data = msg.substr(msgIdLen).split(':');

			return {
				iframe: settings[data[0]].iframe,
				id:     data[0],
				height: data[1],
				width:  data[2],
				type:   data[3]
			};
		}

		function ensureInRange(Dimension){
			var
				max  = Number(settings[iframeId]['max' + Dimension]),
				min  = Number(settings[iframeId]['min' + Dimension]),
				dimension = Dimension.toLowerCase(),
				size = Number(messageData[dimension]);

			log(iframeId,'Checking ' + dimension + ' is in range ' + min + '-' + max);

			if (size<min) {
				size=min;
				log(iframeId,'Set ' + dimension + ' to min value');
			}

			if (size>max) {
				size=max;
				log(iframeId,'Set ' + dimension + ' to max value');
			}

			messageData[dimension] = '' + size;
		}


		function isMessageFromIFrame(){
			function checkAllowedOrigin(){
				function checkList(){
					var
						i = 0,
						retCode = false;

					log(iframeId,'Checking connection is from allowed list of origins: ' + checkOrigin);

					for (; i < checkOrigin.length; i++) {
						if (checkOrigin[i] === origin) {
							retCode = true;
							break;
						}
					}
					return retCode;
				}

				function checkSingle(){
					var remoteHost  = settings[iframeId].remoteHost;
					log(iframeId,'Checking connection is from: '+remoteHost);
					return origin === remoteHost;
				}

				return checkOrigin.constructor === Array ? checkList() : checkSingle();
			}

			var
				origin      = event.origin,
				checkOrigin = settings[iframeId].checkOrigin;

			if (checkOrigin && (''+origin !== 'null') && !checkAllowedOrigin()) {
				throw new Error(
					'Unexpected message received from: ' + origin +
					' for ' + messageData.iframe.id +
					'. Message was: ' + event.data +
					'. This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.'
				);
			}

			return true;
		}

		function isMessageForUs(){
			return msgId === (('' + msg).substr(0,msgIdLen)) && (msg.substr(msgIdLen).split(':')[0] in settings); //''+Protects against non-string msg
		}

		function isMessageFromMetaParent(){
			//Test if this message is from a parent above us. This is an ugly test, however, updating
			//the message format would break backwards compatibity.
			var retCode = messageData.type in {'true':1,'false':1,'undefined':1};

			if (retCode){
				log(iframeId,'Ignoring init message from meta parent page');
			}

			return retCode;
		}

		function getMsgBody(offset){
			return msg.substr(msg.indexOf(':')+msgHeaderLen+offset);
		}

		function forwardMsgFromIFrame(msgBody){
			log(iframeId,'MessageCallback passed: {iframe: '+ messageData.iframe.id + ', message: ' + msgBody + '}');
			callback('messageCallback',{
				iframe: messageData.iframe,
				message: JSON.parse(msgBody)
			});
			log(iframeId,'--');
		}

		function getPageInfo(){
			var
				bodyPosition   = document.body.getBoundingClientRect(),
				iFramePosition = messageData.iframe.getBoundingClientRect();

			return JSON.stringify({
				iframeHeight: iFramePosition.height,
				iframeWidth:  iFramePosition.width,
				clientHeight: Math.max(document.documentElement.clientHeight, window.innerHeight || 0),
				clientWidth:  Math.max(document.documentElement.clientWidth,  window.innerWidth  || 0),
				offsetTop:    parseInt(iFramePosition.top  - bodyPosition.top,  10),
				offsetLeft:   parseInt(iFramePosition.left - bodyPosition.left, 10),
				scrollTop:    window.pageYOffset,
				scrollLeft:   window.pageXOffset
			});
		}

		function sendPageInfoToIframe(iframe,iframeId){
			function debouncedTrigger(){
				trigger(
					'Send Page Info',
					'pageInfo:' + getPageInfo(), 
					iframe, 
					iframeId
				);
			}

			debouce(debouncedTrigger,32);
		}


		function startPageInfoMonitor(){
			function setListener(type,func){
				function sendPageInfo(){
					if (settings[id]){
						sendPageInfoToIframe(settings[id].iframe,id);
					} else {
						stop();
					}
				}

				['scroll','resize'].forEach(function(evt){
					log(id, type +  evt + ' listener for sendPageInfo');
					func(window,evt,sendPageInfo);
				});
			}

			function stop(){
				setListener('Remove ', removeEventListener);
			}

			function start(){
				setListener('Add ', addEventListener);
			}
			
			var id = iframeId; //Create locally scoped copy of iFrame ID

			start();

			settings[id].stopPageInfo = stop;
		}

		function stopPageInfoMonitor(){
			if (settings[iframeId] && settings[iframeId].stopPageInfo){
				settings[iframeId].stopPageInfo();
				delete settings[iframeId].stopPageInfo;
			}
		}

		function checkIFrameExists(){
			var retBool = true;

			if (null === messageData.iframe) {
				warn(iframeId,'IFrame ('+messageData.id+') not found');
				retBool = false;
			}
			return retBool;
		}

		function getElementPosition(target){
			var iFramePosition = target.getBoundingClientRect();

			getPagePosition(iframeId);

			return {
				x: Math.floor( Number(iFramePosition.left) + Number(pagePosition.x) ),
				y: Math.floor( Number(iFramePosition.top)  + Number(pagePosition.y) )
			};
		}

		function scrollRequestFromChild(addOffset){
			/* istanbul ignore next */  //Not testable in Karma
			function reposition(){
				pagePosition = newPosition;
				scrollTo();
				log(iframeId,'--');
			}

			function calcOffset(){
				return {
					x: Number(messageData.width) + offset.x,
					y: Number(messageData.height) + offset.y
				};
			}

			function scrollParent(){
				if (window.parentIFrame){
					window.parentIFrame['scrollTo'+(addOffset?'Offset':'')](newPosition.x,newPosition.y);
				} else {
					warn(iframeId,'Unable to scroll to requested position, window.parentIFrame not found');
				}
			}

			var
				offset = addOffset ? getElementPosition(messageData.iframe) : {x:0,y:0},
				newPosition = calcOffset();

			log(iframeId,'Reposition requested from iFrame (offset x:'+offset.x+' y:'+offset.y+')');

			if(window.top!==window.self){
				scrollParent();
			} else {
				reposition();
			}
		}

		function scrollTo(){
			if (false !== callback('scrollCallback',pagePosition)){
				setPagePosition(iframeId);
			} else {
				unsetPagePosition();
			}
		}

		function findTarget(location){
			function jumpToTarget(){
				var jumpPosition = getElementPosition(target);

				log(iframeId,'Moving to in page link (#'+hash+') at x: '+jumpPosition.x+' y: '+jumpPosition.y);
				pagePosition = {
					x: jumpPosition.x,
					y: jumpPosition.y
				};

				scrollTo();
				log(iframeId,'--');
			}

			function jumpToParent(){
				if (window.parentIFrame){
					window.parentIFrame.moveToAnchor(hash);
				} else {
					log(iframeId,'In page link #'+hash+' not found and window.parentIFrame not found');
				}
			}

			var
				hash     = location.split('#')[1] || '',
				hashData = decodeURIComponent(hash),
				target   = document.getElementById(hashData) || document.getElementsByName(hashData)[0];

			if (target){
				jumpToTarget();
			} else if(window.top!==window.self){
				jumpToParent();
			} else {
				log(iframeId,'In page link #'+hash+' not found');
			}
		}

		function callback(funcName,val){
			return chkCallback(iframeId,funcName,val);
		}

		function actionMsg(){

			if(settings[iframeId].firstRun) firstRun();

			switch(messageData.type){
			case 'close':
				closeIFrame(messageData.iframe);
				break;
			case 'message':
				forwardMsgFromIFrame(getMsgBody(6));
				break;
			case 'scrollTo':
				scrollRequestFromChild(false);
				break;
			case 'scrollToOffset':
				scrollRequestFromChild(true);
				break;
			case 'pageInfo':
				sendPageInfoToIframe(settings[iframeId].iframe,iframeId);
				startPageInfoMonitor();
				break;
			case 'pageInfoStop':
				stopPageInfoMonitor();
				break;
			case 'inPageLink':
				findTarget(getMsgBody(9));
				break;
			case 'reset':
				resetIFrame(messageData);
				break;
			case 'init':
				resizeIFrame();
				callback('initCallback',messageData.iframe);
				callback('resizedCallback',messageData);
				break;
			default:
				resizeIFrame();
				callback('resizedCallback',messageData);
			}
		}

		function hasSettings(iframeId){
			var retBool = true;

			if (!settings[iframeId]){
				retBool = false;
				warn(messageData.type + ' No settings for ' + iframeId + '. Message was: ' + msg);
			}

			return retBool;
		}

		function iFrameReadyMsgReceived(){
			for (var iframeId in settings){
				trigger('iFrame requested init',createOutgoingMsg(iframeId),document.getElementById(iframeId),iframeId);
			}
		}

		function firstRun() {
			settings[iframeId].firstRun = false;
		}

		var
			msg = event.data,
			messageData = {},
			iframeId = null;

		if('[iFrameResizerChild]Ready' === msg){
			iFrameReadyMsgReceived();
		} else if (isMessageForUs()){
			messageData = processMsg();
			iframeId    = logId = messageData.id;

			if (!isMessageFromMetaParent() && hasSettings(iframeId)){
				log(iframeId,'Received: '+msg);

				if ( checkIFrameExists() && isMessageFromIFrame() ){
					actionMsg();
				}
			}
		} else {
			info(iframeId,'Ignored: '+msg);
		}

	}


	function chkCallback(iframeId,funcName,val){
		var
			func = null,
			retVal = null;

		if(settings[iframeId]){
			func = settings[iframeId][funcName];

			if( 'function' === typeof func){
				retVal = func(val);
			} else {
				throw new TypeError(funcName+' on iFrame['+iframeId+'] is not a function');
			}
		}

		return retVal;
	}

	function closeIFrame(iframe){
		var iframeId = iframe.id;

		log(iframeId,'Removing iFrame: '+iframeId);
		iframe.parentNode.removeChild(iframe);
		chkCallback(iframeId,'closedCallback',iframeId);
		log(iframeId,'--');
		delete settings[iframeId];
	}

	function getPagePosition(iframeId){
		if(null === pagePosition){
			pagePosition = {
				x: (window.pageXOffset !== undefined) ? window.pageXOffset : document.documentElement.scrollLeft,
				y: (window.pageYOffset !== undefined) ? window.pageYOffset : document.documentElement.scrollTop
			};
			log(iframeId,'Get page position: '+pagePosition.x+','+pagePosition.y);
		}
	}

	function setPagePosition(iframeId){
		if(null !== pagePosition){
			window.scrollTo(pagePosition.x,pagePosition.y);
			log(iframeId,'Set page position: '+pagePosition.x+','+pagePosition.y);
			unsetPagePosition();
		}
	}

	function unsetPagePosition(){
		pagePosition = null;
	}

	function resetIFrame(messageData){
		function reset(){
			setSize(messageData);
			trigger('reset','reset',messageData.iframe,messageData.id);
		}

		log(messageData.id,'Size reset requested by '+('init'===messageData.type?'host page':'iFrame'));
		getPagePosition(messageData.id);
		syncResize(reset,messageData,'reset');
	}

	function setSize(messageData){
		function setDimension(dimension){
			messageData.iframe.style[dimension] = messageData[dimension] + 'px';
			log(
				messageData.id,
				'IFrame (' + iframeId +
				') ' + dimension +
				' set to ' + messageData[dimension] + 'px'
			);
		}

		function chkZero(dimension){
			//FireFox sets dimension of hidden iFrames to zero.
			//So if we detect that set up an event to check for
			//when iFrame becomes visible.

			/* istanbul ignore next */  //Not testable in PhantomJS
			if (!hiddenCheckEnabled && '0' === messageData[dimension]){
				hiddenCheckEnabled = true;
				log(iframeId,'Hidden iFrame detected, creating visibility listener');
				fixHiddenIFrames();
			}
		}

		function processDimension(dimension){
			setDimension(dimension);
			chkZero(dimension);
		}

		var iframeId = messageData.iframe.id;

		if(settings[iframeId]){
			if( settings[iframeId].sizeHeight) { processDimension('height'); }
			if( settings[iframeId].sizeWidth ) { processDimension('width'); }
		}
	}

	function syncResize(func,messageData,doNotSync){
		/* istanbul ignore if */  //Not testable in PhantomJS
		if(doNotSync!==messageData.type && requestAnimationFrame){
			log(messageData.id,'Requesting animation frame');
			requestAnimationFrame(func);
		} else {
			func();
		}
	}

	function trigger(calleeMsg,msg,iframe,id){
		function postMessageToIFrame(){
			var target = settings[id].targetOrigin;
			log(id,'[' + calleeMsg + '] Sending msg to iframe['+id+'] ('+msg+') targetOrigin: '+target);
			iframe.contentWindow.postMessage( msgId + msg, target );
		}

		function iFrameNotFound(){
			info(id,'[' + calleeMsg + '] IFrame('+id+') not found');
			if(settings[id]) {
				delete settings[id];
			}
		}

		function chkAndSend(){
			if(iframe && 'contentWindow' in iframe && (null !== iframe.contentWindow)){ //Null test for PhantomJS
				postMessageToIFrame();
			} else {
				iFrameNotFound();
			}
		}

		id = id || iframe.id;

		if(settings[id]) {
			chkAndSend();
		}

	}

	function createOutgoingMsg(iframeId){
		return iframeId +
			':' + settings[iframeId].bodyMarginV1 +
			':' + settings[iframeId].sizeWidth +
			':' + settings[iframeId].log +
			':' + settings[iframeId].interval +
			':' + settings[iframeId].enablePublicMethods +
			':' + settings[iframeId].autoResize +
			':' + settings[iframeId].bodyMargin +
			':' + settings[iframeId].heightCalculationMethod +
			':' + settings[iframeId].bodyBackground +
			':' + settings[iframeId].bodyPadding +
			':' + settings[iframeId].tolerance +
			':' + settings[iframeId].inPageLinks +
			':' + settings[iframeId].resizeFrom +
			':' + settings[iframeId].widthCalculationMethod;
	}

	function setupIFrame(iframe,options){
		function setLimits(){
			function addStyle(style){
				if ((Infinity !== settings[iframeId][style]) && (0 !== settings[iframeId][style])){
					iframe.style[style] = settings[iframeId][style] + 'px';
					log(iframeId,'Set '+style+' = '+settings[iframeId][style]+'px');
				}
			}

			function chkMinMax(dimension){
				if (settings[iframeId]['min'+dimension]>settings[iframeId]['max'+dimension]){
					throw new Error('Value for min'+dimension+' can not be greater than max'+dimension);
				}
			}

			chkMinMax('Height');
			chkMinMax('Width');

			addStyle('maxHeight');
			addStyle('minHeight');
			addStyle('maxWidth');
			addStyle('minWidth');
		}

		function newId(){
			var id = ((options && options.id) || defaults.id + count++);
			if  (null!==document.getElementById(id)){
				id = id + count++;
			}
			return id;
		}

		function ensureHasId(iframeId){
			logId=iframeId;
			if (''===iframeId){
				iframe.id = iframeId =  newId();
				logEnabled = (options || {}).log;
				logId=iframeId;
				log(iframeId,'Added missing iframe ID: '+ iframeId +' (' + iframe.src + ')');
			}


			return iframeId;
		}

		function setScrolling(){
			log(iframeId,'IFrame scrolling ' + (settings[iframeId].scrolling ? 'enabled' : 'disabled') + ' for ' + iframeId);
			iframe.style.overflow = false === settings[iframeId].scrolling ? 'hidden' : 'auto';
			iframe.scrolling      = false === settings[iframeId].scrolling ? 'no' : 'yes';
		}

		//The V1 iFrame script expects an int, where as in V2 expects a CSS
		//string value such as '1px 3em', so if we have an int for V2, set V1=V2
		//and then convert V2 to a string PX value.
		function setupBodyMarginValues(){
			if (('number'===typeof(settings[iframeId].bodyMargin)) || ('0'===settings[iframeId].bodyMargin)){
				settings[iframeId].bodyMarginV1 = settings[iframeId].bodyMargin;
				settings[iframeId].bodyMargin   = '' + settings[iframeId].bodyMargin + 'px';
			}
		}

		function checkReset(){
			// Reduce scope of firstRun to function, because IE8's JS execution
			// context stack is borked and this value gets externally
			// changed midway through running this function!!!
			var
				firstRun           = settings[iframeId].firstRun,
				resetRequertMethod = settings[iframeId].heightCalculationMethod in resetRequiredMethods;

			if (!firstRun && resetRequertMethod){
				resetIFrame({iframe:iframe, height:0, width:0, type:'init'});
			}
		}

		function setupIFrameObject(){
			if(Function.prototype.bind){ //Ignore unpolyfilled IE8.
				settings[iframeId].iframe.iFrameResizer = {

					close        : closeIFrame.bind(null,settings[iframeId].iframe),

					resize       : trigger.bind(null,'Window resize', 'resize', settings[iframeId].iframe),

					moveToAnchor : function(anchor){
						trigger('Move to anchor','inPageLink:'+anchor, settings[iframeId].iframe,iframeId);
					},

					sendMessage  : function(message){
						message = JSON.stringify(message);
						trigger('Send Message','message:'+message, settings[iframeId].iframe,iframeId);
					}
				};
			}
		}

		//We have to call trigger twice, as we can not be sure if all
		//iframes have completed loading when this code runs. The
		//event listener also catches the page changing in the iFrame.
		function init(msg){
			function iFrameLoaded(){
				trigger('iFrame.onload',msg,iframe);
				checkReset();
			}

			addEventListener(iframe,'load',iFrameLoaded);
			trigger('init',msg,iframe);
		}

		function checkOptions(options){
			if ('object' !== typeof options){
				throw new TypeError('Options is not an object');
			}
		}

		function copyOptions(options){
			for (var option in defaults) {
				if (defaults.hasOwnProperty(option)){
					settings[iframeId][option] = options.hasOwnProperty(option) ? options[option] : defaults[option];
				}
			}
		}

		function getTargetOrigin (remoteHost){
			return ('' === remoteHost || 'file://' === remoteHost) ? '*' : remoteHost;
		}

		function processOptions(options){
			options = options || {};
			settings[iframeId] = {
				firstRun	: true,
				iframe		: iframe,
				remoteHost	: iframe.src.split('/').slice(0,3).join('/')
			};

			checkOptions(options);
			copyOptions(options);

			settings[iframeId].targetOrigin = true === settings[iframeId].checkOrigin ? getTargetOrigin(settings[iframeId].remoteHost) : '*';
		}

		function beenHere(){
			return (iframeId in settings && 'iFrameResizer' in iframe);
		}

		var iframeId = ensureHasId(iframe.id);

		if (!beenHere()){
			processOptions(options);
			setScrolling();
			setLimits();
			setupBodyMarginValues();
			init(createOutgoingMsg(iframeId));
			setupIFrameObject();
		} else {
			warn(iframeId,'Ignored iFrame, already setup.');
		}
	}

	function debouce(fn,time){
		if (null === timer){
			timer = setTimeout(function(){
				timer = null;
				fn();
			}, time);
		}
	}

	/* istanbul ignore next */  //Not testable in PhantomJS
	function fixHiddenIFrames(){
		function checkIFrames(){
			function checkIFrame(settingId){
				function chkDimension(dimension){
					return '0px' === settings[settingId].iframe.style[dimension];
				}

				function isVisible(el) {
					return (null !== el.offsetParent);
				}

				if (isVisible(settings[settingId].iframe) && (chkDimension('height') || chkDimension('width'))){
					trigger('Visibility change', 'resize', settings[settingId].iframe,settingId);
				}
			}

			for (var settingId in settings){
				checkIFrame(settingId);
			}
		}

		function mutationObserved(mutations){
			log('window','Mutation observed: ' + mutations[0].target + ' ' + mutations[0].type);
			debouce(checkIFrames,16);
		}

		function createMutationObserver(){
			var
				target = document.querySelector('body'),

				config = {
					attributes            : true,
					attributeOldValue     : false,
					characterData         : true,
					characterDataOldValue : false,
					childList             : true,
					subtree               : true
				},

				observer = new MutationObserver(mutationObserved);

			observer.observe(target, config);
		}

		var MutationObserver = window.MutationObserver || window.WebKitMutationObserver;

		if (MutationObserver) createMutationObserver();
	}


	function resizeIFrames(event){
		function resize(){
			sendTriggerMsg('Window '+event,'resize');
		}

		log('window','Trigger event: '+event);
		debouce(resize,16);
	}

	/* istanbul ignore next */  //Not testable in PhantomJS
	function tabVisible() {
		function resize(){
			sendTriggerMsg('Tab Visable','resize');
		}

		if('hidden' !== document.visibilityState) {
			log('document','Trigger event: Visiblity change');
			debouce(resize,16);
		}
	}

	function sendTriggerMsg(eventName,event){
		function isIFrameResizeEnabled(iframeId) {
			return	'parent' === settings[iframeId].resizeFrom &&
					settings[iframeId].autoResize &&
					!settings[iframeId].firstRun;
		}

		for (var iframeId in settings){
			if(isIFrameResizeEnabled(iframeId)){
				trigger(eventName,event,document.getElementById(iframeId),iframeId);
			}
		}
	}

	function setupEventListeners(){
		addEventListener(window,'message',iFrameListener);

		addEventListener(window,'resize', function(){resizeIFrames('resize');});

		addEventListener(document,'visibilitychange',tabVisible);
		addEventListener(document,'-webkit-visibilitychange',tabVisible); //Andriod 4.4
		addEventListener(window,'focusin',function(){resizeIFrames('focus');}); //IE8-9
		addEventListener(window,'focus',function(){resizeIFrames('focus');});
	}


	function factory(){
		function init(options,element){
			function chkType(){
				if(!element.tagName) {
					throw new TypeError('Object is not a valid DOM element');
				} else if ('IFRAME' !== element.tagName.toUpperCase()) {
					throw new TypeError('Expected <IFRAME> tag, found <'+element.tagName+'>');
				}
			}

			if(element) {
				chkType();
				setupIFrame(element, options);
				iFrames.push(element);
			}
		}

		var iFrames;

		setupRequestAnimationFrame();
		setupEventListeners();

		return function iFrameResizeF(options,target){
			iFrames = []; //Only return iFrames past in on this call

			switch (typeof(target)){
			case 'undefined':
			case 'string':
				Array.prototype.forEach.call(
					document.querySelectorAll( target || 'iframe' ),
					init.bind(undefined, options)
				);
				break;
			case 'object':
				init(options,target);
				break;
			default:
				throw new TypeError('Unexpected data type ('+typeof(target)+')');
			}

			return iFrames;
		};
	}

	function createJQueryPublicMethod($){
		$.fn.iFrameResize = function $iFrameResizeF(options) {
			return this.filter('iframe').each(function (index, element) {
				setupIFrame(element, options);
			}).end();
		};
	}

	if (window.jQuery) { createJQueryPublicMethod(jQuery); }

	if (typeof define === 'function' && define.amd) {
		define([],factory);
	} else if (typeof module === 'object' && typeof module.exports === 'object') { //Node for browserfy
		module.exports = factory();
	} else {
		window.iFrameResize = window.iFrameResize || factory();
	}

})(window || {});

;/**
 * Changes the height of iframes that have the auto-relow class so 
 * their full contents are shown. This is useful on responsive
 * embeds that don't retain their proportions when they're shrunk.
 *
 * This is intended for embeds. Videos, and other things that have
 * a locked proportion should keep using the regular padding method.
 */
(function($) {

    var $legacyReflowIframes = $('iframe.auto-reflow');
    var $iframes = $('iframe:not(.auto-reflow):not(.no-resize)');

    if (!$iframes.length && !$legacyReflowIframes.length) {
        return;  // Nothing to do.
    }

    // This is the new standard way to do iframe resizing.
    if ($.fn.iFrameResize) {
        $iframes.each(function(i, iframe) {
            $(iframe).iFrameResize({
                checkOrigin: false,
                resizedCallback: function (data) {
                    var $iframe = $(data.iframe),
                        width = parseInt(data.width, 10),
                        height = parseInt(data.height, 10),
                        $parent = $iframe.parent();
                    if ($iframe.css('position') == 'absolute' && $parent.is('.embed-wrapper')) {
                        $parent.css({
                            'padding-bottom': (100 * (height / width)).toFixed(2) + '%'
                        });
                    }
                }
            });
        });
    }

    // Everything below this line is only ever used with class="auto-reflow",
    // which is deprecated.
    function getHeight($iframe) {
        try {
            return $iframe[0].contentWindow.document.body.scrollHeight;
        } catch (e) {
            return null;
        }
    }

    // For iframes that are not in wrapping divs.
    // This is used in the admin.
    function adjustIframe($iframe){
        $iframe.css({"height": null});
        var height = getHeight($iframe);
        if (height && height > $iframe.attr("height")) {
            $iframe.height(height);
        }
    }

    // For responsified iframes that are 100%
    // of the parent width.
    function adjustParentElement($iframe) {
        var $el = $iframe.parent();
        $el.css({"height": 0, "padding-bottom": 0});

        var height = getHeight($iframe);

        // If we don't know the height, reset the iframe and get it.
        if (!height && window.iFrameResize) {
            $iframe.iFrameResize({
                minHeight: $iframe.attr('height') || 0
            });
            height = $iframe.height();
        }

        // In theory there might still be no height.
        if (height) {
            // var proportion = 100 * (height / $el.outerWidth());
            // proportion = proportion.toString() + "%";
            $el.css({
                "paddingBottom": 0,
                "height": height,
                "max-height": height
            });
        }

    }

    function reflowIframes() {
        var scrollPosition = window.pageYOffset || document.documentElement.scrollTop;
        for (var i = 0; i < $legacyReflowIframes.length; i++) {
            if ($legacyReflowIframes.eq(i).css("position") === "absolute") {
                adjustParentElement($legacyReflowIframes.eq(i));
            } else {
                adjustIframe($legacyReflowIframes.eq(i));
            }
        }
        window.scrollTo(0, scrollPosition);  // This shouldn't move the user's place on the page.
    }

    // Some iframes won't be done loading by this point.
    // Just in case, listen for onload events to retrigger.
    $legacyReflowIframes.on("load", _.debounce(reflowIframes, 500));

    // If there are iframes on the page, check the
    // sizes again if the browser resizes.
    $(window).on("resize", _.debounce(reflowIframes, 500));
    $(document).on("ready", reflowIframes);

}(window.jQuery));

;(function ($) {
    $('.toggleable .toggleable-button').on('click', function() {
        var $toggleable = $(this).closest('.toggleable');

        $('.toggleable-content', $toggleable).slideToggle('fast', function () {
            var visible = $(this).is(':visible');
            if (visible) {
                $toggleable.addClass('open').removeClass('closed');
            } else {
                $toggleable.addClass('closed').removeClass('open');
            }
        });
    });
})(jQuery);

;// Generated by CoffeeScript 1.6.2
/*!
jQuery Waypoints - v2.0.5
Copyright (c) 2011-2014 Caleb Troughton
Licensed under the MIT license.
https://github.com/imakewebthings/jquery-waypoints/blob/master/licenses.txt
*/
(function(){var t=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++){if(e in this&&this[e]===t)return e}return-1},e=[].slice;(function(t,e){if(typeof define==="function"&&define.amd){return define("waypoints",["jquery"],function(n){return e(n,t)})}else{return e(t.jQuery,t)}})(window,function(n,r){var i,o,l,s,f,u,c,a,h,d,p,y,v,w,g,m;i=n(r);a=t.call(r,"ontouchstart")>=0;s={horizontal:{},vertical:{}};f=1;c={};u="waypoints-context-id";p="resize.waypoints";y="scroll.waypoints";v=1;w="waypoints-waypoint-ids";g="waypoint";m="waypoints";o=function(){function t(t){var e=this;this.$element=t;this.element=t[0];this.didResize=false;this.didScroll=false;this.id="context"+f++;this.oldScroll={x:t.scrollLeft(),y:t.scrollTop()};this.waypoints={horizontal:{},vertical:{}};this.element[u]=this.id;c[this.id]=this;t.bind(y,function(){var t;if(!(e.didScroll||a)){e.didScroll=true;t=function(){e.doScroll();return e.didScroll=false};return r.setTimeout(t,n[m].settings.scrollThrottle)}});t.bind(p,function(){var t;if(!e.didResize){e.didResize=true;t=function(){n[m]("refresh");return e.didResize=false};return r.setTimeout(t,n[m].settings.resizeThrottle)}})}t.prototype.doScroll=function(){var t,e=this;t={horizontal:{newScroll:this.$element.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.$element.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}};if(a&&(!t.vertical.oldScroll||!t.vertical.newScroll)){n[m]("refresh")}n.each(t,function(t,r){var i,o,l;l=[];o=r.newScroll>r.oldScroll;i=o?r.forward:r.backward;n.each(e.waypoints[t],function(t,e){var n,i;if(r.oldScroll<(n=e.offset)&&n<=r.newScroll){return l.push(e)}else if(r.newScroll<(i=e.offset)&&i<=r.oldScroll){return l.push(e)}});l.sort(function(t,e){return t.offset-e.offset});if(!o){l.reverse()}return n.each(l,function(t,e){if(e.options.continuous||t===l.length-1){return e.trigger([i])}})});return this.oldScroll={x:t.horizontal.newScroll,y:t.vertical.newScroll}};t.prototype.refresh=function(){var t,e,r,i=this;r=n.isWindow(this.element);e=this.$element.offset();this.doScroll();t={horizontal:{contextOffset:r?0:e.left,contextScroll:r?0:this.oldScroll.x,contextDimension:this.$element.width(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:r?0:e.top,contextScroll:r?0:this.oldScroll.y,contextDimension:r?n[m]("viewportHeight"):this.$element.height(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}};return n.each(t,function(t,e){return n.each(i.waypoints[t],function(t,r){var i,o,l,s,f;i=r.options.offset;l=r.offset;o=n.isWindow(r.element)?0:r.$element.offset()[e.offsetProp];if(n.isFunction(i)){i=i.apply(r.element)}else if(typeof i==="string"){i=parseFloat(i);if(r.options.offset.indexOf("%")>-1){i=Math.ceil(e.contextDimension*i/100)}}r.offset=o-e.contextOffset+e.contextScroll-i;if(r.options.onlyOnScroll&&l!=null||!r.enabled){return}if(l!==null&&l<(s=e.oldScroll)&&s<=r.offset){return r.trigger([e.backward])}else if(l!==null&&l>(f=e.oldScroll)&&f>=r.offset){return r.trigger([e.forward])}else if(l===null&&e.oldScroll>=r.offset){return r.trigger([e.forward])}})})};t.prototype.checkEmpty=function(){if(n.isEmptyObject(this.waypoints.horizontal)&&n.isEmptyObject(this.waypoints.vertical)){this.$element.unbind([p,y].join(" "));return delete c[this.id]}};return t}();l=function(){function t(t,e,r){var i,o;if(r.offset==="bottom-in-view"){r.offset=function(){var t;t=n[m]("viewportHeight");if(!n.isWindow(e.element)){t=e.$element.height()}return t-n(this).outerHeight()}}this.$element=t;this.element=t[0];this.axis=r.horizontal?"horizontal":"vertical";this.callback=r.handler;this.context=e;this.enabled=r.enabled;this.id="waypoints"+v++;this.offset=null;this.options=r;e.waypoints[this.axis][this.id]=this;s[this.axis][this.id]=this;i=(o=this.element[w])!=null?o:[];i.push(this.id);this.element[w]=i}t.prototype.trigger=function(t){if(!this.enabled){return}if(this.callback!=null){this.callback.apply(this.element,t)}if(this.options.triggerOnce){return this.destroy()}};t.prototype.disable=function(){return this.enabled=false};t.prototype.enable=function(){this.context.refresh();return this.enabled=true};t.prototype.destroy=function(){delete s[this.axis][this.id];delete this.context.waypoints[this.axis][this.id];return this.context.checkEmpty()};t.getWaypointsByElement=function(t){var e,r;r=t[w];if(!r){return[]}e=n.extend({},s.horizontal,s.vertical);return n.map(r,function(t){return e[t]})};return t}();d={init:function(t,e){var r;e=n.extend({},n.fn[g].defaults,e);if((r=e.handler)==null){e.handler=t}this.each(function(){var t,r,i,s;t=n(this);i=(s=e.context)!=null?s:n.fn[g].defaults.context;if(!n.isWindow(i)){i=t.closest(i)}i=n(i);r=c[i[0][u]];if(!r){r=new o(i)}return new l(t,r,e)});n[m]("refresh");return this},disable:function(){return d._invoke.call(this,"disable")},enable:function(){return d._invoke.call(this,"enable")},destroy:function(){return d._invoke.call(this,"destroy")},prev:function(t,e){return d._traverse.call(this,t,e,function(t,e,n){if(e>0){return t.push(n[e-1])}})},next:function(t,e){return d._traverse.call(this,t,e,function(t,e,n){if(e<n.length-1){return t.push(n[e+1])}})},_traverse:function(t,e,i){var o,l;if(t==null){t="vertical"}if(e==null){e=r}l=h.aggregate(e);o=[];this.each(function(){var e;e=n.inArray(this,l[t]);return i(o,e,l[t])});return this.pushStack(o)},_invoke:function(t){this.each(function(){var e;e=l.getWaypointsByElement(this);return n.each(e,function(e,n){n[t]();return true})});return this}};n.fn[g]=function(){var t,r;r=arguments[0],t=2<=arguments.length?e.call(arguments,1):[];if(d[r]){return d[r].apply(this,t)}else if(n.isFunction(r)){return d.init.apply(this,arguments)}else if(n.isPlainObject(r)){return d.init.apply(this,[null,r])}else if(!r){return n.error("jQuery Waypoints needs a callback function or handler option.")}else{return n.error("The "+r+" method does not exist in jQuery Waypoints.")}};n.fn[g].defaults={context:r,continuous:true,enabled:true,horizontal:false,offset:0,triggerOnce:false};h={refresh:function(){return n.each(c,function(t,e){return e.refresh()})},viewportHeight:function(){var t;return(t=r.innerHeight)!=null?t:i.height()},aggregate:function(t){var e,r,i;e=s;if(t){e=(i=c[n(t)[0][u]])!=null?i.waypoints:void 0}if(!e){return[]}r={horizontal:[],vertical:[]};n.each(r,function(t,i){n.each(e[t],function(t,e){return i.push(e)});i.sort(function(t,e){return t.offset-e.offset});r[t]=n.map(i,function(t){return t.element});return r[t]=n.unique(r[t])});return r},above:function(t){if(t==null){t=r}return h._filter(t,"vertical",function(t,e){return e.offset<=t.oldScroll.y})},below:function(t){if(t==null){t=r}return h._filter(t,"vertical",function(t,e){return e.offset>t.oldScroll.y})},left:function(t){if(t==null){t=r}return h._filter(t,"horizontal",function(t,e){return e.offset<=t.oldScroll.x})},right:function(t){if(t==null){t=r}return h._filter(t,"horizontal",function(t,e){return e.offset>t.oldScroll.x})},enable:function(){return h._invoke("enable")},disable:function(){return h._invoke("disable")},destroy:function(){return h._invoke("destroy")},extendFn:function(t,e){return d[t]=e},_invoke:function(t){var e;e=n.extend({},s.vertical,s.horizontal);return n.each(e,function(e,n){n[t]();return true})},_filter:function(t,e,r){var i,o;i=c[n(t)[0][u]];if(!i){return[]}o=[];n.each(i.waypoints[e],function(t,e){if(r(i,e)){return o.push(e)}});o.sort(function(t,e){return t.offset-e.offset});return n.map(o,function(t){return t.element})}};n[m]=function(){var t,n;n=arguments[0],t=2<=arguments.length?e.call(arguments,1):[];if(h[n]){return h[n].apply(null,t)}else{return h.aggregate.call(null,n)}};n[m].settings={resizeThrottle:100,scrollThrottle:30};return i.on("load.waypoints",function(){return n[m]("refresh")})})}).call(this);
;(function() {
    /**
     * Initialize SystemJS legacy bundle for use with paywall and universal components
     */
    SystemJS.import('theatlantic/js/legacy').then(function () {
        var event = document.createEvent('Event');
        event.initEvent('system:ready', true, true);
        window.dispatchEvent(event);
    });

    $('.toggle').on('click', function(e) {
        e.preventDefault();
        if ($(this).width() < 350) { //only works on mobile
            var $sign = $(this).find('span');
            var content = $sign.text();
            if (content === '+') {
                $sign.text('-');
                $(this).parent().next().removeClass('toggleable-content');
            } else {
                $sign.text('+');
                $(this).parent().next().addClass('toggleable-content');
            }
        }
    });

    window.Atlantic = window.Atlantic || {};
    window.ad_queue = window.ad_queue || [];
    window.ad_queue.push(function(){
        // Timeline
        var parsedReferrer = Atlantic.Utils.parseUrl(document.referrer);
        var isDebug = window.location.search.match(/debug_timeline/);
        if (parsedReferrer.path === '/timeline/' || isDebug) {
            var template = _.template(
                '<div class="c-timeline-badge">' +
                    '<a class="c-timeline-badge__link js-timeline-badge__link" href="<%= previousLocation %>">' +
                        '<span class="c-timeline-badge__year o-badge-content"></span> <span class="c-timeline-badge__text o-badge-content">Return to the<br>Timeline Project</span>' +
                    '</a>' +
                    '<gpt-ad id="timeline-ad-logo"' +
                        ' targeting-pos="logo-timeline-art"' +
                        ' class="ad ad-logo c-timeline-badge__ad"' +
                        ' lazy-load="1" ' +
                        ' data-object-name="logo">' +
                        '<gpt-sizeset viewport-size="[0, 0]" sizes="[[88, 31], [120, 60]]"></gpt-sizeset>' +
                    '</gpt-ad>' +
                '</div>'
            );
            var backHtml = template({
                previousLocation: document.referrer || '/timeline/'
            });

            // Full Width Articles need the badge placed in a different spot.
            var $insertPoint = $('body').hasClass('article-full') ? $('.social-kit-top') : $('.article-above .hed');
            $insertPoint.before(backHtml);
            $('.js-timeline-badge__link').on('click', function () {
                window.history.back();
                return false;
            });
        }
    });

})();

;(function () {
    //reveals all author categories
    $('.show-all').on('click', function(e) {
        e.preventDefault();
        $('.categorylist').removeClass('fade');
        $(this).remove();
    });

    //reveals full author bio
    $('.bio .more').on('click', function(e) {
        e.preventDefault();
        $(this).next('.hidden').removeClass('hidden');
        $(this).remove();
    });
})();

;window.Atlantic = window.Atlantic || {};

/**
 * Rate-limited editorial promotions.
 */
(function() {

    // Setting ?test_promo=1 where 1 is the pk will skip rate limiting,
    // for easy debugging.
    var debugMatch = window.location.search.match(/test_promo\=(\d+)/);
    var $promos = $("script[type='text/injector-promo']");
    var $destination = $(".js-inject-promo");

    // If there's not both promotions to use
    // or a place to put them, stop.
    if (!$promos.length || !$destination.length) {
        return;
    }

    function sendCustomEvent(id) {
      var details = {
        action: 'legacy house promo feature module viewed',
        label: id
      };

      Atlantic.Utils.customEvent(window, 'product:interaction', { detail: details });
    }

    var $promo, id, name, cookieName, cookieLength, seen, $el;
    for (var i = 0; i < $promos.length; i++) {
        $promo = $promos.eq(i);
        id = $promo.data().objId;
        name = $promo.data().name.toLowerCase().trim();
        cookieName = "promo-seen-" + id;
        cookieLength = $promo.data().rateLimit;
        seen = Atlantic.Utils.readCookie(cookieName);

        // Allow forcing a public promo to show
        if (debugMatch && parseInt(debugMatch[1], 10) === id) {
            seen = false;
        } else if (debugMatch) {
            // If we're in debug mode, hide all the others
            continue;
        }

        // Show the first promo that hasn't been seen or isn't being throttled
        if (!seen) {
            // Add the Promotion's html to the top of the article body.
            $el = $("<div class='injector-promo' role='complementary' />").append($promo.text());
            $el.attr("data-pk", id);

            $destination.append($el);

            if(Atlantic.Utils.customEvent) {
                sendCustomEvent(id);
            } else {
                $(window).on('system:ready', function() {
                    sendCustomEvent(id);
                });
            }

            // Don't make a cookie if this is seen every pageview.
            if (cookieLength > 0) {
                Atlantic.Utils.createCookie(cookieName, "1", cookieLength);
            }
            break;
        }
    }

})();

;(function(){

    window.Atlantic = window.Atlantic || {};

    var DEFAULT_MESSAGES = {
        updated: "Your newsletter subscription preferences have been updated.",
        confirm: ("<strong>You're almost finished.</strong><br/><br />" +
                            "<br/><br />" +
                            "To complete the subscription process, please click " +
                            "the link in the email we just sent you."),
        error: "An unknown error occurred."
    };


    /**
     * Abstract function for newsletter signups
     * that has no opinion on what happens to the DOM.
     *
     * @param  {object} options
     *
     * Example usage:
     *
     *  Atlantic.newsletterSignup({
     *      formElement: document.getElementById("c-form"),
     *      trackingId: "unique-id-for-form",
     *      callback: function(success, msg) {
     *          // Code
     *      },
     *      messages: {
     *          confirmed: "Woohoo!",
     *      }
     *  }); *
     *
     * Or, if you want to use event delegation
     *
     *  Atlantic.newsletterSignup({
     *      selector: ".js-form-signup",
     *      trackingId: function($form){
     *          return "unique-id-for-form"
     *      },
     *      callback: function(success, msg) {
     *          // Code
     *      }
     *  });
     *
     */
    Atlantic.newsletterSignup = function(options) {
        var api_endpoint = options.url || '/newsletters/api/sign-up/';
        var callback = options.callback;
        var trackingId = options.trackingId;
        var messages = $.extend(DEFAULT_MESSAGES, options.messages);

        /**
         * Acquire tracking details from the form's contents to make available
         * to the data team
         * @param  {Object} $form jQuery object of the submitted form
         * @return {Array}        An array of detail objects for custom events
         */
        function getTrackingDetails($form) {
            var details = [];
            var email = $form.find('input[name="email"]').val();
            var newsletterName = $form.find('input[name="newsletterName"]').val();
            var $newsletterInput = $form.find('input[name="newsletters"]');
            var newsletterMessage = $form.find('input[name="message"]').val();

            var contactLists = {
                '7607877': {
                    name: 'Partners',
                    objective: 'email_promotional_external'
                },
                '10502649': {
                    name: 'Partners - GDPR',
                    objective: 'email_promotional_external',
                },
                '10502643': {
                    name: 'Brand Marketing - GDPR',
                    objective: 'email_promotional'
                }
            };

            if ($newsletterInput.length > 1) {
                var $checkboxes = $newsletterInput.filter(':checked');
                var $hiddens = $newsletterInput.filter('[type="hidden"]');

                if ($hiddens.length) {
                    $hiddens.each(function() {
                        details.push({
                            newsletter: $(this).val(),
                            newsletterName: newsletterName,
                            objective: 'email_newsletter',
                            message: newsletterMessage
                        });
                    });
                }

                if ($checkboxes.length) {
                    $checkboxes.each(function() {
                        var $checkbox = $(this);
                        var contactList = $checkbox.val();
                        var label = $checkbox.parent('label').text().trim().replace(/ *\(Preview\)/g, '');
                        var data = {
                            newsletter: contactList,
                            newsletterName: label,
                            objective: 'email_newsletter'
                        };

                        if (contactList in contactLists) {
                            data.message = label;
                            data.newsletterName = contactLists[contactList].name;
                            data.objective = contactLists[contactList].objective;
                        }

                        details.push(data);
                    });
                }

            } else {
                details.push({
                    newsletter: $newsletterInput.val(),
                    newsletterName: newsletterName,
                    objective: 'email_newsletter'
                });
            }

            details.map(function(detail) {
                detail.email = email;
            });

            return details;
        }

        function handleSubmit(e) {
            var $form = $(e.target);
            var trackingDetails = getTrackingDetails($form);

            // Lock form to prevent sending duplicates
            $form.find("input, textarea").attr('readonly', true);
            $form.find("button").attr('disabled', true);

            e.preventDefault();
            e.stopPropagation();

            // Call specified endpoint
            var request = $.ajax({
                url: api_endpoint,
                type: 'POST',
                dataType: 'json',
                data: $form.serialize()
            });

            request.done(function(data, statusText, xhr) {
                // Prevent data from being undefined
                // so we can safely tap properties.
                data = data || {};

                var msg;
                if (data.success) {
                    // Send message to success callback
                    msg = messages.confirm;
                    if (data.existing_user) {
                        msg = messages.updated;
                    }

                    // Analytics
                    if (trackingId) {
                        var identifier = trackingId;
                        if ($.isFunction(trackingId)) {identifier = trackingId($form);
                        }

                        trackingDetails = trackingDetails.map(function(detail) {
                            detail.id = identifier;
                            detail.pagemodule = String(detail.id + ' / ' + Atlantic.page_info.view + ' - sign up for ' + detail.newsletterName);;
                            Atlantic.Utils.customEvent(window, 'newsletter:signup', { detail: detail });
                        });
                    } else {
                        console.warn("This newsletter signup is " +
                            "not being tracked. Add a trackingId to `options`.");
                    }

                } else {

                    // Set error message if available
                    msg = messages.error;
                    if (data.error) {
                        msg = data.error;
                    }
                }

                if (callback) {
                    callback.call($form, data.success || false, msg);
                }
            });

            request.fail(function(data, statusText, xhr) {
                if (callback) {
                    callback.call($form, false, messages.error);
                }
            });

            request.always(function() {
                // Unlock form
                $form.find("input, textarea").removeAttr('readonly');
                $form.find("button").removeAttr('disabled');
            });
        }

        if (!options.formElement && !options.selector) {
            console.error("Pass `options.formElement` or `options.selector` "+
                "to `Atlantic.newsletterSignup`, or it won't do anything.");
        }

        if (options.formElement) {
            $(options.formElement).on("submit", handleSubmit);
        }

        if (options.selector) {
            $(document).on("submit", options.selector, handleSubmit);
        }

    };

    // Set up interaction on newsletter units
    // @DEPRECRATED: Use Atlantic.newsletterSignup.
    // @TODO: Find and replace all usage of this.
    Atlantic.setUpNewsletterSignUp = function (selector, api_endpoint) {

        var successMsg = function ($el, msg) {
            $el.find('.message').show().removeClass('error').addClass('success').html(msg);
        };

        var errorMsg = function ($el, msg) {
            $el.find('.message').show().removeClass('success').addClass('error').html('<strong>Error:</strong> ' + msg);
        };

        Atlantic.newsletterSignup({
            selector: selector,
            trackingId: function($form) {
                // For backwards compability.
                var id = $form.attr("id");
                return (id) ? id.replace(/\s/g, "-") : "unknown";
            },
            callback: function(success, msg) {
                if (success) {
                    successMsg(this, msg);
                } else {
                    errorMsg(this, msg);
                }
            }
        });
    };

    // Default selector
    Atlantic.setUpNewsletterSignUp('[data-newsletter-signup]', '/newsletters/api/sign-up/');

    // According to Canadian law, forms should not be checked by default
    var allowSharingInput = $("input[value=7607877]");

    function handleCanadianCheck() {
        if ($(allowSharingInput).is(':checked')) {
             Atlantic.User.getGeoLocation(function(data){
                if (data.country === 'CA') {
                    $(allowSharingInput).removeAttr("checked");
                }
            });
        }
    }

    if (!window.Atlantic.User) {
        $(window).on('system:ready', handleCanadianCheck);
    } else {
        handleCanadianCheck();
    }
})();

;/*
 * ScrollToFixed
 * https://github.com/bigspotteddog/ScrollToFixed
 *
 * Copyright (c) 2011 Joseph Cava-Lynch
 * MIT license
 */
(function($) {
    $.isScrollToFixed = function(el) {
        return !!$(el).data('ScrollToFixed');
    };

    $.ScrollToFixed = function(el, options) {
        // To avoid scope issues, use 'base' instead of 'this' to reference this
        // class from internal events and functions.
        var base = this;
        var $window = $(window);

        // Access to jQuery and DOM versions of element.
        base.$el = $(el);
        base.el = el;

        // A flag so we know if the scroll has been reset.
        var isReset = false;

        // The element that was given to us to fix if scrolled above the top of
        // the page.
        var target = base.$el;

        var position;
        var originalPosition;
        var originalFloat;
        var originalOffsetTop;
        var originalZIndex;

        // The offset top of the element when resetScroll was called. This is
        // used to determine if we have scrolled past the top of the element.
        var offsetTop = 0;

        // The offset left of the element when resetScroll was called. This is
        // used to move the element left or right relative to the horizontal
        // scroll.
        var offsetLeft = 0;
        var originalOffsetLeft = -1;

        // This last offset used to move the element horizontally. This is used
        // to determine if we need to move the element because we would not want
        // to do that for no reason.
        var lastOffsetLeft = -1;

        // This is the element used to fill the void left by the target element
        // when it goes fixed; otherwise, everything below it moves up the page.
        var spacer = null;

        var spacerClass;

        var className;

        // Capture the original offsets for the target element. This needs to be
        // called whenever the page size changes or when the page is first
        // scrolled. For some reason, calling this before the page is first
        // scrolled causes the element to become fixed too late.
        function resetScroll() {
            // Set the element to it original positioning.
            target.trigger('preUnfixed.ScrollToFixed');
            setUnfixed();
            target.trigger('unfixed.ScrollToFixed');

            // Reset the last offset used to determine if the page has moved
            // horizontally.
            lastOffsetLeft = -1;

            // Capture the offset top of the target element.
            offsetTop = target.offset().top;

            // Capture the offset left of the target element.
            offsetLeft = target.offset().left;

            // If the offsets option is on, alter the left offset.
            if (base.options.offsets) {
                offsetLeft += (target.offset().left - target.position().left);
            }

            if (originalOffsetLeft == -1) {
                originalOffsetLeft = offsetLeft;
            }

            position = target.css('position');

            // Set that this has been called at least once.
            isReset = true;

            if (base.options.bottom != -1) {
                target.trigger('preFixed.ScrollToFixed');
                setFixed();
                target.trigger('fixed.ScrollToFixed');
            }
        }

        function getLimit() {
            var limit = base.options.limit;
            if (!limit) return 0;

            if (typeof(limit) === 'function') {
                return limit.apply(target);
            }
            return limit;
        }

        // Returns whether the target element is fixed or not.
        function isFixed() {
            return position === 'fixed';
        }

        // Returns whether the target element is absolute or not.
        function isAbsolute() {
            return position === 'absolute';
        }

        function isUnfixed() {
            return !(isFixed() || isAbsolute());
        }

        // Sets the target element to fixed. Also, sets the spacer to fill the
        // void left by the target element.
        function setFixed() {
            // Only fix the target element and the spacer if we need to.
            if (!isFixed()) {
                //get REAL dimensions (decimal fix)
                //Ref. http://stackoverflow.com/questions/3603065/how-to-make-jquery-to-not-round-value-returned-by-width
                var dimensions = target[0].getBoundingClientRect();

                // Set the spacer to fill the height and width of the target
                // element, then display it.
                spacer.css({
                    'display' : target.css('display'),
                    'width' : dimensions.width,
                    'height' : dimensions.height,
                    'float' : target.css('float')
                });

                // Set the target element to fixed and set its width so it does
                // not fill the rest of the page horizontally. Also, set its top
                // to the margin top specified in the options.

                var cssOptions={
                    'z-index' : base.options.zIndex,
                    'position' : 'fixed',
                    'top' : base.options.bottom == -1?getMarginTop():'',
                    'bottom' : base.options.bottom == -1?'':base.options.bottom,
                    'margin-left' : '0px'
                };
                if (!base.options.dontSetWidth){ cssOptions['width']=target.css('width'); };

                target.css(cssOptions);

                target.addClass(base.options.baseClassName);

                if (base.options.className) {
                    target.addClass(base.options.className);
                }

                position = 'fixed';
            }
        }

        function setAbsolute() {

            var top = getLimit();
            var left = offsetLeft;

            if (base.options.removeOffsets) {
                left = '';
                top = top - offsetTop;
            }

            var cssOptions={
              'position' : 'absolute',
              'top' : top,
              'left' : left,
              'margin-left' : '0px',
              'bottom' : ''
            };
            if (!base.options.dontSetWidth){ cssOptions['width']=target.css('width'); };

            target.css(cssOptions);

            position = 'absolute';
        }

        // Sets the target element back to unfixed. Also, hides the spacer.
        function setUnfixed() {
            // Only unfix the target element and the spacer if we need to.
            if (!isUnfixed()) {
                lastOffsetLeft = -1;

                // Hide the spacer now that the target element will fill the
                // space.
                spacer.css('display', 'none');

                // Remove the style attributes that were added to the target.
                // This will reverse the target back to the its original style.
                target.css({
                    'z-index' : originalZIndex,
                    'width' : '',
                    'position' : originalPosition,
                    'left' : '',
                    'top' : originalOffsetTop,
                    'margin-left' : ''
                });

                target.removeClass('scroll-to-fixed-fixed');

                if (base.options.className) {
                    target.removeClass(base.options.className);
                }

                position = null;
            }
        }

        // Moves the target element left or right relative to the horizontal
        // scroll position.
        function setLeft(x) {
            // Only if the scroll is not what it was last time we did this.
            if (x != lastOffsetLeft) {
                // Move the target element horizontally relative to its original
                // horizontal position.
                target.css('left', offsetLeft - x);

                // Hold the last horizontal position set.
                lastOffsetLeft = x;
            }
        }

        function getMarginTop() {
            var marginTop = base.options.marginTop;
            if (!marginTop) return 0;

            if (typeof(marginTop) === 'function') {
                return marginTop.apply(target);
            }
            return marginTop;
        }

        // Checks to see if we need to do something based on new scroll position
        // of the page.
        function checkScroll() {
            //if (!$.isScrollToFixed(target) || target.is(':hidden')) return;
            var wasReset = isReset;
            var wasUnfixed = isUnfixed();

            // If resetScroll has not yet been called, call it. This only
            // happens once.
            if (!isReset) {
                resetScroll();
            } else if (isUnfixed()) {
                // if the offset has changed since the last scroll,
                // we need to get it again.

                // Capture the offset top of the target element.
                offsetTop = target.offset().top;

                // Capture the offset left of the target element.
                offsetLeft = target.offset().left;
            }

            // Grab the current horizontal scroll position.
            var x = $window.scrollLeft();

            // Grab the current vertical scroll position.
            var y = $window.scrollTop();

            // Get the limit, if there is one.
            var limit = getLimit();

            // If the vertical scroll position, plus the optional margin, would
            // put the target element at the specified limit, set the target
            // element to absolute.
            if (base.options.minWidth && $window.width() < base.options.minWidth) {
                if (!isUnfixed() || !wasReset) {
                    postPosition();
                    target.trigger('preUnfixed.ScrollToFixed');
                    setUnfixed();
                    target.trigger('unfixed.ScrollToFixed');
                }
            } else if (base.options.maxWidth && $window.width() > base.options.maxWidth) {
                if (!isUnfixed() || !wasReset) {
                    postPosition();
                    target.trigger('preUnfixed.ScrollToFixed');
                    setUnfixed();
                    target.trigger('unfixed.ScrollToFixed');
                }
            } else if (base.options.bottom == -1) {
                // If the vertical scroll position, plus the optional margin, would
                // put the target element at the specified limit, set the target
                // element to absolute.
                if (limit > 0 && y >= limit - getMarginTop()) {
                    if (!wasUnfixed && (!isAbsolute() || !wasReset)) {
                        postPosition();
                        target.trigger('preAbsolute.ScrollToFixed');
                        setAbsolute();
                        target.trigger('unfixed.ScrollToFixed');
                    }
                // If the vertical scroll position, plus the optional margin, would
                // put the target element above the top of the page, set the target
                // element to fixed.
                } else if (y >= offsetTop - getMarginTop()) {
                    if (!isFixed() || !wasReset) {
                        postPosition();
                        target.trigger('preFixed.ScrollToFixed');

                        // Set the target element to fixed.
                        setFixed();

                        // Reset the last offset left because we just went fixed.
                        lastOffsetLeft = -1;

                        target.trigger('fixed.ScrollToFixed');
                    }
                    // If the page has been scrolled horizontally as well, move the
                    // target element accordingly.
                    setLeft(x);
                } else {
                    // Set the target element to unfixed, placing it where it was
                    // before.
                    if (!isUnfixed() || !wasReset) {
                        postPosition();
                        target.trigger('preUnfixed.ScrollToFixed');
                        setUnfixed();
                        target.trigger('unfixed.ScrollToFixed');
                    }
                }
            } else {
                if (limit > 0) {
                    if (y + $window.height() - target.outerHeight(true) >= limit - (getMarginTop() || -getBottom())) {
                        if (isFixed()) {
                            postPosition();
                            target.trigger('preUnfixed.ScrollToFixed');

                            if (originalPosition === 'absolute') {
                                setAbsolute();
                            } else {
                                setUnfixed();
                            }

                            target.trigger('unfixed.ScrollToFixed');
                        }
                    } else {
                        if (!isFixed()) {
                            postPosition();
                            target.trigger('preFixed.ScrollToFixed');
                            setFixed();
                        }
                        setLeft(x);
                        target.trigger('fixed.ScrollToFixed');
                    }
                } else {
                    setLeft(x);
                }
            }
        }

        function getBottom() {
            if (!base.options.bottom) return 0;
            return base.options.bottom;
        }

        function postPosition() {
            var position = target.css('position');

            if (position == 'absolute') {
                target.trigger('postAbsolute.ScrollToFixed');
            } else if (position == 'fixed') {
                target.trigger('postFixed.ScrollToFixed');
            } else {
                target.trigger('postUnfixed.ScrollToFixed');
            }
        }

        var windowResize = function(event) {
            // Check if the element is visible before updating it's position, which
            // improves behavior with responsive designs where this element is hidden.
            if(target.is(':visible')) {
                isReset = false;
                checkScroll();
            } else {
              // Ensure the spacer is hidden
              setUnfixed();
            }
        }

        var windowScroll = function(event) {
            (!!window.requestAnimationFrame) ? requestAnimationFrame(checkScroll) : checkScroll();
        }

        // From: http://kangax.github.com/cft/#IS_POSITION_FIXED_SUPPORTED
        var isPositionFixedSupported = function() {
            var container = document.body;

            if (document.createElement && container && container.appendChild && container.removeChild) {
                var el = document.createElement('div');

                if (!el.getBoundingClientRect) return null;

                el.innerHTML = 'x';
                el.style.cssText = 'position:fixed;top:100px;';
                container.appendChild(el);

                var originalHeight = container.style.height,
                originalScrollTop = container.scrollTop;

                container.style.height = '3000px';
                container.scrollTop = 500;

                var elementTop = el.getBoundingClientRect().top;
                container.style.height = originalHeight;

                var isSupported = (elementTop === 100);
                container.removeChild(el);
                container.scrollTop = originalScrollTop;

                return isSupported;
            }

            return null;
        }

        var preventDefault = function(e) {
            e = e || window.event;
            if (e.preventDefault) {
                e.preventDefault();
            }
            e.returnValue = false;
        }

        // Initializes this plugin. Captures the options passed in, turns this
        // off for devices that do not support fixed position, adds the spacer,
        // and binds to the window scroll and resize events.
        base.init = function() {
            if (!!$.isScrollToFixed(target)) {
                return;
            }

            // Add a reverse reference to the DOM object.
            base.$el.data('ScrollToFixed', base);

            // Capture the options for this plugin.
            base.options = $.extend({}, $.ScrollToFixed.defaultOptions, options);

            originalZIndex = target.css('z-index')

            // Turn off this functionality for devices that do not support it.
            // if (!(base.options && base.options.dontCheckForPositionFixedSupport)) {
            //     var fixedSupported = isPositionFixedSupported();
            //     if (!fixedSupported) return;
            // }

            // Put the target element on top of everything that could be below
            // it. This reduces flicker when the target element is transitioning
            // to fixed.
            base.$el.css('z-index', base.options.zIndex);

            // Create a spacer element to fill the void left by the target
            // element when it goes fixed.
            spacer = $('<div />');

            position = target.css('position');
            originalPosition = target.css('position');
            originalFloat = target.css('float');
            originalOffsetTop = target.css('top');

            // Place the spacer right after the target element.
            if (isUnfixed()) base.$el.after(spacer);

            // Reset the target element offsets when the window is resized, then
            // check to see if we need to fix or unfix the target element.
            $window.bind('resize.ScrollToFixed', windowResize);

            // When the window scrolls, check to see if we need to fix or unfix
            // the target element.
            $window.bind('scroll.ScrollToFixed', windowScroll);

            // For touch devices, call checkScroll directlly rather than
            // rAF wrapped windowScroll to animate the element
            if ('ontouchmove' in window) {
              $window.bind('touchmove.ScrollToFixed', checkScroll);
            }

            if (base.options.preFixed) {
                target.bind('preFixed.ScrollToFixed', base.options.preFixed);
            }
            if (base.options.postFixed) {
                target.bind('postFixed.ScrollToFixed', base.options.postFixed);
            }
            if (base.options.preUnfixed) {
                target.bind('preUnfixed.ScrollToFixed', base.options.preUnfixed);
            }
            if (base.options.postUnfixed) {
                target.bind('postUnfixed.ScrollToFixed', base.options.postUnfixed);
            }
            if (base.options.preAbsolute) {
                target.bind('preAbsolute.ScrollToFixed', base.options.preAbsolute);
            }
            if (base.options.postAbsolute) {
                target.bind('postAbsolute.ScrollToFixed', base.options.postAbsolute);
            }
            if (base.options.fixed) {
                target.bind('fixed.ScrollToFixed', base.options.fixed);
            }
            if (base.options.unfixed) {
                target.bind('unfixed.ScrollToFixed', base.options.unfixed);
            }

            if (base.options.spacerClass) {
                spacer.addClass(base.options.spacerClass);
            }

            target.bind('resize.ScrollToFixed', function() {
                spacer.height(target.height());
            });

            target.bind('scroll.ScrollToFixed', function() {
                target.trigger('preUnfixed.ScrollToFixed');
                setUnfixed();
                target.trigger('unfixed.ScrollToFixed');
                checkScroll();
            });

            target.bind('detach.ScrollToFixed', function(ev) {
                preventDefault(ev);

                target.trigger('preUnfixed.ScrollToFixed');
                setUnfixed();
                target.trigger('unfixed.ScrollToFixed');

                $window.unbind('resize.ScrollToFixed', windowResize);
                $window.unbind('scroll.ScrollToFixed', windowScroll);

                target.unbind('.ScrollToFixed');

                //remove spacer from dom
                spacer.remove();

                base.$el.removeData('ScrollToFixed');
            });

            // Reset everything.
            windowResize();
        };

        // Initialize the plugin.
        base.init();
    };

    // Sets the option defaults.
    $.ScrollToFixed.defaultOptions = {
        marginTop : 0,
        limit : 0,
        bottom : -1,
        zIndex : 1000,
        baseClassName: 'scroll-to-fixed-fixed'
    };

    // Returns enhanced elements that will fix to the top of the page when the
    // page is scrolled.
    $.fn.scrollToFixed = function(options) {
        return this.each(function() {
            (new $.ScrollToFixed(this, options));
        });
    };
})(jQuery);

;/**
 * Find all the sticky containers on the page and instantiate the plugin
 */
(function ($, window, document, undefined) {
    'use strict';

    /**
     * Check if each `sticky-container` element should actually be sticky
     */
    var checkStickyContainer = function () {
        var $this = $(this);
        var $data = $this.data();
        if ($.isEmptyObject($data)) {
            return;
        }

        var limitSelector = $data.stickyLimit;
        var limitOffset = $data.stickyOffset || 0;
        var marginTop = $data.stickyMargin || 0;
        var noStickBreakpoint = $data.noStickBreakpoint || false;

        if (noStickBreakpoint && Modernizr.mq(noStickBreakpoint)) {
            $this.trigger('detach.ScrollToFixed');
            return;
        }

        $this.scrollToFixed({
            marginTop: marginTop,
            limit: function () {
                if (!limitSelector) {
                    return limitOffset;
                }
                return ($(limitSelector).offset().top - $this.height() - limitOffset)
            }
        });
    }

    /**
     * Handle checking for sticky elements
     */
    var handleStickyContainer = function () {
        var $stickyContainer = $('.sticky-container');
        if (!$stickyContainer.length) {
            return;
        }

        $stickyContainer.each(checkStickyContainer);
    };

    handleStickyContainer();
    $(window).on('resize', _.debounce(handleStickyContainer, 250));
} (jQuery, this, this.document));

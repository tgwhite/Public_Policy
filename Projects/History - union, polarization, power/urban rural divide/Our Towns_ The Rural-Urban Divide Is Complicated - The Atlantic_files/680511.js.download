"use strict";!function(){var f,p,u,y,w,a,c,r={},l=function(){function e(e,t,r,o,i){if(p=e,a=o,w=r,f=t,u=i)y=u.storage;else if("ls"===e.storage)try{y=new(brandmetrics.getModule(32))(p,f,!1)}catch(e){y=void 0}}return e.prototype.isReady=function(){return c&&c.isInitiated},e.prototype.hasConsent=function(){return!0},e.prototype.addEventListener=function(e){"ready"===e.event&&this.isReady()?e.handler({api:this}):f.on(e)},e.prototype.triggerSurvey=function(o){var e,d,u=this,c=!1;void 0!==(null===(e=o)||void 0===e?void 0:e.timeout)&&0<o.timeout&&(d=setTimeout(function(){l(!(c=!0)),f.emit("surveyloaded",{available:!1,showed:!1})},o.timeout));var l=function(e,t,r){o&&o.callback&&o.callback(e,t,r)},v={mid:(o=o||{}).mid,bid:o.bid,callback:o.callback,autoRender:void 0===o.autoRender||o.autoRender,force:void 0!==o.force&&o.force,isTest:void 0!==o.isTest&&o.isTest,dtName:o.dtName},t=[];if("none"!==p.storage&&y){var r=y.state(),i=0,a=0;for(var n in r)if(r.hasOwnProperty(n)){var s=r[n];!1===s.isAnswered&&s.nbrOfSurveys<p.survey.max&&Date.now()-s.lastSurvey>1e3*p.survey.interval*60&&(i=Math.max(i,s.lastSurvey),Date.now()-s.lastSurvey<6048e5&&(a+=s.nbrOfSurveys),t.push(s))}if(a>=p.survey.maxTot||Date.now()-i<1e3*p.survey.intervalTot*60)return clearInterval(d),l(!1),void f.emit("surveyloaded",{available:!1,showed:!1})}var m=Math.random()<=p.surveyRandomization;v.callback||v.mid||v.isTest||v.force||m?function(e,t){var r=document.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=t||null;var o=document.getElementsByTagName("script")[0];if(null==o||null==o.parentNode)throw new Error("can't find script tag");o.parentNode.insertBefore(r,o)}(w.GetConfigUrl(v.mid||null,v.isTest||!1,v.force,v.dtName,t),function(){if(!c){clearTimeout(d);var e=brandmetrics.getModule(-1),t=!1,r=!1,o=!1;if(void 0!==e)for(var i=0,a=e.surveys;i<a.length;i++){var n=a[i];o=!0;var s=u.createSurvey(n);l(!0,n,s),t=!0,v.autoRender&&(s.show(),r=!0)}t||l(!1),f.emit("surveyloaded",{available:o,showed:r})}}):m||(clearTimeout(d),f.emit("surveyloaded",{available:!1,showed:!1}),f.emit("surveyloadskipped",v))},e.prototype.createSurvey=function(e){if(void 0===e||void 0===e.measurementId||void 0===e.displayOption)throw new Error("");if(a){var t=a(w,e,f,y||(u?u.storage:void 0));return r[e.measurementId]=t}throw new Error("brandmetrics: This configuration does not support creating surveys.")},e.prototype.addMetadata=function(e){if(void 0===e||void 0===e.name||void 0===e.value||"string"!=typeof e.value)throw new Error("Invalid Argument");w.upsertParam(e.name,e.value)},e.prototype.setDoNotTrack=function(){var e=localStorage;e&&(e.setItem("__bmdnt","true"),e.removeItem("__bm_m"),e.removeItem("__bm_s")),w.postOptout()},e.prototype.triggerExposure=function(e){var t=0<p.listeners.filter(function(e){return"api"===e.type}).length;if(void 0===u||!t)throw new Error("brandmetrics: triggerExposure only works when an API- listener is configured.");u.triggerApiExposure(e)},e.prototype.collectAds=function(e){},e.prototype.getState=function(){return y?y.state():void 0},e.prototype.reinitialize=function(){void 0!==u&&u.reinitialize()},e}();window.brandmetrics.register({id:1,ctor:function(e,t,r,o,i,a,n){var s=new l(e,t,r,o,i),d={bm:s,collection:u,options:e,utils:t,client:r,callback:function(){n(s),f.emit("ready",{api:s})}};switch(a){case 0:c=new(brandmetrics.getModule(131072))(d);break;case 1:c=new(brandmetrics.getModule(262144))(d);break;default:throw new Error("Failed to start brandmetrics, the mode: "+a+" is not defined.")}c.start()}})}();"use strict";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};!function(){var o,m,g,h,y,a,i=!1,w=[],E=[],b={},S=function(t,s,o){t.forEach(function(t){var e;switch(t.status){case 1:k(t);var n=Math.floor((t.last-t.start)/1e3),i=s.storage.updateExp(t.mid,t.uid,0,n);h.postEvent(11,t.mid,i,{pid:t.uid,ts:(n+1).toString()})}var r=w.indexOf(t);o?(null===(e=g)||void 0===e||e.unObserve(t.element),w.splice(r,1)):w[r]={status:3,uid:t.uid,mid:t.mid,element:t.element}}),c(s.storage)},u=function(t,e){var n=w.indexOf(t),i=e.storage.updateExp(t.mid,t.uid,1,1);h.postEvent(10,t.mid,i,{pid:t.uid}),w[n]=__assign(__assign({},t),{status:1,start:Date.now()-1e3,last:Date.now()})},k=function(t){var e=Date.now(),n=y.getIdleTimeout();if(e-t.last>n+1){var i=t.last-t.start;t.start=e-i-n}t.last=e},l=function(r,s){for(var t=function(t){var e,n,i=(e=t.element,0<(n=s.filter(function(t){return t.element===e})).length&&n[0]);switch(t.status){case 1:i&&1!==i.state?S([t],r,!1):k(t);break;case 0:case 3:i&&1===i.state&&u(t,r)}},e=0,n=w;e<n.length;e++){t(n[e])}c(r.storage)},c=function(t){var e=w.map(function(t){return 1===t.status?{mid:t.mid,uid:t.uid,start:t.start,last:t.last}:null});t.setSession(e.filter(function(t){return null!==t}))},s=function(u,l,c){var t,d=!1,f=null;if(l.element instanceof HTMLElement)f=l.element;else{var e=document.querySelectorAll(y.escapeSelector("#"+l.element));f=0<e.length?e[e.length-1]:null}for(var p=null!==f?w.filter(function(t){return t.element===f}):[],v=[],n=function(a){for(var t=function(t){var e=!0;for(var n in t)if(t.hasOwnProperty(n)){if("ntv"===t.source&&"urlPattern"===n||"meta"===n)continue;l.key[n]!=t[n]&&(e=!1)}if(e){var i=function(e,t){var n;if(void 0===t)switch(e.source){case"apn":n=["creativeId"];break;case"gpt":n=["creativeId","lineItemId"];break;case"pbj":n=["dealId"];break;case"ntv":case"api":case"slot":n=["key"];break;default:throw Error("Constructing id's from source: "+e.source+" is not implemented.")}else n=t;return n.map(function(t){return e[t]}).join(":")}(l.key,a.uks);if(t.meta&&!0===t.meta.collect&&l.ad&&E.indexOf(i)<0&&E.push(i),c&&!0===b[i]?h.postEvent(13,a.id,void 0,{pid:i}):h.postEvent(12,a.id,void 0,{pid:i}),b[i]=!0,void 0===g||null===f){var r=u.storage.updateExp(a.id,i,1,1);h.postEvent(10,a.id,r,{pid:i})}else{d=!0;var s=w.filter(function(t){return 1===t.status&&t.mid===a.id&&(f===t.element||t.element.id&&f.querySelector(y.escapeSelector("#"+t.element.id))||f.id&&t.element.querySelector(y.escapeSelector("#"+f.id)))})[0];if(s)k(s);else{if(0<p.length){var o=p.filter(function(t){return t.uid!==i});S(o,u,!0)}w.push({status:0,mid:a.id,uid:i,element:f}),v.push(f)}}}},e=0,n=a.keys;e<n.length;e++){t(n[e])}},i=0,r=m.measurements;i<r.length;i++){n(r[i])}for(var s=0,o=v;s<o.length;s++){var a=o[s];null===(t=g)||void 0===t||t.observe(a)}!d&&0<p.length&&S(p,u,!0)},d=function(t,e,n){n=n?2*n:100,t.isReady()?e():setTimeout(function(){return d(t,e,n)},n)},f=function(t){a.clean(m.measurements);for(var e=0,n=t;e<n.length;e++){var i=n[e],r=Math.floor((i.last-i.start)/1e3),s=a.updateExp(i.mid,i.uid,0,r);h.postEvent(11,i.mid,s,{pid:i.uid,ts:r.toString()})}a.setSession([])},n=function(t){o.forEach(function(t){return t.setActive(!1)}),S(w.filter(function(){return!0}),t,!0),f(a.getSession())},r=function(e,n){o.filter(function(t){return t.isReady()}).map(function(t){return t.getDisplayedSlots()}).forEach(function(t){t.forEach(function(t){return s(e,t,n)})}),o.forEach(function(t){return t.setActive(!0)})},p=function(t,e){if(i)switch(t){case 0:r(e,!0);break;case 1:n(e)}},v=function(t){var e,n=brandmetrics.getModule(32768),i=brandmetrics.getModule(67108864),r=brandmetrics.getModule(16384),s=brandmetrics.getModule(8192);return(window.omid3p||window.oo)&&i?e=new i(t):window.mraid&&n?e=new n(t):window.IntersectionObserver&&r?e=new r(t):s&&(e=new s(t)),e},t=function(){function t(t,e,n,i,r){var s=this;this.storage=r,a=r,m=t,h=e,o=i,g=v({collection:this,callback:l,utils:y=n}),y.on({event:"pagestatus",handler:function(t){p(t,s)}})}return t.prototype.isInitiated=function(){return null!=o&&null!=this.storage},t.prototype.reinitialize=function(){var e=this;n(this),r(this,!1),o.forEach(function(t){t.slotDisplayed(function(t){return s(e,t,!1)})})},t.prototype.start=function(){var r=this;f(a.getSession()),f(a.getAndRemoveOutdatedSessions());for(var t=function(i){d(i,function(){for(var t=0,e=i.getDisplayedSlots();t<e.length;t++){var n=e[t];s(r,n,!1)}i.slotDisplayed(function(t){return s(r,t,!1)})})},e=0,n=o;e<n.length;e++){t(n[e])}i=!0},t.prototype.getState=function(){return this.storage.state()},t.prototype.triggerApiExposure=function(t){s(this,{key:{source:"api",key:t.key},element:t.element},!1)},t}();window.brandmetrics.register({id:2,ctor:t})}();"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,c=i.length;a<c;a++,o++)n[o]=i[a];return n};!function(){var r=/^#([0-9])/,n=[],a=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];n.forEach(function(e){e.event===t&&e.handler.apply(e,r)})},i=function(e){return!0===e?1:2};!function(){var e,t=!0,r=function(e,t,r){e.addEventListener&&e.addEventListener(t,r)},n=function(){t||(a("pagestatus",0),t=!0),clearTimeout(e),e=setTimeout(o,3e4)},o=function(){t&&(a("pagestatus",1),t=!1)},i=window;r(i,"load",n),r(i,"touchstart",n),r(i,"keypress",n),r(i,"scroll",n),r(i,"pagehide",o),r(i,"beforeunload",o),r(document,"visibilitychange",function(){document.hidden?o():n()}),i.IntersectionObserver&&new IntersectionObserver(function(){n()},{threshold:.1}).observe(document.documentElement);n()}();var c=function(e){return Math.abs((e[2]-e[0])*(e[1]-e[3]))},d=new Array,s=function(e,t,r){if(0<d.length&&(null===e||e.isReady())){var n=d.shift();try{u(e,n,r)}catch(e){var o="Error in command: "+n.cmd+", msg: "+e;throw t.postDiagnostics(o),new Error(o)}s(e,t,r)}},u=function(e,t,r){var n,o,i,a,c,d,s;if(null!==e&&!e.isReady())throw new Error("Try to execute commands before initiated");switch(t.cmd=void 0===t.cmd?"":t.cmd.toLowerCase(),t.cmd){case"_loadsurvey":null===(n=e)||void 0===n||n.triggerSurvey(t.val);break;case"_forcesurvey":null===(o=e)||void 0===o||o.triggerSurvey({mid:t.val.mid,force:!0,dtName:t.val.style});break;case"_querysurvey":if(void 0===t.val||void 0===t.val.callback)throw new Error("No callback defined");null===(i=e)||void 0===i||i.triggerSurvey({autoRender:!1,callback:t.val.callback});break;case"_addmetadata":var u=t.val;void 0===u.value&&void 0!==u.val&&(u.value=u.val),null===(a=e)||void 0===a||a.addMetadata(u);break;case"_setdonottrack":null===(c=e)||void 0===c||c.setDoNotTrack();break;case"_triggerexposure":if(void 0===t.val)throw new Error("The command _triggerexposure needs a value.");null===(d=e)||void 0===d||d.triggerExposure(t.val);break;case"_addeventlistener":null!==e?e.addEventListener(t.val):r.on(t.val);break;case"_reinitialize":null===(s=e)||void 0===s||s.reinitialize();break;default:throw new Error("unknown cmd")}},e=function(){function e(){this.guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},this.escapeSelector=function(e){var t=r.exec(e);return t&&(e=e.replace(t[0],"#\\3"+t[1]+" ")),e}}return e.prototype.getPageRect=function(){var e=document.documentElement.scrollLeft||document.body.scrollLeft||window.pageXOffset,t=document.documentElement.scrollTop||document.body.scrollTop||window.pageYOffset;return[e,t,e+("innerWidth"in window?window.innerWidth:document.body.clientWidth),t+("innerHeight"in window?window.innerHeight:document.body.clientHeight)]},e.prototype.getElementRect=function(e){for(var t=0,r=0,n=e.offsetWidth,o=e.offsetHeight;null!==e.offsetParent;)t+=e.offsetLeft,r+=e.offsetTop,e=e.offsetParent;return[t,r,t+n,r+o]},e.prototype.rectsIntersect=function(e,t){return e[0]<t[2]&&e[2]>t[0]&&e[1]<t[3]&&e[3]>t[1]},e.prototype.rectsRatio=function(e,t){var r=0;if(this.rectsIntersect(e,t)){var n=Math.max(e[0],t[0]),o=Math.min(e[2],t[2]),i=Math.max(e[1],t[1]),a=Math.min(e[3],t[3]);r=c([n,i,o,a])/c(t)}return r},e.prototype.inView=function(e){var t=this.getPageRect(),r=this.getElementRect(e),n=this.inViewByRatio(this.rectsRatio(t,r)),o=this.inViewByRatio(this.rectsRatio(r,t));return i(1===n||1===o)},e.prototype.inViewByRatio=function(e){return i(.5<=e)},e.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];a.apply(void 0,__spreadArrays([e],t))},e.prototype.on=function(e){n.push(e)},e.prototype.un=function(e){for(var t=n.length-1;0<=t;t--){var r=n[t];r.event===e.event&&r.handler===e.handler&&n.splice(t,1)}},e.prototype.getIdleTimeout=function(){return 3e4},e.prototype.initProcessing=function(r,n){var o=this;window.brandmetrics.cmd=window.brandmetrics.cmd||window._brandmetrics||[],window._brandmetrics||(window._brandmetrics=window.brandmetrics.cmd),window.brandmetrics.cmd.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return d.push.apply(d,e),s(r,n,o),Array.prototype.push.apply(this,e)},d.push.apply(d,window.brandmetrics.cmd)},e.prototype.process=function(e,t){s(e,t,this)},e}();window.brandmetrics.register({id:4,ctor:e})}();"use strict";var __extends=this&&this.__extends||function(){var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};return function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(){var c,u,s,p=function(t,e){var n=[];for(var r in e=e||{},s)if(s.hasOwnProperty(r)&&(0===t.length||0<=t.indexOf(r))||e.hasOwnProperty(r)){var o=s[r],i=e[r]||o.value||(void 0!==o.func?o.func():void 0);null!=i&&""!==i&&n.push(r+"="+d(i))}return n.join("&")},d=function(t){return"function"==typeof encodeURIComponent?encodeURIComponent(t):window.escape(t)},e=function(){var t=document.location.ancestorOrigins&&0<document.location.ancestorOrigins.length?document.location.ancestorOrigins:[window.document.location.href],e=t[t.length-1],n=document.createElement("a");return n.href=e,n.host||""},f=function(t,e){(new Image).src=c.baseUrl+"/"+t+"?"+e},t=function(){function t(t){u={},s={siteid:{value:(c=t).siteId},toploc:{func:function(){return e()}},test:{value:c.isTest?"true":void 0},qdata:{},mid:{},pid:{},meta:{},state:{},ms:{},forced:{},msg:{},eid:{},ts:{},rt:{},rnd:{func:function(){return Math.floor(9999001*Math.random()+1e3).toString()}},adkey:{},dtname:{},slang:{value:c.language},sname:{},sit:{}}}return t.prototype.GetBaseUrl=function(){return c.baseUrl},t.prototype.GetConfigUrl=function(t,e,n,r,o){void 0===e&&(e=!1),void 0===n&&(n=!1);var i="";if(0<o.length)for(var s=0,a=o;s<a.length;s++){var u=a[s];i=i+(u.uid+";"+u.mid+";"+u.pixels.map(function(t){return t.uid+","+t.exp}).join(";"))+"|"}var d=p([],{test:e?"true":void 0,forced:n?"true":void 0,dtname:r,mid:null===t?void 0:t,ms:i});return c.baseUrl+"/c.js?"+d},t.prototype.GetTemplateUrl=function(t,e){var n={mid:t};e&&(n.dtname=e);var r=p(["siteid","toploc","test","slang"],n);return(c.cdnUrl?c.cdnUrl:c.baseUrl)+"/s.html?"+r},t.prototype.upsertParam=function(t,e){u[t]=e},t.prototype.postAd=function(t,e,n,r){var o=p([],{mid:t,adkey:e}),i=new XMLHttpRequest;i.open("POST",c.baseUrl+"/ac?"+o,!0),i.setRequestHeader("Content-Type","application/json"),i.send(JSON.stringify({content:n,key:r}))},t.prototype.postAnswer=function(t,e,n,r,o,i){var s="";void 0!==o&&(s=o.uid+";"+o.nbrOfSurveys+";"+o.pixels.map(function(t){return t.uid+","+t.exp+","+t.time}).join(";"));var a=p([],{test:"true"===(i=i||{}).test?"true":void 0,pid:i.pid,forced:"true"===i.forced?"true":void 0,dtname:i.dtname,mid:t,qdata:e,state:s,meta:function(){var t=[];for(var e in u)if(u.hasOwnProperty(e)){var n=u[e];null!=n&&""!==n&&t.push(e+"="+d(n))}return t.join("&")}(),sname:""!==n?n:void 0,sit:r});f("a",a)},t.prototype.postDiagnostics=function(t){if(c.logErrors){var e=p(["rnd"],{msg:t});f("diagnostics",e)}},t.prototype.postOptout=function(){if(void 0!==c.siteId){var t=p(["siteid"]);f("optout",t)}},t.prototype.postEvent=function(t,e,n,r){var o=function(t,e,n,r){r=r||{};var o="";if(void 0!==n){for(var i=0,s=0,a=n.pixels;s<a.length;s++)i+=a[s].exp;o=""+i}return p([],{test:"true"===r.test?"true":void 0,forced:"true"===r.forced?"true":void 0,dtname:r.dtname,pid:r.pid,eid:t.toString(),ts:r.ts,state:o,mid:e})}(t,e,n,r);f("i",o)},t.prototype.GetRedirectUrl=function(t){var e=p([],{siteid:c.siteId,rt:t});return c.baseUrl+"/r?"+e},t}(),n=function(n){function t(t){var e=n.call(this,t)||this;return e._messageClient=new(brandmetrics.getModule(8388608)),e}return __extends(t,n),t.prototype.postEvent=function(t,e,n,r){var o={type:2,event:1,eventType:t,state:n,mid:e,props:r};this._messageClient.send(o)},t}(t);window.brandmetrics.register({id:1048576,ctor:n}),window.brandmetrics.register({id:8,ctor:t})}();"use strict";!function(){var c,u,p,l,i,y,t="created",f=!1,m=!1,v=[],r=window.IntersectionObserver?new IntersectionObserver(function(e){.5<=e[0].intersectionRatio&&void 0===i?i=setTimeout(function(){if(!f){var e=l?l.updateSrv(c.measurementId,!1):void 0;u.postEvent(2,c.measurementId,e,c.props),f=!0}i=setTimeout(function(){if(!m){var e=l?l.state()[c.measurementId]:void 0;u.postEvent(5,c.measurementId,e,c.props),m=!0}},4e3)},1e3):void 0!==i&&(clearTimeout(i),i=void 0)},{threshold:[0,.5]}):void 0,o={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"},s=function(e){try{if(void 0!==e.data.req&&"get"===e.data.req){var t=e.data.dtname;"inject"===c.displayOption.type&&(t=c.displayOption.displayTypeName),!t&&c.props&&c.props.dtname&&(t=c.props.dtname);var n={key:e.data.key,iframeCss:c.displayOption.iframeCss,url:u.GetTemplateUrl(c.measurementId,t),mid:c.measurementId};return v.push(e.data.key),void e.source.postMessage(n,"*")}var i=e.data.message||e.data;if(!(e.data.origin===u.GetBaseUrl()||"null"===e.origin||e.data.key&&-1!==v.indexOf(e.data.key)))return void("string"==typeof e.data&&-1<e.data.indexOf(c.measurementId)&&u.postDiagnostics("Message origin not expected "+e.origin));var r=function(e){if("string"!=typeof e||-1===e.indexOf(c.measurementId))return null;var t=e.split("|"),n=t[1];switch(n){case"closed":return{mid:t[0],type:n};case"completed":var i,r="true",o="";return 2<t.length&&-1<(i=t[2]).indexOf("closeSurvey")&&(r=i.substring(i.lastIndexOf("=")+1)),3<t.length&&-1<(i=t[3]).indexOf("closeSurveyTimeout")&&(o=i.substring(i.lastIndexOf("=")+1)),{mid:t[0],type:n,closeSurvey:r,closeSurveyTimeout:o};case"rendered":var s=t[2],a=s.substring(s.lastIndexOf("=")+1),d="";if(3<t.length){var u=t[3];d=u.substring(u.lastIndexOf("=")+1)}return{mid:t[0],type:n,size:a,surveyType:d};case"resize":return{mid:t[0],type:n,size:e.substring(e.lastIndexOf("=")+1)};case"answer":var p=b(t,"surveyName");return{mid:t[0],type:n,answer:t[2],surveyName:p};case"redirect":return{target:t[2],type:n};case"updateStyle":return{mid:t[0],type:n,style:e.substring(e.lastIndexOf("=")+1)};case"requestClientSize":return{mid:t[0],type:n};case"surveyinview":return{mid:t[0],type:n,time:parseInt(t[2],10)};default:return null}}(i);if(null===r)return;var o=void 0===l?void 0:l.state()[c.measurementId];switch(r.type){case"rendered":u.postEvent(1,r.mid,o,c.props),!r.surveyType||"2"!==r.surveyType&&"3"!==r.surveyType?g(y.element()):w(y.element()),y.resize(r.size),p.emit("surveyrendered",{});break;case"resize":y.resize(r.size);break;case"answer":var s=m?5:f?1:0,a=l?l.updateSrv(c.measurementId,!0):void 0;u.postAnswer(r.mid,r.answer,r.surveyName,s,a,c.props),p.emit("surveyanswered",{});break;case"completed":if(u.postEvent(3,r.mid,o,c.props),"true"===r.closeSurvey){var d=Number(r.closeSurveyTimeout);!isNaN(d)&&0<d?setTimeout(function(){y.close()},d):y.close()}break;case"closed":u.postEvent(4,r.mid,o,c.props),y.close(),p.emit("surveyclosed",{});break;case"redirect":window.location.href=u.GetRedirectUrl(r.target);break;case"updateStyle":y.updateStyle(r.style);break;case"requestClientSize":y.requestClientSize(r.mid);break;case"surveyinview":1===r.time?(o=l?l.updateSrv(c.measurementId,!1):void 0,u.postEvent(2,r.mid,o,c.props),f=!0):1<r.time&&(u.postEvent(5,r.mid,o,c.props),m=!0)}}catch(e){u.postDiagnostics("Error in handleMessage, "+e)}},g=function(e){r&&e&&!m&&r.observe(e)},w=function(t){if(void 0!==t){var e="";for(var n in o)""!==t.style.getPropertyValue(n)&&(e=o[n]);""!==e&&t.addEventListener(e,function(){var e;t.clientWidth<150||t.clientHeight<150?(e=t,r&&e&&(clearTimeout(i),i=void 0,r.unobserve(e))):g(t)},!1)}},n=function(){var e,t=c,n=document.createElement("iframe");return"inject"===t.displayOption.type&&t.displayOption.sandboxProps?n.sandbox.value=t.displayOption.sandboxProps+" allow-scripts":n.sandbox.value="allow-scripts",n.setAttribute("data-bmsurvey",""),n.height="0","inject"===c.displayOption.type&&(e=c.displayOption.displayTypeName),n.style.cssText=c.displayOption.iframeCss,n.src=u.GetTemplateUrl(t.measurementId,e),n.scrolling="no",n},a=function(e,t,n){if(void 0!==window.apntag&&window.apntag.loaded){var i=window.apntag,r={};n?(r[e]=t,i.setKeywords(n,r)):i.anq.push(function(){(r=i.requests?i.requests.keywords:{})[e]=t,i.setPageOpts({keywords:r})})}else setTimeout(function(){a(e,t,n)},200)},d=function(t,e){if(void 0!==window.googletag&&window.googletag.apiReady){var n=window.googletag;if(t){var i=n.pubads().getSlots().filter(function(e){return e.getSlotElementId()===t})[0];i&&i.setTargeting(e,"yes")}else n.pubads().setTargeting(e,"yes"),n&&n.pubads&&n.pubads().getTargetingKeys}else setTimeout(function(){d(t,e)},200)},h=function(e,t){void 0!==window.adhese?window.adhese.registerRequestParameters(e,t):setTimeout(function(){h(e,t)},200)},b=function(e,t){if(e){for(var n=-1,i=0;i<e.length;i++){if(e[i].substring(0,t.length)===t){n=i;break}}if(0<=n){var r=e[n];return r.substring(r.lastIndexOf("=")+1)}}return""},T=function(){function e(e){this._dc=e}return e.prototype.state=function(){return t},e.prototype.resize=function(){},e.prototype.element=function(){},e.prototype.close=function(){t="closed"},e.prototype.updateStyle=function(){},e.prototype.requestClientSize=function(e){},e.prototype.show=function(){var e=this._dc.targetKey||"brandmetrics-survey",t=this._dc.adSlot;d(t,e)},e}(),S=function(){function e(e){this._dc=e}return e.prototype.state=function(){return t},e.prototype.resize=function(){},e.prototype.element=function(){},e.prototype.close=function(){t="closed"},e.prototype.updateStyle=function(){},e.prototype.requestClientSize=function(e){},e.prototype.show=function(){var e=this._dc.targetKeyword||"kw",t=this._dc.targetValue||"brandmetrics-survey",n=this._dc.adSlot;a(e,t,n)},e}(),O=function(){function e(e){this._dc=e}return e.prototype.state=function(){return t},e.prototype.resize=function(){},e.prototype.element=function(){},e.prototype.close=function(){t="closed"},e.prototype.updateStyle=function(){},e.prototype.requestClientSize=function(e){},e.prototype.show=function(){this._dc.targetKeyword&&this._dc.targetValue&&h(this._dc.targetKeyword,this._dc.targetValue)},e}(),_=function(){function e(e){this._dc=e,this._iframe=n()}return e.prototype.state=function(){return t},e.prototype.resize=function(e){var t=null,n=null;if(0<e.indexOf(",")){var i=e.split(",");t=i[0],n=i[1]}else t=e;this._iframe.height=t+"px",n&&(this._iframe.width=n+"px")},e.prototype.element=function(){return this._iframe},e.prototype.close=function(){t="closed",this._iframe.style.display="none"},e.prototype.updateStyle=function(e){for(var t=0,n=e.split(";");t<n.length;t++){var i=n[t];if(""!==i.trim()){var r=i.split(":");this._iframe.style.setProperty(r[0].trim(),r[1].trim())}}},e.prototype.requestClientSize=function(e){var t;this._iframe.contentWindow&&this._iframe.contentWindow.postMessage(e+"|clientsize|"+(t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)+","+t),"*")},e.prototype.show=function(){if("block"!==this._iframe.style.display){var e=function(e){var t=e.selector;if(!t)throw new Error("No targetElement configured");var n=(!0===e.onTop?window.top.document:window.document).querySelectorAll(p.escapeSelector(t));if(n.length<=0)throw new Error("can't find target element: "+t);return n[n.length-1]}(this._dc);null==e.querySelector("iframe[data-bmsurvey]")&&(!function(e,t,n){var i=t.offsetWidth;e.style.cssText=n.iframeCss.replace("{{targetwidth}}",i.toString());var r=!1;try{""!=("before"===n.injectType?"beforebegin":"after"===n.injectType?"afterend":"prepend"===n.injectType?"afterbegin":"append"===n.injectType?"beforeend":"")&&(t.insertAdjacentElement("beforebegin",e),r=!0)}catch(e){}!1===r&&t.appendChild(e)}(this._iframe,e,this._dc),this._iframe.style.display="block")}},e}();window.brandmetrics.register({id:16,ctor:function(e,t,n,i){u=e,p=n,l=i,"inject"===(c=t).displayOption.type&&!0===c.displayOption.onTop?window.top.addEventListener("message",s,!1):window.addEventListener("message",s,!1);var r=c.displayOption;return y="dfp"===r.type?new T(r):"apn"===r.type?new S(r):"adh"===r.type?new O(r):"inject"===r.type?new _(r):{state:function(){return"failed"},resize:function(){},element:function(){},show:function(){},close:function(){},updateStyle:function(){},requestClientSize:function(){}}}})}();"use strict";!function(){var s,f,h,i,m="__bm_m",u="__bm_s",v={},o=!1,y=function(e){if(void 0===e&&(e=!1),o||e){var t=h.getItem(m),r={};try{r=null!=t?f.DeserializeMeasurements(t):{}}catch(e){h.removeItem(m)}v=r}return v},t=function(){return o?u+"#"+i:u},a=function(){function e(){this._data={},this.length=0}return e.prototype.calcLength=function(){this.length=Object.keys(this._data).length},e.prototype.getItem=function(e){return this._data.hasOwnProperty(e)?this._data[e]:null},e.prototype.setItem=function(e,t){var r=this._data[e]=String(t);return this.calcLength(),r},e.prototype.removeItem=function(e){var t=delete this._data[e];return this.calcLength(),t},e.prototype.clear=function(){return this._data={},this.calcLength(),this._data},e.prototype.key=function(e){var t=Object.keys(this._data);return t.length<e?t[e]:null},e}(),e=function(){function e(e,t,r){f=new(brandmetrics.getModule(524288)),s=t,o=r;var n="__bm_ls_check";try{localStorage.setItem(n,n),localStorage.removeItem(n),h=localStorage}catch(e){h=new a}v=y(!0),i=Math.floor(1e6*Math.random())}return e.prototype.clean=function(e){var r={},n=y(),i=0,t=function(t){n.hasOwnProperty(t)&&(i++,void 0!==e.filter(function(e){return e.id===t})[0]&&(r[t]=n[t]))};for(var o in n)t(o);(0!==e.length&&i-e.length==1||(i-e.length)/i<=.2)&&(n=r);var a=Date.now();for(var o in n)if(n.hasOwnProperty(o)){for(var s=n[o],u=Math.max(s.created,s.lastSurvey),l=0,c=s.pixels;l<c.length;l++){var p=c[l];u=Math.max(u,p.lastexp)}var d=a-u;d<a&&24192e5<d&&delete n[o]}v=n,h.setItem(m,f.SerializeMeasurements(n))},e.prototype.state=function(){return y()},e.prototype.updateExp=function(e,t,r,n){var i=y(),o=i[e];void 0===o&&(o={mid:e,uid:s.guid(),isAnswered:!1,lastSurvey:0,nbrOfSurveys:0,created:Date.now(),pixels:[]},i[e]=o);var a=o.pixels.filter(function(e){return e.uid===t})[0];return void 0===a&&(a={uid:t,exp:0,lastexp:0,time:0},o.pixels.push(a)),a.exp=a.exp+r,a.time=a.time+n,a.lastexp=Date.now(),h.setItem(m,f.SerializeMeasurements(i)),o},e.prototype.updateSrv=function(e,t){var r=y(),n=r[e];return void 0===n&&(n={mid:e,uid:s.guid(),created:Date.now(),isAnswered:!1,lastSurvey:0,nbrOfSurveys:0,pixels:[]},r[e]=n),!0===t?n.isAnswered=!0:(n.lastSurvey=Date.now(),n.nbrOfSurveys=n.nbrOfSurveys+1),h.setItem(m,f.SerializeMeasurements(r)),n},e.prototype.getTemp=function(){return[]},e.prototype.setTemp=function(e){throw new Error("Method not implemented."+e)},e.prototype.getSession=function(){var e=h.getItem(t());return null!=e?f.DeserializeSessions(e):[]},e.prototype.setSession=function(e){h.setItem(t(),f.SerializeSessions(e))},e.prototype.getAndRemoveOutdatedSessions=function(){var a,s=[];if(o)for(var e=function(e,t){var r=h.key(e);if(0===(null===(a=r)||void 0===a?void 0:a.indexOf(u+"#"))){var n=f.DeserializeSessions(h.getItem(r)),i=(new Date).getTime(),o=!0;n.forEach(function(e){i-e.last<3e5&&(o=!1)}),o&&(s.push.apply(s,n),h.removeItem(r))}},t=0,r=h.length;t<r;t++)e(t);return s},e}();window.brandmetrics.register({id:32,ctor:e})}();"use strict";!function(){var o=function(t){var e=t,n=t.getResponseInformation(),o={source:"gpt",advertiserId:n&&n.advertiserId,campaignId:n&&n.campaignId,creativeId:""+(n&&n.creativeId),lineItemId:""+(n&&n.lineItemId)},i={key:o,element:e.getSlotElementId(),ad:e.getHtml()};return i},t=function(){function t(){this.active=!0}return t.prototype.isReady=function(){var t=!(!window.googletag||!window.googletag.apiReady);return t},t.prototype.getDisplayedSlots=function(){var t=window.googletag.pubads().getSlots().filter(function(t){return t.getResponseInformation()}).map(function(t){return o(t)});return t},t.prototype.slotDisplayed=function(e){var n=this;window.googletag.pubads().addEventListener("slotRenderEnded",function(t){n.active&&e(o(t.slot))})},t.prototype.setActive=function(t){this.active=t},t}();window.brandmetrics.register({id:512,ctor:t})}();"use strict";!function(){var e,i,r,l=[],u=null,o=function(){var t,n=l.filter(function(t){var n=r.inView(t.element);return n!==t.state&&(t.state=n,!0)});t=n,e&&e(i,t)},t=function(){function t(t){i=t.collection,e=t.callback,r=t.utils}return t.prototype.observe=function(t){if(!this.isWatching(t)){var n={element:t,state:r.inView(t)};l.push(n)}null===u&&(u=setInterval(function(){o()},1e3))},t.prototype.unObserve=function(n){0===(l=l.filter(function(t){return t.element!==n})).length&&null!==u&&(clearInterval(u),u=null)},t.prototype.isWatching=function(n){return 0<l.filter(function(t){return t.element===n}).length},t}();window.brandmetrics.register({id:8192,ctor:t})}();"use strict";!function(){var e,n,u,i,r=[],s={},c=function(t){e&&e(n,t)},l=function(t){t.state=0;var e=setTimeout(function(){0===t.state&&(t.state=1,c([t]))},1e3);s[t]=e},o=function(o){var t=r.filter(function(t){var e,n,i=(e=t.element,0<(n=o.filter(function(t){return t.target===e})).length?n[0]:null);if(i){var r=u.inViewByRatio(i.intersectionRatio);if(2===r&&i.isIntersecting&&i.rootBounds&&i.boundingClientRect)i.rootBounds.height*i.rootBounds.width<i.boundingClientRect.height*i.boundingClientRect.width&&(r=u.inView(t.element));if(r!==t.state){if(2===r)return void 0!==s[t]&&(clearTimeout(s[t]),delete s[t]),t.state=r,!0;1===r&&2===t.state&&l(t)}}return!1});c(t)},t=function(){function t(t){n=t.collection,e=t.callback,u=t.utils,i=new IntersectionObserver(o,{threshold:[0,.5]})}return t.prototype.observe=function(t){if(!this.isWatching(t)){var e={element:t,state:u.inView(t)};r.push(e),1===e.state&&l(e),i.observe(t)}},t.prototype.unObserve=function(e){r=r.filter(function(t){return t.element!==e}),i.unobserve(e)},t.prototype.isWatching=function(e){return 0<r.filter(function(t){return t.element===e}).length},t}();window.brandmetrics.register({id:16384,ctor:t})}();"use strict";!function(){var u,d=function(t,e){var i;void 0===e&&(e=!0);var n,s,o,r,c=u.options;if("auto"===c.startMode.type||"sessionSubsequent"===c.startMode.type&&(n=c.startMode,s="__bmsessionviews",o=1,null!==(r=sessionStorage.getItem(s))&&(o=parseInt(r,10)+1),sessionStorage.setItem(s,o.toString()),o>n.conf.count)){var a=!function(t){for(var e=window.location.href,i=0,n=t;i<n.length;i++){var s=n[i],o=new RegExp(s);if(e.match(o))return!0}return!1}((null===(i=c.startMode.conf)||void 0===i?void 0:i.excluded)||[]);if(a&&c.startMode.conf&&c.startMode.conf.requiredElement)document.querySelector(u.utils.escapeSelector(c.startMode.conf.requiredElement))||(a=!1,e&&setTimeout(function(){d(t,!1)},1e3));a&&t.triggerSurvey()}},t=function(){function t(t){this.isInitiated=!1,u=t}return t.prototype.start=function(){var t=this,e=u.bm,i=u.collection,n=u.callback;if(this.isInitiated)n();else if(u.utils.initProcessing(e,u.client),i){i.start();var s=function(){i.isInitiated()?(t.isInitiated=!0,u.utils.process(e,u.client),d(e),n()):setTimeout(function(){return s()},100)};s()}else this.isInitiated=!0,u.utils.process(e,u.client),d(e),n()},t}();window.brandmetrics.register({id:131072,ctor:t})}();"use strict";!function(){var e=function(){function e(){}return e.prototype.SerializeMeasurements=function(e){for(var r="",t=0,n=0,i=Object.keys(e);n<i.length;n++){var s=i[n];r+=0!==t?"¤":"";var a=e[s];r+=s+"|"+a.isAnswered+"|"+a.lastSurvey+"|"+a.nbrOfSurveys+"|"+a.uid+"|"+a.created;for(var o=0,l=a.pixels;o<l.length;o++){var p=l[o];r+=";"+p.exp+"|"+p.lastexp+"|"+p.time+"|"+p.uid}t++}return r},e.prototype.DeserializeMeasurements=function(e){var s={};if(e&&""!==e)for(var a,r=0,t=e.split("¤");r<t.length;r++){t[r].split(";").forEach(function(e,r){if(e&&""!==e){var t=e.split("|");if(0===r){if(5!==t.length&&6!==t.length)throw new Error("The string cannot be deserialized");a={mid:t[0],isAnswered:(i=t[1],"true"===i.toLowerCase()),lastSurvey:parseInt(t[2],10),nbrOfSurveys:parseInt(t[3],10),uid:t[4],created:6===t.length?parseInt(t[5],10):Date.now(),pixels:[]},s[a.mid]=a}else{if(4!==t.length)throw new Error;var n={exp:parseInt(t[0],10),lastexp:parseInt(t[1],10),time:parseInt(t[2],10),uid:t[3]};a.pixels.push(n)}}var i})}return s},e.prototype.SerializeSessions=function(e){var t="";return e.forEach(function(e,r){t+=0!==r?";":"",t+=e.last+"|"+e.mid+"|"+e.start+"|"+e.uid}),t},e.prototype.DeserializeSessions=function(e){var r=[];if(e&&""!==e)for(var t=0,n=e.split(";");t<n.length;t++){var i=n[t].split("|");if(4!==i.length)throw new Error("The string cannot be deserialized");r.push({last:parseInt(i[0],10),mid:i[1],start:parseInt(i[2],10),uid:i[3]})}return r},e}();window.brandmetrics.register({id:524288,ctor:e})}();
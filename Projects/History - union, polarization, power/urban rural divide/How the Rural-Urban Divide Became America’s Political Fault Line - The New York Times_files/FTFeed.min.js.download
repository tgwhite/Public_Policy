var FTFeedParams=function(){this.segmentId;this.feedEndpoint;this.defaultFeedEndpoint;this.productId;this.ftCustomProductIdNodeName;this.ftCustomProductIndex=0;this.stringTrackerEventName;this.customMacros;this.customMacrosFlashVars;this.sendSegments},FTFeed=function(t,u){function l(b,c){var v={withCredentials:a.sendSegments||(-1<b.search(/ftcreds=(1|true)/i)?!0:!1),complete:function(b){void 0!==m[c]&&clearTimeout(m[c]);var e=!1;try{var f=JSON.parse(b.responseText)}catch(g){e=!0}if(a.feedEndpoint===
c&&void 0===n[c]&&(200!==b.status||e||void 0!==f.error))return a.defaultFeedEndpoint!==a.feedEndpoint&&""!==a.defaultFeedEndpoint?(d=p(a.productId,a.defaultFeedEndpoint),l(d,a.defaultFeedEndpoint)):k("Feed error. Possible 4xx, 5xx, parse error or error field. Run backup logic!",d);if(a.defaultFeedEndpoint===c&&void 0===n[c]&&(200!==b.status||e||void 0!==f.error))return k("Feed error. Possible 4xx, 5xx, parse error or error field. Run backup logic!",d);e=f;b=[];Array.isArray(e)?b=e:b.push(e);void 0!==
a.ftCustomProductIdNodeName&&a.ftCustomProductIndex<b.length&&(e=b[a.ftCustomProductIndex][a.ftCustomProductIdNodeName],void 0!==e?q(e):q("default"));r(b,d)}};m[c]=setTimeout(function(){n[c]=1;if(a.feedEndpoint===c&&a.feedEndpoint!==a.defaultFeedEndpoint&&""!==a.defaultFeedEndpoint)return d=p(a.productId,a.defaultFeedEndpoint),l(d,a.defaultFeedEndpoint);k("Feed response timeout error. Exceeded 3 seconds. Run backup logic.",d)},3E3);FT.ajax(b,v)}function w(a){a=(new RegExp("(?:^|,)"+a+"(\\w+?)(,|$)")).exec(this.myFT.get("ftSegment"));
return null!==a?a[1]:""}function p(b,c){var d=this.myFT.get("serveDom")||this.myFT.get("ftServeDom")||"https://cdn.flashtalking.com";d={"[%PROTOCOL%]":-1<d.indexOf("https://")?"https://":"http://","[%PRODUCT_ID%]":b,"[%SERVE_DOM%]":d,"[%CACHEBUSTER%]":Math.floor(9E9*Math.random()),"[%CACHE_BUSTER%]":Math.floor(9E9*Math.random()),"[%RANDOM%]":Math.floor(9E9*Math.random()),"[%ftLat%]":this.myFT.get("ftLat")||"null","[%LAT%]":this.myFT.get("ftLat")||"null","[%ftLong%]":this.myFT.get("ftLong")||this.myFT.get("ftLng")||
"null","[%LNG%]":this.myFT.get("ftLong")||this.myFT.get("ftLng")||"null","[%ftDMA%]":this.myFT.get("ftDMA")||"null","[%DMA%]":this.myFT.get("ftDMA")||"null","[%ftPostal%]":this.myFT.get("ftPostal")||"null","[%POSTAL%]":this.myFT.get("ftPostal")||"null","[%CITY%]":this.myFT.get("ftGeoCity")||"null","[%STATE%]":this.myFT.get("ftGeoState")||"null","[%COUNTRY%]":this.myFT.get("ftGeoCountry")||"null","[%GUID%]":this.myFT.get("guid")||this.myFT.get("ftGUID")||"null","[%CI_ID%]":this.myFT.get("cID")||"null",
"[%CRM_ID%]":this.myFT.get("cID")||"null","[%CM_ID%]":this.myFT.get("campaignID")||"null","[%CAM_ID%]":this.myFT.get("campaignID")||"null","[%CREATIVE_ID%]":this.myFT.get("creativeID")||"null","[%PLACEMENT_ID%]":this.myFT.get("pID")||this.myFT.get("ftPlacementID")||"null","[%IMPRESSION_ID%]":this.myFT.get("impressionID")||"null","[%IMPRESSIONID%]":this.myFT.get("impressionID")||"null","[%KEYWORD%]":this.myFT.get("ftKeyword")||"null","[%TIMESTAMP%]":this.myFT.get("ftTimestamp")||"null","[%FT_CUSTOM%]":this.myFT.get("ftCustom")||
"null","[%CUSTOM%]":this.myFT.get("ftCustom")||"null","[%ORIGIN%]":window.location.host};if(a.customMacros)for(var h=a.customMacros.split(/[\s,]+/),e=a.customMacrosFlashVars?a.customMacrosFlashVars.split(/[\s,]+/):[],f=0;f<h.length;++f)h[f]&&(d[h[f]]=this.myFT.get(e[f])||"null");for(var g in d)-1<c.indexOf(g)&&(c=c.replace(g,d[g]));return c+=-1<c.lastIndexOf("?")?"&callback=[%CALLBACK%]":"?callback=[%CALLBACK%]"}function q(b){b=encodeURIComponent(b);a.stringTrackerEventName&&this.myFT.tracker(a.stringTrackerEventName,
null,b);for(var c in this.myFT.get("clicks")){var d=this.myFT.get("clicks"),h=c;var e=this.myFT.get("clicks")[c];var f=b,g=/(ft_custom=.*?)(&|$)/i;e=g.test(e)?e.replace(g,"$1__"+f+"$2"):e.replace(/((http(s|):\/\/servedby.flashtalking.com.+?)(&url=))/,"$2&ft_custom="+f+"&url=");d[h]=e}}this.myFT=t;var a=function(a){void 0===a&&(a=new FTFeedParams);void 0===a.segmentId&&(a.segmentId=this.myFT.instantAds.segmentId);void 0===a.feedEndpoint&&(a.feedEndpoint=this.myFT.instantAds.feedEndpoint);void 0===
a.defaultFeedEndpoint&&(a.defaultFeedEndpoint=this.myFT.instantAds.defaultFeedEndpoint);void 0===a.productId&&(a.productId=this.myFT.get("ftSku")||this.myFT.instantAds.productId||"null");return a}(u),d,r,k,n={},m={};this.getFeed=function(b,c){r=b;k=c;"false"!==a.segmentId.toLowerCase()&&""!==a.segmentId&&-1<this.myFT.get("ftSegment").indexOf(a.segmentId)&&(a.productId=w(a.segmentId));"null"===a.productId&&-1<a.feedEndpoint.indexOf("[%PRODUCT_ID%]")&&(a.feedEndpoint=a.defaultFeedEndpoint);d=p(a.productId,
a.feedEndpoint);l(d,a.feedEndpoint)}};